(function(d){"object"==typeof exports&&"object"==typeof module?d(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../xml/xml","../javascript/javascript"],d):d(CodeMirror)})(function(d){function l(d,l,n,p){this.state=d;this.mode=l;this.depth=n;this.prev=p}function q(e){return new l(d.copyState(e.mode,e.state),e.mode,e.depth,e.prev&&q(e.prev))}d.defineMode("jsx",function(e,m){function n(b){var c=
b.tagName;b.tagName=null;var a=g.indent(b,"");b.tagName=c;return a}function p(b,c){if(c.context.mode==g)return r(b,c,c.context);var a;a=c.context;if("<"==b.peek()&&h.expressionAllowed(b,a.state))h.skipExpression(a.state),c.context=new l(d.startState(g,h.indent(a.state,"")),g,0,c.context),a=null;else{var e=h.token(b,a.state);if(!e&&null!=a.depth){var f=b.current();"{"==f?a.depth++:"}"==f&&0==--a.depth&&(c.context=c.context.prev)}a=e}return a}function r(b,c,a){if(2==a.depth)return b.match(/^.*?\*\//)?
a.depth=1:b.skipToEnd(),"comment";if("{"==b.peek()){g.skipAttribute(a.state);var k=n(a.state),f=a.state.context;if(f&&b.match(/^[^>]*>\s*$/,!1)){for(;f.prev&&!f.startOfLine;)f=f.prev;f.startOfLine?k-=e.indentUnit:a.prev.state.lexical&&(k=a.prev.state.lexical.indented)}else 1==a.depth&&(k+=e.indentUnit);c.context=new l(d.startState(h,k),h,0,c.context);return null}if(1==a.depth){if("<"==b.peek())return g.skipAttribute(a.state),c.context=new l(d.startState(g,n(a.state)),g,0,c.context),null;if(b.match("//"))return b.skipToEnd(),
"comment";if(b.match("/*"))return a.depth=2,p(b,c)}var k=g.token(b,a.state),f=b.current(),m;/\btag\b/.test(k)?/>$/.test(f)?a.state.context?a.depth=0:c.context=c.context.prev:/^</.test(f)&&(a.depth=1):!k&&-1<(m=f.indexOf("{"))&&b.backUp(f.length-m);return k}var g=d.getMode(e,{name:"xml",allowMissing:!0,multilineTagIndentPastTag:!1}),h=d.getMode(e,m&&m.base||"javascript");return{startState:function(){return{context:new l(d.startState(h),h)}},copyState:function(b){return{context:q(b.context)}},token:p,
indent:function(b,c,a){return b.context.mode.indent(b.context.state,c,a)},innerMode:function(b){return b.context}}},"xml","javascript");d.defineMIME("text/jsx","jsx");d.defineMIME("text/typescript-jsx",{name:"jsx",base:{name:"javascript",typescript:!0}})});
