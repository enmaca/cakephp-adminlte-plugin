/*
   Copyright 2009-2014 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license/mit

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
*/
var KeyTable;
(function(H,r,M){var x=function(f,x){KeyTable=function(u){function x(a){return function(c,b,d){null!==c&&"number"!=typeof c||null!==b&&"number"!=typeof b||"function"!=typeof d?"object"==typeof c&&"function"==typeof b?(c=G(c),m[a].push({x:c[0],y:c[1],fn:b})):alert("Unhandable event type was added: x"+c+"  y:"+b+"  z:"+d):m[a].push({x:c,y:b,fn:d})}}function N(a){return function(c,b,d){null!==c&&"number"!=typeof c||null!==b&&"number"!=typeof b?"object"==typeof c?(c=G(c),"function"==typeof b?D(a,c[0],
c[1],b):D(a,c[0],c[1])):alert("Unhandable event type was removed: x"+c+"  y:"+b+"  z:"+d):"function"==typeof d?D(a,c,b,d):D(a,c,b)}}function D(a,c,b,d){for(var e=0,h=0,f=m[a].length;h<f-e;h++)if("undefined"!=typeof d)m[a][h-e].x==c&&m[a][h-e].y==b&&m[a][h-e].fn==d&&(m[a].splice(h-e,1),e++);else if(m[a][h-e].x==c&&m[a][h-e].y==b)return m[a].splice(h,1),1;return e}function E(a,c,b){var d=0;a=m[a];for(var e=0;e<a.length;e++)if(a[e].x==c&&a[e].y==b||null===a[e].x&&a[e].y==b||a[e].x==c&&null===a[e].y||
null===a[e].x&&null===a[e].y)a[e].fn(y(c,b),c,b),d++;return d}function q(a,c){if(v!=a){"undefined"==typeof c&&(c=!0);null!==v&&I(v);f(a).addClass(z);f(a).parent().addClass(z);var b;if(k){b=k;for(var d=J(a)[1],e=s;d>=b.fnDisplayEnd();)0<=b._iDisplayLength?b._iDisplayStart+b._iDisplayLength<b.fnRecordsDisplay()&&(b._iDisplayStart+=b._iDisplayLength):b._iDisplayStart=0,k.oApi._fnCalculateEnd(b);for(;d<b._iDisplayStart;)b._iDisplayStart=0<=b._iDisplayLength?b._iDisplayStart-b._iDisplayLength:0,0>b._iDisplayStart&&
(b._iDisplayStart=0),k.oApi._fnCalculateEnd(b);k.oApi._fnDraw(b);s=e}d=G(a);v=a;n=d[0];l=d[1];var h,m,p,q,g;if(c){h=f(H).height();d=f(H).width();m=f(r).scrollTop();e=f(r).scrollLeft();p=a.offsetHeight;q=a.offsetWidth;g=a;var t=0,u=0;if(g.offsetParent)for(t=g.offsetLeft,u=g.offsetTop,g=g.offsetParent;g;)t+=g.offsetLeft,u+=g.offsetTop,g=g.offsetParent;g=[t,u];!k||"undefined"==typeof b.oScroll||""===b.oScroll.sX&&""===b.oScroll.sY||(g[1]-=f(b.nTable.parentNode).scrollTop(),g[0]-=f(b.nTable.parentNode).scrollLeft());
g[1]+p>m+h?(h=g[1]+p-h,r.documentElement.scrollTop=h,r.body.scrollTop=h):g[1]<m&&(h=g[1],r.documentElement.scrollTop=h,r.body.scrollTop=h);g[0]+q>e+d?(d=g[0]+q-d,r.documentElement.scrollLeft=d,r.body.scrollLeft=d):g[0]<e&&(d=g[0],r.documentElement.scrollLeft=d,r.body.scrollLeft=d)}!k||"undefined"==typeof b.oScroll||""===b.oScroll.sX&&""===b.oScroll.sY||(b=b.nTable.parentNode,h=b.clientHeight,d=b.clientWidth,m=b.scrollTop,e=b.scrollLeft,p=a.offsetHeight,q=a.offsetWidth,a.offsetTop+p>h+m?b.scrollTop=
a.offsetTop+p-h:a.offsetTop<m&&(b.scrollTop=a.offsetTop),a.offsetLeft+q>d+e?b.scrollLeft=a.offsetLeft+q-d:a.offsetLeft<e&&(b.scrollLeft=a.offsetLeft));s||(s=!0);E("focus",n,l)}}function A(){I(v);v=l=n=null;s=!1}function I(a){f(a).removeClass(z);f(a).parent().removeClass(z);E("blur",n,l)}function K(a){for(a=this;"TD"!=a.nodeName;)a=a.parentNode;q(a);s||(s=!0)}function O(a){if(L.block||!s||a.metaKey||a.altKey||a.ctrlKey)return!0;var c;c=B.getElementsByTagName("tr")[0].getElementsByTagName("td").length;
var b;if(k){b=k.aiDisplay.length;var d=J(v);if(null===d)return;n=d[0];l=d[1]}else b=B.getElementsByTagName("tr").length;d=9==a.keyCode&&a.shiftKey?-1:a.keyCode;switch(d){case 13:return a.preventDefault(),a.stopPropagation(),E("action",n,l),!0;case 27:if(!E("esc",n,l)){A();return}a=n;c=l;break;case -1:case 37:if(0<n)a=n-1,c=l;else if(0<l)a=c-1,c=l-1;else return-1==d&&F?(w=!0,t.focus(),setTimeout(function(){w=!1},0),s=!1,A(),!0):!1;break;case 38:if(0<l)a=n,c=l-1;else return!1;break;case 36:a=n;c=0;
break;case 33:a=n;c=l-10;0>c&&(c=0);break;case 9:case 39:if(n<c-1)a=n+1,c=l;else if(l<b-1)a=0,c=l+1;else return 9==d&&F?(w=!0,t.focus(),setTimeout(function(){w=!1},0),s=!1,A(),!0):!1;break;case 40:if(l<b-1)a=n,c=l+1;else return!1;break;case 35:a=n;c=b-1;break;case 34:a=n;c=l+10;c>b-1&&(c=b-1);break;default:return!0}q(y(a,c));return!1}function y(a,c){return k?"undefined"!=typeof k.aoData[k.aiDisplay[c]]?k.aoData[k.aiDisplay[c]].nTr.getElementsByTagName("td")[a]:null:f("tr:eq("+c+")>td:eq("+a+")",B)[0]}
function G(a){return k?[f("td",a.parentNode).index(a),f("tr",a.parentNode.parentNode).index(a.parentNode)+k._iDisplayStart]:[f("td",a.parentNode).index(a),f("tr",a.parentNode.parentNode).index(a.parentNode)]}function J(a){for(var c=0,b=k.aiDisplay.length;c<b;c++)for(var d=k.aoData[k.aiDisplay[c]].nTr.getElementsByTagName("td"),e=0,f=d.length;e<f;e++)if(d[e]==a)return[e,c];return null}this.block=!1;this.event={remove:{}};this.fnGetCurrentPosition=function(){return[n,l]};this.fnGetCurrentData=function(){return v.innerHTML};
this.fnGetCurrentTD=function(){return v};this.fnSetPosition=function(a,c){"object"==typeof a&&a.nodeName?q(a):q(y(a,c))};this.fnBlur=function(){A()};var B=null,v=null,n=null,l=null,L=null,z="focus",s=!1,m={action:[],esc:[],focus:[],blur:[]},k=null,F,t,w=!1,p;for(p in m)p&&(this.event[p]=x(p),this.event.remove[p]=N(p));var C;u===M?(p=f("table.KeyTable")[0],C=null):f.isPlainObject(u)?(p=u.table,C=u.datatable):(C=(new f.fn.dataTable.Api(u)).settings()[0],p=C.nTable);(function(a,c,b,d){L=d;"undefined"==
typeof b&&(b={});"undefined"==typeof b.focus&&(b.focus=[0,0]);b.table=a;f(b.table).addClass("KeyTable");"undefined"!=typeof b.focusClass&&(z=b.focusClass);"undefined"!=typeof c&&(k=c);"undefined"==typeof b.initScroll&&(b.initScroll=!0);"undefined"==typeof b.form&&(b.form=!1);F=b.form;B=b.table.getElementsByTagName("tbody")[0];F?(a=r.createElement("div"),t=r.createElement("input"),a.style.height="1px",a.style.width="0px",a.style.overflow="hidden","undefined"!=typeof b.tabIndex&&(t.tabIndex=b.tabIndex),
a.appendChild(t),b.table.parentNode.insertBefore(a,b.table.nextSibling),f(t).focus(function(){w||(s=!0,w=!1,"undefined"!=typeof b.focus.nodeName?q(b.focus,b.initScroll):q(y(b.focus[0],b.focus[1]),b.initScroll),setTimeout(function(){t.blur()},0))}),s=!1):("undefined"!=typeof b.focus.nodeName?q(b.focus,b.initScroll):q(y(b.focus[0],b.focus[1]),b.initScroll),s||(s=!0));f(r).bind("keydown",O);if(k)f(k.nTable).on("click","td",K);else f(B).on("click","td",K);f(r).click(function(a){a=a.target;for(var c=!1;a;){if(a==
b.table){c=!0;break}a=a.parentNode}c||A()})})(p,C,u,this)};KeyTable.version="1.2.1";f.fn.dataTable.KeyTable=KeyTable;return f.fn.DataTable.KeyTable=KeyTable};"function"===typeof define&&define.amd?define(["jquery","datatables"],x):"object"===typeof exports?x(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.KeyTable&&x(jQuery,jQuery.fn.dataTable)})(window,document);
