/*
   Copyright 2009-2014 SpryMedia Ltd.

 This source file is free software, available under the following license:
   MIT license - http://datatables.net/license/mit

 This source file is distributed in the hope that it will be useful, but
 WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY
 or FITNESS FOR A PARTICULAR PURPOSE. See the license files for details.

 For details please refer to: http://www.datatables.net
 KeyTable 1.2.1
 ?2010-2014 SpryMedia Ltd - datatables.net/license
*/
var KeyTable;
(function(I,r,N){var y=function(f,y){KeyTable=function(v){function y(a){return function(c,b,d){null!==c&&"number"!=typeof c||null!==b&&"number"!=typeof b||"function"!=typeof d?"object"==typeof c&&"function"==typeof b?(c=H(c),m[a].push({x:c[0],y:c[1],fn:b})):alert("Unhandable event type was added: x"+c+"  y:"+b+"  z:"+d):m[a].push({x:c,y:b,fn:d})}}function O(a){return function(c,b,d){null!==c&&"number"!=typeof c||null!==b&&"number"!=typeof b?"object"==typeof c?(c=H(c),"function"==typeof b?E(a,c[0],
c[1],b):E(a,c[0],c[1])):alert("Unhandable event type was removed: x"+c+"  y:"+b+"  z:"+d):"function"==typeof d?E(a,c,b,d):E(a,c,b)}}function E(a,c,b,d){for(var e=0,h=0,f=m[a].length;h<f-e;h++)if("undefined"!=typeof d)m[a][h-e].x==c&&m[a][h-e].y==b&&m[a][h-e].fn==d&&(m[a].splice(h-e,1),e++);else if(m[a][h-e].x==c&&m[a][h-e].y==b)return m[a].splice(h,1),1;return e}function F(a,c,b){var d=0;a=m[a];for(var e=0;e<a.length;e++)if(a[e].x==c&&a[e].y==b||null===a[e].x&&a[e].y==b||a[e].x==c&&null===a[e].y||
null===a[e].x&&null===a[e].y)a[e].fn(z(c,b),c,b),d++;return d}function q(a,c){if(w!=a){"undefined"==typeof c&&(c=!0);null!==w&&J(w);f(a).addClass(A);f(a).parent().addClass(A);var b;if(k){b=k;for(var d=K(a)[1],e=t;d>=b.fnDisplayEnd();)0<=b._iDisplayLength?b._iDisplayStart+b._iDisplayLength<b.fnRecordsDisplay()&&(b._iDisplayStart+=b._iDisplayLength):b._iDisplayStart=0,k.oApi._fnCalculateEnd(b);for(;d<b._iDisplayStart;)b._iDisplayStart=0<=b._iDisplayLength?b._iDisplayStart-b._iDisplayLength:0,0>b._iDisplayStart&&
(b._iDisplayStart=0),k.oApi._fnCalculateEnd(b);k.oApi._fnDraw(b);t=e}d=H(a);w=a;n=d[0];l=d[1];var h,m,p,q,g;if(c){h=f(I).height();d=f(I).width();m=f(r).scrollTop();e=f(r).scrollLeft();p=a.offsetHeight;q=a.offsetWidth;g=a;var u=0,v=0;if(g.offsetParent)for(u=g.offsetLeft,v=g.offsetTop,g=g.offsetParent;g;)u+=g.offsetLeft,v+=g.offsetTop,g=g.offsetParent;g=[u,v];!k||"undefined"==typeof b.oScroll||""===b.oScroll.sX&&""===b.oScroll.sY||(g[1]-=f(b.nTable.parentNode).scrollTop(),g[0]-=f(b.nTable.parentNode).scrollLeft());
g[1]+p>m+h?(h=g[1]+p-h,r.documentElement.scrollTop=h,r.body.scrollTop=h):g[1]<m&&(h=g[1],r.documentElement.scrollTop=h,r.body.scrollTop=h);g[0]+q>e+d?(d=g[0]+q-d,r.documentElement.scrollLeft=d,r.body.scrollLeft=d):g[0]<e&&(d=g[0],r.documentElement.scrollLeft=d,r.body.scrollLeft=d)}!k||"undefined"==typeof b.oScroll||""===b.oScroll.sX&&""===b.oScroll.sY||(b=b.nTable.parentNode,h=b.clientHeight,d=b.clientWidth,m=b.scrollTop,e=b.scrollLeft,p=a.offsetHeight,q=a.offsetWidth,a.offsetTop+p>h+m?b.scrollTop=
a.offsetTop+p-h:a.offsetTop<m&&(b.scrollTop=a.offsetTop),a.offsetLeft+q>d+e?b.scrollLeft=a.offsetLeft+q-d:a.offsetLeft<e&&(b.scrollLeft=a.offsetLeft));t||(t=!0);F("focus",n,l)}}function B(){J(w);w=l=n=null;t=!1}function J(a){f(a).removeClass(A);f(a).parent().removeClass(A);F("blur",n,l)}function L(a){for(a=this;"TD"!=a.nodeName;)a=a.parentNode;q(a);t||(t=!0)}function P(a){if(M.block||!t||a.metaKey||a.altKey||a.ctrlKey)return!0;var c;c=C.getElementsByTagName("tr")[0].getElementsByTagName("td").length;
var b;if(k){b=k.aiDisplay.length;var d=K(w);if(null===d)return;n=d[0];l=d[1]}else b=C.getElementsByTagName("tr").length;d=9==a.keyCode&&a.shiftKey?-1:a.keyCode;switch(d){case 13:return a.preventDefault(),a.stopPropagation(),F("action",n,l),!0;case 27:if(!F("esc",n,l)){B();return}a=n;c=l;break;case -1:case 37:if(0<n)a=n-1,c=l;else if(0<l)a=c-1,c=l-1;else return-1==d&&G?(x=!0,u.focus(),setTimeout(function(){x=!1},0),t=!1,B(),!0):!1;break;case 38:if(0<l)a=n,c=l-1;else return!1;break;case 36:a=n;c=0;
break;case 33:a=n;c=l-10;0>c&&(c=0);break;case 9:case 39:if(n<c-1)a=n+1,c=l;else if(l<b-1)a=0,c=l+1;else return 9==d&&G?(x=!0,u.focus(),setTimeout(function(){x=!1},0),t=!1,B(),!0):!1;break;case 40:if(l<b-1)a=n,c=l+1;else return!1;break;case 35:a=n;c=b-1;break;case 34:a=n;c=l+10;c>b-1&&(c=b-1);break;default:return!0}q(z(a,c));return!1}function z(a,c){return k?"undefined"!=typeof k.aoData[k.aiDisplay[c]]?k.aoData[k.aiDisplay[c]].nTr.getElementsByTagName("td")[a]:null:f("tr:eq("+c+")>td:eq("+a+")",C)[0]}
function H(a){return k?[f("td",a.parentNode).index(a),f("tr",a.parentNode.parentNode).index(a.parentNode)+k._iDisplayStart]:[f("td",a.parentNode).index(a),f("tr",a.parentNode.parentNode).index(a.parentNode)]}function K(a){for(var c=0,b=k.aiDisplay.length;c<b;c++)for(var d=k.aoData[k.aiDisplay[c]].nTr.getElementsByTagName("td"),e=0,f=d.length;e<f;e++)if(d[e]==a)return[e,c];return null}this.block=!1;this.event={remove:{}};this.fnGetCurrentPosition=function(){return[n,l]};this.fnGetCurrentData=function(){return w.innerHTML};
this.fnGetCurrentTD=function(){return w};this.fnSetPosition=function(a,c){"object"==typeof a&&a.nodeName?q(a):q(z(a,c))};this.fnBlur=function(){B()};var C=null,w=null,n=null,l=null,M=null,A="focus",t=!1,m={action:[],esc:[],focus:[],blur:[]},k=null,G,u,x=!1,p;for(p in m)p&&(this.event[p]=y(p),this.event.remove[p]=O(p));var D;v===N?(p=f("table.KeyTable")[0],D=null):f.isPlainObject(v)?(p=v.table,D=v.datatable):(D=(new f.fn.dataTable.Api(v)).settings()[0],p=D.nTable);(function(a,c,b,d){M=d;"undefined"==
typeof b&&(b={});"undefined"==typeof b.focus&&(b.focus=[0,0]);b.table=a;f(b.table).addClass("KeyTable");"undefined"!=typeof b.focusClass&&(A=b.focusClass);"undefined"!=typeof c&&(k=c);"undefined"==typeof b.initScroll&&(b.initScroll=!0);"undefined"==typeof b.form&&(b.form=!1);G=b.form;C=b.table.getElementsByTagName("tbody")[0];G?(a=r.createElement("div"),u=r.createElement("input"),a.style.height="1px",a.style.width="0px",a.style.overflow="hidden","undefined"!=typeof b.tabIndex&&(u.tabIndex=b.tabIndex),
a.appendChild(u),b.table.parentNode.insertBefore(a,b.table.nextSibling),f(u).focus(function(){x||(t=!0,x=!1,"undefined"!=typeof b.focus.nodeName?q(b.focus,b.initScroll):q(z(b.focus[0],b.focus[1]),b.initScroll),setTimeout(function(){u.blur()},0))}),t=!1):("undefined"!=typeof b.focus.nodeName?q(b.focus,b.initScroll):q(z(b.focus[0],b.focus[1]),b.initScroll),t||(t=!0));f(r).bind("keydown",P);if(k)f(k.nTable).on("click","td",L);else f(C).on("click","td",L);f(r).click(function(a){a=a.target;for(var c=!1;a;){if(a==
b.table){c=!0;break}a=a.parentNode}c||B()})})(p,D,v,this)};KeyTable.version="1.2.1";f.fn.dataTable.KeyTable=KeyTable;return f.fn.DataTable.KeyTable=KeyTable};"function"===typeof define&&define.amd?define(["jquery","datatables"],y):"object"===typeof exports?y(require("jquery"),require("datatables")):jQuery&&!jQuery.fn.dataTable.KeyTable&&y(jQuery,jQuery.fn.dataTable)})(window,document);
