/*
 wysihtml5x v0.4.15
 https://github.com/Edicy/wysihtml5

 Author: Christopher Blum (https://github.com/tiff)
 Secondary author of extended features: Oliver Pulges (https://github.com/pulges)

 Copyright (C) 2012 XING AG
 Licensed under the MIT license (MIT)

*/
Object.defineProperty&&Object.getOwnPropertyDescriptor&&Object.getOwnPropertyDescriptor(Element.prototype,"textContent")&&!Object.getOwnPropertyDescriptor(Element.prototype,"textContent").get&&function(){var b=Object.getOwnPropertyDescriptor(Element.prototype,"innerText");Object.defineProperty(Element.prototype,"textContent",{get:function(){return b.get.call(this)},set:function(d){return b.set.call(this,d)}})}();Array.isArray||(Array.isArray=function(b){return"[object Array]"===Object.prototype.toString.call(b)});
var wysihtml5={version:"0.4.15",commands:{},dom:{},quirks:{},toolbar:{},lang:{},selection:{},views:{},INVISIBLE_SPACE:"\ufeff",EMPTY_FUNCTION:function(){},ELEMENT_NODE:1,TEXT_NODE:3,BACKSPACE_KEY:8,ENTER_KEY:13,ESCAPE_KEY:27,SPACE_KEY:32,DELETE_KEY:46};
(function(b,d){"function"==typeof define&&define.amd?define(b):d.rangy=b()})(function(){function b(a,b){var e=typeof a[b];return e==r||!(e!=n||!a[b])||"unknown"==e}function d(a,b){return!(typeof a[b]!=n||!a[b])}function f(a,b){return typeof a[b]!=s}function h(a){return function(b,e){for(var g=e.length;g--;)if(!a(b,e[g]))return!1;return!0}}function e(a){return a&&E(a,F)&&C(a,x)}function a(a){return d(a,"body")?a.body:a.getElementsByTagName("body")[0]}function g(a){d(window,"console")&&b(window.console,
"log")&&window.console.log(a)}function k(a){w.initialized=!0;w.supported=!1;a="Rangy is not supported on this page in your browser. Reason: "+a;w.config.alertOnFail?window.alert(a):g(a)}function l(){if(!w.initialized){var d,f=!1,l=!1;b(document,"createRange")&&(d=document.createRange(),E(d,t)&&C(d,u)&&(f=!0));if((d=a(document))&&"body"==d.nodeName.toLowerCase())if(d&&b(d,"createTextRange")&&(d=d.createTextRange(),e(d)&&(l=!0)),f||l){w.initialized=!0;w.features={implementsDomRange:f,implementsTextRange:l};
var h,m;for(m in G)(h=G[m])instanceof q&&h.init(h,w);l=0;for(h=H.length;l<h;++l)try{H[l](w)}catch(n){f="Rangy init listener threw an exception. Continuing. Detail: "+(n.message||n.description||String(n)),g(f)}}else k("Neither Range nor TextRange are available");else k("No body element found")}}function q(a,b,e){this.name=a;this.dependencies=b;this.supported=this.initialized=!1;this.initializer=e}function m(a,b,e,d){a=new q(b,e,function(a){if(!a.initialized){a.initialized=!0;try{d(w,a),a.supported=
!0}catch(e){g("Module '"+b+"' failed to load: "+(e.message||e.description||String(e)))}}});G[b]=a}function p(){}var n="object",r="function",s="undefined",u="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),t="setStart setStartBefore setStartAfter setEnd setEndBefore setEndAfter collapse selectNode selectNodeContents compareBoundaryPoints deleteContents extractContents cloneContents insertNode surroundContents cloneRange toString detach".split(" "),x=
"boundingHeight boundingLeft boundingTop boundingWidth htmlText text".split(" "),F="collapse compareEndPoints duplicate moveToElementText parentElement select setEndPoint getBoundingClientRect".split(" "),E=h(b),A=h(d),C=h(f),G={},w={version:"1.3alpha.20140804",initialized:!1,supported:!0,util:{isHostMethod:b,isHostObject:d,isHostProperty:f,areHostMethods:E,areHostObjects:A,areHostProperties:C,isTextRange:e,getBody:a},features:{},modules:G,config:{alertOnFail:!0,alertOnWarn:!1,preferTextRange:!1,
autoInitialize:typeof rangyAutoInitialize==s?!0:rangyAutoInitialize}};w.fail=k;w.warn=function(a){a="Rangy warning: "+a;w.config.alertOnWarn?window.alert(a):g(a)};({}).hasOwnProperty?w.util.extend=function(a,b,e){var g,d,k;for(k in b)b.hasOwnProperty(k)&&(g=a[k],d=b[k],e&&null!==g&&"object"==typeof g&&null!==d&&"object"==typeof d&&w.util.extend(g,d,!0),a[k]=d);b.hasOwnProperty("toString")&&(a.toString=b.toString);return a}:k("hasOwnProperty not supported");(function(){var a=document.createElement("div");
a.appendChild(document.createElement("span"));var b=[].slice,e;try{1==b.call(a.childNodes,0)[0].nodeType&&(e=function(a){return b.call(a,0)})}catch(g){}e||(e=function(a){for(var b=[],e=0,g=a.length;e<g;++e)b[e]=a[e];return b});w.util.toArray=e})();var z;b(document,"addEventListener")?z=function(a,b,e){a.addEventListener(b,e,!1)}:b(document,"attachEvent")?z=function(a,b,e){a.attachEvent("on"+b,e)}:k("Document does not have required addEventListener or attachEvent method");w.util.addListener=z;var H=
[];w.init=l;w.addInitListener=function(a){w.initialized?a(w):H.push(a)};var Q=[];w.addShimListener=function(a){Q.push(a)};w.shim=w.createMissingNativeApi=function(a){a=a||window;l();for(var b=0,e=Q.length;b<e;++b)Q[b](a)};q.prototype={init:function(){for(var a=this.dependencies||[],b=0,e=a.length,g,d;b<e;++b){d=a[b];g=G[d];if(!(g&&g instanceof q))throw Error("required module '"+d+"' not found");g.init();if(!g.supported)throw Error("required module '"+d+"' not supported");}this.initializer(this)},
fail:function(a){this.initialized=!0;this.supported=!1;throw Error("Module '"+this.name+"' failed to load: "+a);},warn:function(a){w.warn("Module "+this.name+": "+a)},deprecationNotice:function(a,b){w.warn("DEPRECATED: "+a+" in module "+this.name+"is deprecated. Please use "+b+" instead")},createError:function(a){return Error("Error in Rangy "+this.name+" module: "+a)}};w.createModule=function(a){var b,e;2==arguments.length?(b=arguments[1],e=[]):(b=arguments[2],e=arguments[1]);b=m(!1,a,e,b);w.initialized&&
b.init()};w.createCoreModule=function(a,b,e){m(!0,a,b,e)};w.RangePrototype=p;w.rangePrototype=new p;w.selectionPrototype=new function(){};var K=!1,A=function(a){K||(K=!0,!w.initialized&&w.config.autoInitialize&&l())};if(typeof window==s)k("No window found");else if(typeof document==s)k("No document found");else return b(document,"addEventListener")&&document.addEventListener("DOMContentLoaded",A,!1),z(window,"load",A),w.createCoreModule("DomUtil",[],function(a,b){function e(a){for(var b=0;a=a.previousSibling;)++b;
return b}function g(a,b){var e=[],d;for(d=a;d;d=d.parentNode)e.push(d);for(d=b;d;d=d.parentNode)if(E(e,d))return d;return null}function d(a,b,e){for(b=e?b:b.parentNode;b;){if(b===a)return!0;b=b.parentNode}return!1}function k(a,b,e){for(e=e?a:a.parentNode;e;){a=e.parentNode;if(a===b)return e;e=a}return null}function f(a){a=a.nodeType;return 3==a||4==a||8==a}function l(a,b){var e=b.nextSibling,d=b.parentNode;e?d.insertBefore(a,e):d.appendChild(a);return a}function h(a){if(9==a.nodeType)return a;if(typeof a.ownerDocument!=
t)return a.ownerDocument;if(typeof a.document!=t)return a.document;if(a.parentNode)return h(a.parentNode);throw b.createError("getDocument: no document found for node");}function m(a){a=h(a);if(typeof a.defaultView!=t)return a.defaultView;if(typeof a.parentWindow!=t)return a.parentWindow;throw b.createError("Cannot get a window object for node");}function q(a){if(typeof a.contentDocument!=t)return a.contentDocument;if(typeof a.contentWindow!=t)return a.contentWindow.document;throw b.createError("getIframeDocument: No Document object found for iframe element");
}function n(a){return a&&u.isHostMethod(a,"setTimeout")&&u.isHostObject(a,"document")}function r(a){return a?f(a)?'"'+a.data+'"':1==a.nodeType?"<"+a.nodeName+(a.id?' id="'+a.id+'"':"")+">[index:"+e(a)+",length:"+a.childNodes.length+"]["+(a.innerHTML||"[innerHTML not supported]").slice(0,25)+"]":a.nodeName:"[No node]"}function p(a){this._next=this.root=a}function s(a,b){this.node=a;this.offset=b}function x(a){this.code=this[a];this.codeName=a;this.message="DOMException: "+this.codeName}var t="undefined",
u=a.util;u.areHostMethods(document,["createDocumentFragment","createElement","createTextNode"])||b.fail("document missing a Node creation method");u.isHostMethod(document,"getElementsByTagName")||b.fail("document missing getElementsByTagName method");var F=document.createElement("div");u.areHostMethods(F,["insertBefore","appendChild","cloneNode"])||b.fail("Incomplete Element implementation");u.isHostProperty(F,"innerHTML")||b.fail("Element is missing innerHTML property");F=document.createTextNode("test");
u.areHostMethods(F,["splitText","deleteData","insertData","appendData","cloneNode"])||b.fail("Incomplete Text Node implementation");var E=function(a,b){for(var e=a.length;e--;)if(a[e]===b)return!0;return!1},w=!1;(function(){var b=document.createElement("b");b.innerHTML="1";b.innerHTML="<br>";w=!1;a.features.crashyTextNodes=w})();var A;typeof window.getComputedStyle!=t?A=function(a,b){return m(a).getComputedStyle(a,null)[b]}:typeof document.documentElement.currentStyle!=t?A=function(a,b){return a.currentStyle[b]}:
b.fail("No means of obtaining computed style properties found");p.prototype={_current:null,hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next,b;if(this._current){b=a.firstChild;if(!b)for(b=null;a!==this.root&&!(b=a.nextSibling);)a=a.parentNode;this._next=b}return this._current},detach:function(){this._current=this._next=this.root=null}};s.prototype={equals:function(a){return!!a&&this.node===a.node&&this.offset==a.offset},inspect:function(){return"[DomPosition("+
r(this.node)+":"+this.offset+")]"},toString:function(){return this.inspect()}};x.prototype={INDEX_SIZE_ERR:1,HIERARCHY_REQUEST_ERR:3,WRONG_DOCUMENT_ERR:4,NO_MODIFICATION_ALLOWED_ERR:7,NOT_FOUND_ERR:8,NOT_SUPPORTED_ERR:9,INVALID_STATE_ERR:11,INVALID_NODE_TYPE_ERR:24};x.prototype.toString=function(){return this.message};a.dom={arrayContains:E,isHtmlNamespace:function(a){var b;return typeof a.namespaceURI==t||null===(b=a.namespaceURI)||"http://www.w3.org/1999/xhtml"==b},parentElement:function(a){a=a.parentNode;
return 1==a.nodeType?a:null},getNodeIndex:e,getNodeLength:function(a){switch(a.nodeType){case 7:case 10:return 0;case 3:case 8:return a.length;default:return a.childNodes.length}},getCommonAncestor:g,isAncestorOf:d,isOrIsAncestorOf:function(a,b){return d(a,b,!0)},getClosestAncestorIn:k,isCharacterDataNode:f,isTextOrCommentNode:function(a){if(!a)return!1;a=a.nodeType;return 3==a||8==a},insertAfter:l,splitDataNode:function(a,b,d){var g=a.cloneNode(!1);g.deleteData(0,b);a.deleteData(b,a.length-b);l(g,
a);if(d)for(var k=0,f;f=d[k++];)f.node==a&&f.offset>b?(f.node=g,f.offset-=b):f.node==a.parentNode&&f.offset>e(a)&&++f.offset;return g},getDocument:h,getWindow:m,getIframeWindow:function(a){if(typeof a.contentWindow!=t)return a.contentWindow;if(typeof a.contentDocument!=t)return a.contentDocument.defaultView;throw b.createError("getIframeWindow: No Window object found for iframe element");},getIframeDocument:q,getBody:u.getBody,isWindow:n,getContentDocument:function(a,b,e){var d;a?u.isHostProperty(a,
"nodeType")?d=1==a.nodeType&&"iframe"==a.tagName.toLowerCase()?q(a):h(a):n(a)&&(d=a.document):d=document;if(!d)throw b.createError(e+"(): Parameter must be a Window object or DOM node");return d},getRootContainer:function(a){for(var b;b=a.parentNode;)a=b;return a},comparePoints:function(a,d,f,l){var h;if(a==f)return d===l?0:d<l?-1:1;if(h=k(f,a,!0))return d<=e(h)?-1:1;if(h=k(a,f,!0))return e(h)<l?-1:1;d=g(a,f);if(!d)throw Error("comparePoints error: nodes have no common ancestor");a=a===d?d:k(a,d,
!0);f=f===d?d:k(f,d,!0);if(a===f)throw b.createError("comparePoints got to case 4 and childA and childB are the same!");for(d=d.firstChild;d;){if(d===a)return-1;if(d===f)return 1;d=d.nextSibling}},isBrokenNode:function(a){return!1},inspectNode:r,getComputedStyleProperty:A,fragmentFromNodeChildren:function(a){for(var b=h(a).createDocumentFragment(),e;e=a.firstChild;)b.appendChild(e);return b},createIterator:function(a){return new p(a)},DomPosition:s};a.DOMException=x}),w.createCoreModule("DomRange",
["DomUtil"],function(a,b){function e(a,b){return 3!=a.nodeType&&(R(a,b.startContainer)||R(a,b.endContainer))}function d(a){return a.document||aa(a.startContainer)}function g(a){return new W(a.parentNode,L(a))}function k(a){return new W(a.parentNode,L(a)+1)}function f(a,b,e){var d=11==a.nodeType?a.firstChild:a;v(b)?e==b.length?y.insertAfter(a,b):b.parentNode.insertBefore(a,0==e?b:fa(b,e)):e>=b.childNodes.length?b.appendChild(a):b.insertBefore(a,b.childNodes[e]);return d}function l(a,b,e){z(a);z(b);
if(d(b)!=d(a))throw new D("WRONG_DOCUMENT_ERR");var g=B(a.startContainer,a.startOffset,b.endContainer,b.endOffset);a=B(a.endContainer,a.endOffset,b.startContainer,b.startOffset);return e?0>=g&&0<=a:0>g&&0<a}function h(a){for(var b,e,g=d(a.range).createDocumentFragment();e=a.next();){b=a.isPartiallySelectedSubtree();e=e.cloneNode(!b);b&&(b=a.getSubtreeIterator(),e.appendChild(h(b)),b.detach());if(10==e.nodeType)throw new D("HIERARCHY_REQUEST_ERR");g.appendChild(e)}return g}function m(a,b,e){var d,
g;for(e=e||{stop:!1};d=a.next();)if(a.isPartiallySelectedSubtree())if(!1===b(d)){e.stop=!0;break}else{if(d=a.getSubtreeIterator(),m(d,b,e),d.detach(),e.stop)break}else for(d=y.createIterator(d);g=d.next();)if(!1===b(g)){e.stop=!0;return}}function q(a){for(var b;a.next();)a.isPartiallySelectedSubtree()?(b=a.getSubtreeIterator(),q(b),b.detach()):a.remove()}function n(a){for(var b,e=d(a.range).createDocumentFragment(),g;b=a.next();){a.isPartiallySelectedSubtree()?(b=b.cloneNode(!1),g=a.getSubtreeIterator(),
b.appendChild(n(g)),g.detach()):a.remove();if(10==b.nodeType)throw new D("HIERARCHY_REQUEST_ERR");e.appendChild(b)}return e}function r(a,b,e){var d=!(!b||!b.length),g,k=!!e;d&&(g=new RegExp("^("+b.join("|")+")$"));var f=[];m(new s(a,!1),function(b){if(!d||g.test(b.nodeType))if(!k||e(b)){var l=a.startContainer;b==l&&v(l)&&a.startOffset==l.length||(l=a.endContainer,b==l&&v(l)&&0==a.endOffset||f.push(b))}});return f}function p(a){return"["+("undefined"==typeof a.getName?"Range":a.getName())+"("+y.inspectNode(a.startContainer)+
":"+a.startOffset+", "+y.inspectNode(a.endContainer)+":"+a.endOffset+")]"}function s(a,b){this.range=a;this.clonePartiallySelectedTextNodes=b;if(!a.collapsed){this.sc=a.startContainer;this.so=a.startOffset;this.ec=a.endContainer;this.eo=a.endOffset;var e=a.commonAncestorContainer;this.sc===this.ec&&v(this.sc)?(this.isSingleCharacterDataNode=!0,this._first=this._last=this._next=this.sc):(this._first=this._next=this.sc!==e||v(this.sc)?X(this.sc,e,!0):this.sc.childNodes[this.so],this._last=this.ec!==
e||v(this.ec)?X(this.ec,e,!0):this.ec.childNodes[this.eo-1])}}function x(a){return function(b,e){for(var d,g=e?b:b.parentNode;g;){d=g.nodeType;if(Y(a,d))return g;g=g.parentNode}return null}}function t(a,b){if(xa(a,b))throw new D("INVALID_NODE_TYPE_ERR");}function u(a,b){if(!Y(b,a.nodeType))throw new D("INVALID_NODE_TYPE_ERR");}function F(a,b){if(0>b||b>(v(a)?a.length:a.childNodes.length))throw new D("INDEX_SIZE_ERR");}function E(a,b){if(ja(a,!0)!==ja(b,!0))throw new D("WRONG_DOCUMENT_ERR");}function w(a){if(ya(a,
!0))throw new D("NO_MODIFICATION_ALLOWED_ERR");}function A(a,b){if(!a)throw new D(b);}function C(a){return ga&&y.isBrokenNode(a)||!Y(ha,a.nodeType)&&!ja(a,!0)}function G(a,b){return b<=(v(a)?a.length:a.childNodes.length)}function pa(a){return!!a.startContainer&&!!a.endContainer&&!C(a.startContainer)&&!C(a.endContainer)&&G(a.startContainer,a.startOffset)&&G(a.endContainer,a.endOffset)}function z(a){if(!pa(a))throw Error("Range error: Range is no longer valid after DOM mutation ("+a.inspect()+")");
}function H(a,b){z(a);var e=a.startContainer,d=a.startOffset,g=a.endContainer,k=a.endOffset,f=e===g;v(g)&&0<k&&k<g.length&&fa(g,k,b);v(e)&&0<d&&d<e.length&&(e=fa(e,d,b),f?(k-=d,g=e):g==e.parentNode&&k>=L(e)&&k++,d=0);a.setStartAndEnd(e,d,g,k)}function Q(a){z(a);var b=a.commonAncestorContainer.parentNode.cloneNode(!1);b.appendChild(a.cloneContents());return b.innerHTML}function K(a){a.START_TO_START=ka;a.START_TO_END=ra;a.END_TO_END=za;a.END_TO_START=sa;a.NODE_BEFORE=ta;a.NODE_AFTER=ua;a.NODE_BEFORE_AND_AFTER=
va;a.NODE_INSIDE=la}function Z(a){K(a);K(a.prototype)}function ba(a,b){return function(){z(this);var e=this.startContainer,d=this.startOffset,g=this.commonAncestorContainer,f=new s(this,!0);e!==g&&(e=X(e,g,!0),d=k(e),e=d.node,d=d.offset);m(f,w);f.reset();g=a(f);f.detach();b(this,e,d,e,d);return g}}function J(b,d){function f(a,b){return function(e){u(e,ca);u(O(e),ha);e=(a?g:k)(e);(b?l:h)(this,e.node,e.offset)}}function l(a,b,e){var g=a.endContainer,k=a.endOffset;if(b!==a.startContainer||e!==a.startOffset){if(O(b)!=
O(g)||1==B(b,e,g,k))g=b,k=e;d(a,b,e,g,k)}}function h(a,b,e){var g=a.startContainer,k=a.startOffset;if(b!==a.endContainer||e!==a.endOffset){if(O(b)!=O(g)||-1==B(b,e,g,k))g=b,k=e;d(a,g,k,b,e)}}var m=function(){};m.prototype=a.rangePrototype;b.prototype=new m;P.extend(b.prototype,{setStart:function(a,b){t(a,!0);F(a,b);l(this,a,b)},setEnd:function(a,b){t(a,!0);F(a,b);h(this,a,b)},setStartAndEnd:function(){var a=arguments,b=a[0],e=a[1],g=b,k=e;switch(a.length){case 3:k=a[2];break;case 4:g=a[2],k=a[3]}d(this,
b,e,g,k)},setBoundary:function(a,b,e){this["set"+(e?"Start":"End")](a,b)},setStartBefore:f(!0,!0),setStartAfter:f(!1,!0),setEndBefore:f(!0,!1),setEndAfter:f(!1,!1),collapse:function(a){z(this);a?d(this,this.startContainer,this.startOffset,this.startContainer,this.startOffset):d(this,this.endContainer,this.endOffset,this.endContainer,this.endOffset)},selectNodeContents:function(a){t(a,!0);d(this,a,0,a,M(a))},selectNode:function(a){t(a,!1);u(a,ca);var b=g(a);a=k(a);d(this,b.node,b.offset,a.node,a.offset)},
extractContents:ba(n,d),deleteContents:ba(q,d),canSurroundContents:function(){z(this);w(this.startContainer);w(this.endContainer);var a=new s(this,!0),b=a._first&&e(a._first,this)||a._last&&e(a._last,this);a.detach();return!b},splitBoundaries:function(){H(this)},splitBoundariesPreservingPositions:function(a){H(this,a)},normalizeBoundaries:function(){z(this);var a=this.startContainer,b=this.startOffset,e=this.endContainer,g=this.endOffset,k=function(a){var b=a.nextSibling;b&&b.nodeType==a.nodeType&&
(e=a,g=a.length,a.appendData(b.data),b.parentNode.removeChild(b))},f=function(d){var k=d.previousSibling;if(k&&k.nodeType==d.nodeType){a=d;var f=d.length;b=k.length;d.insertData(0,k.data);k.parentNode.removeChild(k);a==e?(g+=b,e=a):e==d.parentNode&&(k=L(d),g==k?(e=d,g=f):g>k&&g--)}},l=!0;v(e)?e.length==g&&k(e):(0<g&&(l=e.childNodes[g-1])&&v(l)&&k(l),l=!this.collapsed);l?v(a)?0==b&&f(a):b<a.childNodes.length&&(k=a.childNodes[b])&&v(k)&&f(k):(a=e,b=g);d(this,a,b,e,g)},collapseToPoint:function(a,b){t(a,
!0);F(a,b);this.setStartAndEnd(a,b)}});Z(b)}function N(a){a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset;a.commonAncestorContainer=a.collapsed?a.startContainer:y.getCommonAncestor(a.startContainer,a.endContainer)}function S(a,b,e,d,g){a.startContainer=b;a.startOffset=e;a.endContainer=d;a.endOffset=g;a.document=y.getDocument(b);N(a)}function T(a){this.startContainer=a;this.startOffset=0;this.endContainer=a;this.endOffset=0;this.document=a;N(this)}var y=a.dom,P=a.util,W=
y.DomPosition,D=a.DOMException,v=y.isCharacterDataNode,L=y.getNodeIndex,R=y.isOrIsAncestorOf,aa=y.getDocument,B=y.comparePoints,fa=y.splitDataNode,X=y.getClosestAncestorIn,M=y.getNodeLength,Y=y.arrayContains,O=y.getRootContainer,ga=a.features.crashyTextNodes;s.prototype={_current:null,_next:null,_first:null,_last:null,isSingleCharacterDataNode:!1,reset:function(){this._current=null;this._next=this._first},hasNext:function(){return!!this._next},next:function(){var a=this._current=this._next;a&&(this._next=
a!==this._last?a.nextSibling:null,v(a)&&this.clonePartiallySelectedTextNodes&&(a===this.ec&&(a=a.cloneNode(!0)).deleteData(this.eo,a.length-this.eo),this._current===this.sc&&(a=a.cloneNode(!0)).deleteData(0,this.so)));return a},remove:function(){var a=this._current,b,e;!v(a)||a!==this.sc&&a!==this.ec?a.parentNode&&a.parentNode.removeChild(a):(b=a===this.sc?this.so:0,e=a===this.ec?this.eo:a.length,b!=e&&a.deleteData(b,e-b))},isPartiallySelectedSubtree:function(){return e(this._current,this.range)},
getSubtreeIterator:function(){var a;if(this.isSingleCharacterDataNode)a=this.range.cloneRange(),a.collapse(!1);else{a=new T(d(this.range));var b=this._current,e=b,g=0,k=b,f=M(b);R(b,this.sc)&&(e=this.sc,g=this.so);R(b,this.ec)&&(k=this.ec,f=this.eo);S(a,e,g,k,f)}return new s(a,this.clonePartiallySelectedTextNodes)},detach:function(){this.range=this._current=this._next=this._first=this._last=this.sc=this.so=this.ec=this.eo=null}};var ca=[1,3,4,5,7,8,10],ha=[2,9,11],da=[1,3,4,5,7,8,10,11],Aa=[1,3,4,
5,7,8],ja=x([9,11]),ya=x([5,6,10,12]),xa=x([6,10,12]),wa=document.createElement("style"),ma=!1;try{wa.innerHTML="<b>x</b>",ma=3==wa.firstChild.nodeType}catch(Ca){}a.features.htmlParsingConforms=ma;var na="startContainer startOffset endContainer endOffset collapsed commonAncestorContainer".split(" "),ka=0,ra=1,za=2,sa=3,ta=0,ua=1,va=2,la=3;P.extend(a.rangePrototype,{compareBoundaryPoints:function(a,b){z(this);E(this.startContainer,b.startContainer);var e=a==sa||a==ka?"start":"end",d=a==ra||a==ka?"start":
"end";return B(this[e+"Container"],this[e+"Offset"],b[d+"Container"],b[d+"Offset"])},insertNode:function(a){z(this);u(a,da);w(this.startContainer);if(R(a,this.startContainer))throw new D("HIERARCHY_REQUEST_ERR");a=f(a,this.startContainer,this.startOffset);this.setStartBefore(a)},cloneContents:function(){z(this);var a,b;if(this.collapsed)return d(this).createDocumentFragment();if(this.startContainer===this.endContainer&&v(this.startContainer))return a=this.startContainer.cloneNode(!0),a.data=a.data.slice(this.startOffset,
this.endOffset),b=d(this).createDocumentFragment(),b.appendChild(a),b;b=new s(this,!0);a=h(b);b.detach();return a},canSurroundContents:function(){z(this);w(this.startContainer);w(this.endContainer);var a=new s(this,!0),b=a._first&&e(a._first,this)||a._last&&e(a._last,this);a.detach();return!b},surroundContents:function(a){u(a,Aa);if(!this.canSurroundContents())throw new D("INVALID_STATE_ERR");var b=this.extractContents();if(a.hasChildNodes())for(;a.lastChild;)a.removeChild(a.lastChild);f(a,this.startContainer,
this.startOffset);a.appendChild(b);this.selectNode(a)},cloneRange:function(){z(this);for(var a=new T(d(this)),b=na.length,e;b--;)e=na[b],a[e]=this[e];return a},toString:function(){z(this);var a=this.startContainer;if(a===this.endContainer&&v(a))return 3==a.nodeType||4==a.nodeType?a.data.slice(this.startOffset,this.endOffset):"";var b=[],a=new s(this,!0);m(a,function(a){3!=a.nodeType&&4!=a.nodeType||b.push(a.data)});a.detach();return b.join("")},compareNode:function(a){z(this);var b=a.parentNode,e=
L(a);if(!b)throw new D("NOT_FOUND_ERR");a=this.comparePoint(b,e);b=this.comparePoint(b,e+1);return 0>a?0<b?va:ta:0<b?ua:la},comparePoint:function(a,b){z(this);A(a,"HIERARCHY_REQUEST_ERR");E(a,this.startContainer);return 0>B(a,b,this.startContainer,this.startOffset)?-1:0<B(a,b,this.endContainer,this.endOffset)?1:0},createContextualFragment:ma?function(a){var b=this.startContainer,e=aa(b);if(!b)throw new D("INVALID_STATE_ERR");var d=null;1==b.nodeType?d=b:v(b)&&(d=y.parentElement(b));d=null===d||"HTML"==
d.nodeName&&y.isHtmlNamespace(aa(d).documentElement)&&y.isHtmlNamespace(d)?e.createElement("body"):d.cloneNode(!1);d.innerHTML=a;return y.fragmentFromNodeChildren(d)}:function(a){var b=d(this).createElement("body");b.innerHTML=a;return y.fragmentFromNodeChildren(b)},toHtml:function(){return Q(this)},intersectsNode:function(a,b){z(this);A(a,"NOT_FOUND_ERR");if(aa(a)!==d(this))return!1;var e=a.parentNode,g=L(a);A(e,"NOT_FOUND_ERR");var k=B(e,g,this.endContainer,this.endOffset),e=B(e,g+1,this.startContainer,
this.startOffset);return b?0>=k&&0<=e:0>k&&0<e},isPointInRange:function(a,b){z(this);A(a,"HIERARCHY_REQUEST_ERR");E(a,this.startContainer);return 0<=B(a,b,this.startContainer,this.startOffset)&&0>=B(a,b,this.endContainer,this.endOffset)},intersectsRange:function(a){return l(this,a,!1)},intersectsOrTouchesRange:function(a){return l(this,a,!0)},intersection:function(a){if(this.intersectsRange(a)){var b=B(this.startContainer,this.startOffset,a.startContainer,a.startOffset),e=B(this.endContainer,this.endOffset,
a.endContainer,a.endOffset),d=this.cloneRange();-1==b&&d.setStart(a.startContainer,a.startOffset);1==e&&d.setEnd(a.endContainer,a.endOffset);return d}return null},union:function(a){if(this.intersectsOrTouchesRange(a)){var b=this.cloneRange();-1==B(a.startContainer,a.startOffset,this.startContainer,this.startOffset)&&b.setStart(a.startContainer,a.startOffset);1==B(a.endContainer,a.endOffset,this.endContainer,this.endOffset)&&b.setEnd(a.endContainer,a.endOffset);return b}throw new D("Ranges do not intersect");
},containsNode:function(a,b){return b?this.intersectsNode(a,!1):this.compareNode(a)==la},containsNodeContents:function(a){return 0<=this.comparePoint(a,0)&&0>=this.comparePoint(a,M(a))},containsRange:function(a){var b=this.intersection(a);return null!==b&&a.equals(b)},containsNodeText:function(a){var b=this.cloneRange();b.selectNode(a);var e=b.getNodes([3]);return 0<e.length?(b.setStart(e[0],0),a=e.pop(),b.setEnd(a,a.length),this.containsRange(b)):this.containsNodeContents(a)},getNodes:function(a,
b){z(this);return r(this,a,b)},getDocument:function(){return d(this)},collapseBefore:function(a){this.setEndBefore(a);this.collapse(!1)},collapseAfter:function(a){this.setStartAfter(a);this.collapse(!0)},getBookmark:function(b){var e=d(this),g=a.createRange(e);b=b||y.getBody(e);g.selectNodeContents(b);var e=this.intersection(g),k=0,f=0;e&&(g.setEnd(e.startContainer,e.startOffset),k=g.toString().length,f=k+e.toString().length);return{start:k,end:f,containerNode:b}},moveToBookmark:function(a){var b=
a.containerNode,e=0;this.setStart(b,0);this.collapse(!0);for(var b=[b],d,g=!1,k=!1,f,l;!k&&(d=b.pop());)if(3==d.nodeType)f=e+d.length,!g&&a.start>=e&&a.start<=f&&(this.setStart(d,a.start-e),g=!0),g&&a.end>=e&&a.end<=f&&(this.setEnd(d,a.end-e),k=!0),e=f;else for(l=d.childNodes,f=l.length;f--;)b.push(l[f])},getName:function(){return"DomRange"},equals:function(a){return T.rangesEqual(this,a)},isValid:function(){return pa(this)},inspect:function(){return p(this)},detach:function(){}});J(T,S);P.extend(T,
{rangeProperties:na,RangeIterator:s,copyComparisonConstants:Z,createPrototypeRange:J,inspect:p,toHtml:Q,getRangeDocument:d,rangesEqual:function(a,b){return a.startContainer===b.startContainer&&a.startOffset===b.startOffset&&a.endContainer===b.endContainer&&a.endOffset===b.endOffset}});a.DomRange=T}),w.createCoreModule("WrappedRange",["DomRange"],function(a,b){var e,d,g=a.dom,k=a.util,f=g.DomPosition,l=a.DomRange,h=g.getBody,m=g.getContentDocument,q=g.isCharacterDataNode;a.features.implementsDomRange&&
function(){function d(a){for(var b=q.length,e;b--;)e=q[b],a[e]=a.nativeRange[e];a.collapsed=a.startContainer===a.endContainer&&a.startOffset===a.endOffset}var f,q=l.rangeProperties,n;e=function(a){if(!a)throw b.createError("WrappedRange: Range must be specified");this.nativeRange=a;d(this)};l.createPrototypeRange(e,function(a,b,e,d,g){var k=a.startContainer!==b||a.startOffset!=e,f=a.endContainer!==d||a.endOffset!=g,l=!a.equals(a.nativeRange);if(k||f||l)a.setEnd(d,g),a.setStart(b,e)});f=e.prototype;
f.selectNode=function(a){this.nativeRange.selectNode(a);d(this)};f.cloneContents=function(){return this.nativeRange.cloneContents()};f.surroundContents=function(a){this.nativeRange.surroundContents(a);d(this)};f.collapse=function(a){this.nativeRange.collapse(a);d(this)};f.cloneRange=function(){return new e(this.nativeRange.cloneRange())};f.refresh=function(){d(this)};f.toString=function(){return this.nativeRange.toString()};var r=document.createTextNode("test");h(document).appendChild(r);var p=document.createRange();
p.setStart(r,0);p.setEnd(r,0);try{p.setStart(r,1),f.setStart=function(a,b){this.nativeRange.setStart(a,b);d(this)},f.setEnd=function(a,b){this.nativeRange.setEnd(a,b);d(this)},n=function(a){return function(b){this.nativeRange[a](b);d(this)}}}catch(s){f.setStart=function(a,b){try{this.nativeRange.setStart(a,b)}catch(e){this.nativeRange.setEnd(a,b),this.nativeRange.setStart(a,b)}d(this)},f.setEnd=function(a,b){try{this.nativeRange.setEnd(a,b)}catch(e){this.nativeRange.setStart(a,b),this.nativeRange.setEnd(a,
b)}d(this)},n=function(a,b){return function(e){try{this.nativeRange[a](e)}catch(g){this.nativeRange[b](e),this.nativeRange[a](e)}d(this)}}}f.setStartBefore=n("setStartBefore","setEndBefore");f.setStartAfter=n("setStartAfter","setEndAfter");f.setEndBefore=n("setEndBefore","setStartBefore");f.setEndAfter=n("setEndAfter","setStartAfter");f.selectNodeContents=function(a){this.setStartAndEnd(a,0,g.getNodeLength(a))};p.selectNodeContents(r);p.setEnd(r,3);n=document.createRange();n.selectNodeContents(r);
n.setEnd(r,4);n.setStart(r,2);-1==p.compareBoundaryPoints(p.START_TO_END,n)&&1==p.compareBoundaryPoints(p.END_TO_START,n)?f.compareBoundaryPoints=function(a,b){b=b.nativeRange||b;a==b.START_TO_END?a=b.END_TO_START:a==b.END_TO_START&&(a=b.START_TO_END);return this.nativeRange.compareBoundaryPoints(a,b)}:f.compareBoundaryPoints=function(a,b){return this.nativeRange.compareBoundaryPoints(a,b.nativeRange||b)};n=document.createElement("div");n.innerHTML="123";var x=n.firstChild,t=h(document);t.appendChild(n);
p.setStart(x,1);p.setEnd(x,2);p.deleteContents();"13"==x.data&&(f.deleteContents=function(){this.nativeRange.deleteContents();d(this)},f.extractContents=function(){var a=this.nativeRange.extractContents();d(this);return a});t.removeChild(n);t=null;k.isHostMethod(p,"createContextualFragment")&&(f.createContextualFragment=function(a){return this.nativeRange.createContextualFragment(a)});h(document).removeChild(r);f.getName=function(){return"WrappedRange"};a.WrappedRange=e;a.createNativeRange=function(a){a=
m(a,b,"createNativeRange");return a.createRange()}}();if(a.features.implementsTextRange){var n=function(a,b,e,d,k){var l=a.duplicate();l.collapse(e);var h=l.parentElement();g.isOrIsAncestorOf(b,h)||(h=b);if(!h.canHaveHTML)return h=new f(h.parentNode,g.getNodeIndex(h)),{boundaryPosition:h,nodeInfo:{nodeIndex:h.offset,containerElement:h.node}};b=g.getDocument(h).createElement("span");b.parentNode&&b.parentNode.removeChild(b);var m,n=e?"StartToStart":"StartToEnd",r=k&&k.containerElement==h?k.nodeIndex:
0,p=h.childNodes.length,s=p;for(k=s;;){k==p?h.appendChild(b):h.insertBefore(b,h.childNodes[k]);l.moveToElementText(b);m=l.compareEndPoints(n,a);if(0==m||r==s)break;else if(-1==m)if(s==r+1)break;else r=k;else s=s==r+1?r:k;k=Math.floor((r+s)/2);h.removeChild(b)}n=b.nextSibling;if(-1==m&&n&&q(n)){l.setEndPoint(e?"EndToStart":"EndToEnd",a);if(/[\r\n]/.test(n.data))for(e=l.duplicate(),d=e.text.replace(/\r\n/g,"\r").length,d=e.moveStart("character",d);-1==e.compareEndPoints("StartToEnd",e);)d++,e.moveStart("character",
1);else d=l.text.length;e=new f(n,d)}else a=(d||!e)&&b.previousSibling,e=(e=(d||e)&&b.nextSibling)&&q(e)?new f(e,0):a&&q(a)?new f(a,a.data.length):new f(h,g.getNodeIndex(b));b.parentNode.removeChild(b);return{boundaryPosition:e,nodeInfo:{nodeIndex:k,containerElement:h}}},r=function(a,b){var e,d,k=a.offset,f=g.getDocument(a.node),l=h(f).createTextRange(),m=q(a.node);m?(e=a.node,d=e.parentNode):(e=a.node.childNodes,e=k<e.length?e[k]:null,d=a.node);f=f.createElement("span");f.innerHTML="&#feff;";e?d.insertBefore(f,
e):d.appendChild(f);l.moveToElementText(f);l.collapse(!b);d.removeChild(f);if(m)l[b?"moveStart":"moveEnd"]("character",k);return l};d=function(a){this.textRange=a;this.refresh()};d.prototype=new l(document);d.prototype.refresh=function(){var a,b,e;e=this.textRange;a=e.parentElement();var d=e.duplicate();d.collapse(!0);b=d.parentElement();d=e.duplicate();d.collapse(!1);e=d.parentElement();b=b==e?b:g.getCommonAncestor(b,e);b=b==a?b:g.getCommonAncestor(a,b);a=this.textRange;0==a.compareEndPoints("StartToEnd",
a)?b=a=n(this.textRange,b,!0,!0).boundaryPosition:(e=n(this.textRange,b,!0,!1),a=e.boundaryPosition,b=n(this.textRange,b,!1,!1,e.nodeInfo).boundaryPosition);this.setStart(a.node,a.offset);this.setEnd(b.node,b.offset)};d.prototype.getName=function(){return"WrappedTextRange"};l.copyComparisonConstants(d);var p=function(a){if(a.collapsed)return r(new f(a.startContainer,a.startOffset),!0);var b=r(new f(a.startContainer,a.startOffset),!0),e=r(new f(a.endContainer,a.endOffset),!1);a=h(l.getRangeDocument(a)).createTextRange();
a.setEndPoint("StartToStart",b);a.setEndPoint("EndToEnd",e);return a};d.rangeToTextRange=p;d.prototype.toTextRange=function(){return p(this)};a.WrappedTextRange=d;if(!a.features.implementsDomRange||a.config.preferTextRange){var s=function(){return this}();"undefined"==typeof s.Range&&(s.Range=d);a.createNativeRange=function(a){a=m(a,b,"createNativeRange");return h(a).createTextRange()};a.WrappedRange=d}}a.createRange=function(e){e=m(e,b,"createRange");return new a.WrappedRange(a.createNativeRange(e))};
a.createRangyRange=function(a){a=m(a,b,"createRangyRange");return new l(a)};a.createIframeRange=function(e){b.deprecationNotice("createIframeRange()","createRange(iframeEl)");return a.createRange(e)};a.createIframeRangyRange=function(e){b.deprecationNotice("createIframeRangyRange()","createRangyRange(iframeEl)");return a.createRangyRange(e)};a.addShimListener(function(b){var e=b.document;"undefined"==typeof e.createRange&&(e.createRange=function(){return a.createRange(e)});e=b=null})}),w.createCoreModule("WrappedSelection",
["DomRange","WrappedRange"],function(a,b){function e(a){return"string"==typeof a?/^backward(s)?$/i.test(a):!!a}function d(a,e){if(a){if(C.isWindow(a))return a;if(a instanceof x)return a.win;var g=C.getContentDocument(a,b,e);return C.getWindow(g)}return window}function g(a){return d(a,"getWinSelection").getSelection()}function k(a){return d(a,"getDocSelection").document.selection}function f(a){var b=!1;a.anchorNode&&(b=1==C.comparePoints(a.anchorNode,a.anchorOffset,a.focusNode,a.focusOffset));return b}
function l(a,b,e){var d=e?"end":"start";e=e?"start":"end";a.anchorNode=b[d+"Container"];a.anchorOffset=b[d+"Offset"];a.focusNode=b[e+"Container"];a.focusOffset=b[e+"Offset"]}function h(a){a.anchorNode=a.focusNode=null;a.anchorOffset=a.focusOffset=0;a.rangeCount=0;a.isCollapsed=!0;a._ranges.length=0}function m(b){var e;b instanceof H?(e=a.createNativeRange(b.getDocument()),e.setEnd(b.endContainer,b.endOffset),e.setStart(b.startContainer,b.startOffset)):b instanceof Q?e=b.nativeRange:J.implementsDomRange&&
b instanceof C.getWindow(b.startContainer).Range&&(e=b);return e}function n(a){var e=a.getNodes(),d;a:if(e.length&&1==e[0].nodeType){d=1;for(var g=e.length;d<g;++d)if(!C.isAncestorOf(e[0],e[d])){d=!1;break a}d=!0}else d=!1;if(!d)throw b.createError("getSingleElementFromRange: range "+a.inspect()+" did not consist of a single element");return e[0]}function q(a){return!!a&&"undefined"!=typeof a.text}function r(a,b){var e=new Q(b);a._ranges=[e];l(a,e,!1);a.rangeCount=1;a.isCollapsed=e.collapsed}function p(b){b._ranges.length=
0;if("None"==b.docSelection.type)h(b);else{var e=b.docSelection.createRange();if(q(e))r(b,e);else{b.rangeCount=e.length;for(var d,g=N(e.item(0)),k=0;k<b.rangeCount;++k)d=a.createRange(g),d.selectNode(e.item(k)),b._ranges.push(d);b.isCollapsed=1==b.rangeCount&&b._ranges[0].collapsed;l(b,b._ranges[b.rangeCount-1],!1)}}}function s(a,e){for(var d=a.docSelection.createRange(),g=n(e),k=N(d.item(0)),k=S(k).createControlRange(),f=0,l=d.length;f<l;++f)k.add(d.item(f));try{k.add(g)}catch(h){throw b.createError("addRange(): Element within the specified Range could not be added to control selection (does it have layout?)");
}k.select();p(a)}function x(a,b,e){this.nativeSelection=a;this.docSelection=b;this._ranges=[];this.win=e;this.refresh()}function t(a){a.win=a.anchorNode=a.focusNode=a._ranges=null;a.rangeCount=a.anchorOffset=a.focusOffset=0;a.detached=!0}function u(a,b){for(var e=O.length,d,g;e--;)if(d=O[e],g=d.selection,"deleteAll"==b)t(g);else if(d.win==a)return"delete"==b?(O.splice(e,1),!0):g;"deleteAll"==b&&(O.length=0);return null}function F(a,e){for(var d=N(e[0].startContainer),d=S(d).createControlRange(),g=
0,k,f=e.length;g<f;++g){k=n(e[g]);try{d.add(k)}catch(l){throw b.createError("setRanges(): Element within one of the specified Ranges could not be added to control selection (does it have layout?)");}}d.select();p(a)}function E(a,b){if(a.win.document!=N(b))throw new K("WRONG_DOCUMENT_ERR");}function w(b){return function(e,d){var g;this.rangeCount?(g=this.getRangeAt(0),g["set"+(b?"Start":"End")](e,d)):(g=a.createRange(this.win.document),g.setStartAndEnd(e,d));this.setSingleRange(g,this.isBackward())}}
function A(a){var b=[],e=new qa(a.anchorNode,a.anchorOffset),d=new qa(a.focusNode,a.focusOffset),g="function"==typeof a.getName?a.getName():"Selection";if("undefined"!=typeof a.rangeCount)for(var k=0,f=a.rangeCount;k<f;++k)b[k]=H.inspect(a.getRangeAt(k));return"["+g+"(Ranges: "+b.join(", ")+")(anchor: "+e.inspect()+", focus: "+d.inspect()+"]"}a.config.checkSelectionRanges=!0;var C=a.dom,z=a.util,G=z.isHostMethod,H=a.DomRange,Q=a.WrappedRange,K=a.DOMException,qa=C.DomPosition,Z,ba,J=a.features,N=C.getDocument,
S=C.getBody,T=H.rangesEqual,y=G(window,"getSelection"),P=z.isHostObject(document,"selection");J.implementsWinGetSelection=y;var W=(J.implementsDocSelection=P)&&(!y||a.config.preferTextRange);W?(Z=k,a.isSelectionValid=function(a){a=d(a,"isSelectionValid").document;var b=a.selection;return"None"!=b.type||N(b.createRange().parentElement())==a}):y?(Z=g,a.isSelectionValid=function(){return!0}):b.fail("Neither document.selection or window.getSelection() detected.");a.getNativeSelection=Z;var y=Z(),D=a.createNativeRange(document),
v=S(document),L=z.areHostProperties(y,["anchorNode","focusNode","anchorOffset","focusOffset"]);J.selectionHasAnchorAndFocus=L;var R=G(y,"extend");J.selectionHasExtend=R;var aa="number"==typeof y.rangeCount;J.selectionHasRangeCount=aa;var B=!1,fa=!0,X=R?function(b,e){var d=H.getRangeDocument(e),d=a.createRange(d);d.collapseToPoint(e.endContainer,e.endOffset);b.addRange(m(d));b.extend(e.startContainer,e.startOffset)}:null;z.areHostMethods(y,["addRange","getRangeAt","removeAllRanges"])&&"number"==typeof y.rangeCount&&
J.implementsDomRange&&function(){var b=window.getSelection();if(b){for(var e=b.rangeCount,d=1<e,g=[],k=f(b),l=0;l<e;++l)g[l]=b.getRangeAt(l);var l=S(document),h=l.appendChild(document.createElement("div"));h.contentEditable="false";var m=h.appendChild(document.createTextNode("\u00a0\u00a0\u00a0")),n=document.createRange();n.setStart(m,1);n.collapse(!0);b.addRange(n);fa=1==b.rangeCount;b.removeAllRanges();d||((d=window.navigator.appVersion.match(/Chrome\/(.*?) /))&&36<=parseInt(d[1])?B=!1:(d=n.cloneRange(),
n.setStart(m,0),d.setEnd(m,3),d.setStart(m,2),b.addRange(n),b.addRange(d),B=2==b.rangeCount));l.removeChild(h);b.removeAllRanges();for(l=0;l<e;++l)0==l&&k?X?X(b,g[l]):(a.warn("Rangy initialization: original selection was backwards but selection has been restored forwards because the browser does not support Selection.extend"),b.addRange(g[l])):b.addRange(g[l])}}();J.selectionSupportsMultipleRanges=B;J.collapsedNonEditableSelectionsSupported=fa;var M=!1;v&&G(v,"createControlRange")&&(v=v.createControlRange(),
z.areHostProperties(v,["item","add"])&&(M=!0));J.implementsControlRange=M;ba=L?function(a){return a.anchorNode===a.focusNode&&a.anchorOffset===a.focusOffset}:function(a){return a.rangeCount?a.getRangeAt(a.rangeCount-1).collapsed:!1};var Y;G(y,"getRangeAt")?Y=function(a,b){try{return a.getRangeAt(b)}catch(e){return null}}:L&&(Y=function(b){var e=N(b.anchorNode),e=a.createRange(e);e.setStartAndEnd(b.anchorNode,b.anchorOffset,b.focusNode,b.focusOffset);e.collapsed!==this.isCollapsed&&e.setStartAndEnd(b.focusNode,
b.focusOffset,b.anchorNode,b.anchorOffset);return e});x.prototype=a.selectionPrototype;var O=[],ga=function(a){if(a&&a instanceof x)return a.refresh(),a;a=d(a,"getNativeSelection");var b=u(a),e=Z(a),g=P?k(a):null;b?(b.nativeSelection=e,b.docSelection=g,b.refresh()):(b=new x(e,g,a),O.push({win:a,selection:b}));return b};a.getSelection=ga;a.getIframeSelection=function(e){b.deprecationNotice("getIframeSelection()","getSelection(iframeEl)");return a.getSelection(C.getIframeWindow(e))};v=x.prototype;if(!W&&
L&&z.areHostMethods(y,["removeAllRanges","addRange"]))v.removeAllRanges=function(){this.nativeSelection.removeAllRanges();h(this)},v.addRange=aa?function(b,d){if(M&&P&&"Control"==this.docSelection.type)s(this,b);else if(e(d)&&R)X(this.nativeSelection,b),this.refresh();else{var g;B?g=this.rangeCount:(this.removeAllRanges(),g=0);this.nativeSelection.addRange(m(b).cloneRange());this.rangeCount=this.nativeSelection.rangeCount;this.rangeCount==g+1?(a.config.checkSelectionRanges&&(g=Y(this.nativeSelection,
this.rangeCount-1))&&!T(g,b)&&(b=new Q(g)),this._ranges[this.rangeCount-1]=b,l(this,b,da(this.nativeSelection)),this.isCollapsed=ba(this)):this.refresh()}}:function(a,b){e(b)&&R?X(this.nativeSelection,a):this.nativeSelection.addRange(m(a));this.refresh()},v.setRanges=function(a){if(M&&P&&1<a.length)F(this,a);else{this.removeAllRanges();for(var b=0,e=a.length;b<e;++b)this.addRange(a[b])}};else if(G(y,"empty")&&G(D,"select")&&M&&W)v.removeAllRanges=function(){try{if(this.docSelection.empty(),"None"!=
this.docSelection.type){var a;if(this.anchorNode)a=N(this.anchorNode);else if("Control"==this.docSelection.type){var b=this.docSelection.createRange();b.length&&(a=N(b.item(0)))}a&&(S(a).createTextRange().select(),this.docSelection.empty())}}catch(e){}h(this)},v.addRange=function(b){"Control"==this.docSelection.type?s(this,b):(a.WrappedTextRange.rangeToTextRange(b).select(),this._ranges[0]=b,this.rangeCount=1,this.isCollapsed=this._ranges[0].collapsed,l(this,b,!1))},v.setRanges=function(a){this.removeAllRanges();
var b=a.length;1<b?F(this,a):b&&this.addRange(a[0])};else return b.fail("No means of selecting a Range or TextRange was found"),!1;v.getRangeAt=function(a){if(0>a||a>=this.rangeCount)throw new K("INDEX_SIZE_ERR");return this._ranges[a].cloneRange()};var ca;if(W)ca=function(b){var e;a.isSelectionValid(b.win)?e=b.docSelection.createRange():(e=S(b.win.document).createTextRange(),e.collapse(!0));"Control"==b.docSelection.type?p(b):q(e)?r(b,e):h(b)};else if(G(y,"getRangeAt")&&"number"==typeof y.rangeCount)ca=
function(b){if(M&&P&&"Control"==b.docSelection.type)p(b);else if(b._ranges.length=b.rangeCount=b.nativeSelection.rangeCount,b.rangeCount){for(var e=0,d=b.rangeCount;e<d;++e)b._ranges[e]=new a.WrappedRange(b.nativeSelection.getRangeAt(e));l(b,b._ranges[b.rangeCount-1],da(b.nativeSelection));b.isCollapsed=ba(b)}else h(b)};else if(L&&"boolean"==typeof y.isCollapsed&&"boolean"==typeof D.collapsed&&J.implementsDomRange)ca=function(a){var b;b=a.nativeSelection;b.anchorNode?(b=Y(b,0),a._ranges=[b],a.rangeCount=
1,b=a.nativeSelection,a.anchorNode=b.anchorNode,a.anchorOffset=b.anchorOffset,a.focusNode=b.focusNode,a.focusOffset=b.focusOffset,a.isCollapsed=ba(a)):h(a)};else return b.fail("No means of obtaining a Range or TextRange from the user's selection was found"),!1;v.refresh=function(a){var b=a?this._ranges.slice(0):null,e=this.anchorNode,d=this.anchorOffset;ca(this);if(a){a=b.length;if(a!=this._ranges.length||this.anchorNode!=e||this.anchorOffset!=d)return!0;for(;a--;)if(!T(b[a],this._ranges[a]))return!0;
return!1}};var ha=function(a,b){var e=a.getAllRanges();a.removeAllRanges();for(var d=0,g=e.length;d<g;++d)T(b,e[d])||a.addRange(e[d]);a.rangeCount||h(a)};v.removeRange=M&&P?function(a){if("Control"==this.docSelection.type){var b=this.docSelection.createRange();a=n(a);for(var e=N(b.item(0)),e=S(e).createControlRange(),d,g=!1,k=0,f=b.length;k<f;++k)d=b.item(k),d!==a||g?e.add(b.item(k)):g=!0;e.select();p(this)}else ha(this,a)}:function(a){ha(this,a)};var da;!W&&L&&J.implementsDomRange?(da=f,v.isBackward=
function(){return da(this)}):da=v.isBackward=function(){return!1};v.isBackwards=v.isBackward;v.toString=function(){for(var a=[],b=0,e=this.rangeCount;b<e;++b)a[b]=""+this._ranges[b];return a.join("")};v.collapse=function(b,e){E(this,b);var d=a.createRange(b);d.collapseToPoint(b,e);this.setSingleRange(d);this.isCollapsed=!0};v.collapseToStart=function(){if(this.rangeCount){var a=this._ranges[0];this.collapse(a.startContainer,a.startOffset)}else throw new K("INVALID_STATE_ERR");};v.collapseToEnd=function(){if(this.rangeCount){var a=
this._ranges[this.rangeCount-1];this.collapse(a.endContainer,a.endOffset)}else throw new K("INVALID_STATE_ERR");};v.selectAllChildren=function(b){E(this,b);var e=a.createRange(b);e.selectNodeContents(b);this.setSingleRange(e)};v.deleteFromDocument=function(){if(M&&P&&"Control"==this.docSelection.type){for(var a=this.docSelection.createRange(),b;a.length;)b=a.item(0),a.remove(b),b.parentNode.removeChild(b);this.refresh()}else if(this.rangeCount&&(a=this.getAllRanges(),a.length)){this.removeAllRanges();
b=0;for(var e=a.length;b<e;++b)a[b].deleteContents();this.addRange(a[e-1])}};v.eachRange=function(a,b){for(var e=0,d=this._ranges.length;e<d;++e)if(a(this.getRangeAt(e)))return b};v.getAllRanges=function(){var a=[];this.eachRange(function(b){a.push(b)});return a};v.setSingleRange=function(a,b){this.removeAllRanges();this.addRange(a,b)};v.callMethodOnEachRange=function(a,b){var e=[];this.eachRange(function(d){e.push(d[a].apply(d,b))});return e};v.setStart=w(!0);v.setEnd=w(!1);a.rangePrototype.select=
function(a){ga(this.getDocument()).setSingleRange(this,a)};v.changeEachRange=function(a){var b=[],e=this.isBackward();this.eachRange(function(e){a(e);b.push(e)});this.removeAllRanges();e&&1==b.length?this.addRange(b[0],"backward"):this.setRanges(b)};v.containsNode=function(a,b){return this.eachRange(function(e){return e.containsNode(a,b)},!0)||!1};v.getBookmark=function(a){return{backward:this.isBackward(),rangeBookmarks:this.callMethodOnEachRange("getBookmark",[a])}};v.moveToBookmark=function(b){for(var e=
[],d=0,g,k;g=b.rangeBookmarks[d++];)k=a.createRange(this.win),k.moveToBookmark(g),e.push(k);b.backward?this.setSingleRange(e[0],"backward"):this.setRanges(e)};v.toHtml=function(){var a=[];this.eachRange(function(b){a.push(H.toHtml(b))});return a.join("")};J.implementsTextRange&&(v.getNativeTextRange=function(){var e;if(e=this.docSelection){e=e.createRange();if(q(e))return e;throw b.createError("getNativeTextRange: selection is a control selection");}if(0<this.rangeCount)return a.WrappedTextRange.rangeToTextRange(this.getRangeAt(0));
throw b.createError("getNativeTextRange: selection contains no range");});v.getName=function(){return"WrappedSelection"};v.inspect=function(){return A(this)};v.detach=function(){u(this.win,"delete");t(this)};x.detachAll=function(){u(null,"deleteAll")};x.inspect=A;x.isDirectionBackward=e;a.Selection=x;a.selectionPrototype=v;a.addShimListener(function(a){"undefined"==typeof a.getSelection&&(a.getSelection=function(){return ga(a)});a=null})}),w},this);
(function(b,d){"function"==typeof define&&define.amd?define(["rangy"],b):b(d.rangy)})(function(b){b.createModule("SaveRestore",["WrappedRange"],function(b,f){function h(a,b){var e="selectionBoundary_"+ +new Date+"_"+(""+Math.random()).slice(2),d,g=p.getDocument(a.startContainer),k=a.cloneRange();k.collapse(b);d=g.createElement("span");d.id=e;d.style.lineHeight="0";d.style.display="none";d.className="rangySelectionBoundary";d.appendChild(g.createTextNode(n));k.insertNode(d);return d}function e(a,b,
e,d){(a=(a||document).getElementById(e))?(b[d?"setStartBefore":"setEndBefore"](a),a.parentNode.removeChild(a)):f.warn("Marker element has been removed. Cannot restore selection.")}function a(a,b){return b.compareBoundaryPoints(a.START_TO_START,a)}function g(a,e){var g,k,f=b.DomRange.getRangeDocument(a),l=a.toString();if(a.collapsed)return k=h(a,!1),{document:f,markerId:k.id,collapsed:!0};k=h(a,!1);g=h(a,!0);return{document:f,startMarkerId:g.id,endMarkerId:k.id,collapsed:!1,backward:e,toString:function(){return"original text: '"+
l+"', new text: '"+a.toString()+"'"}}}function k(a,g){var k=a.document;"undefined"==typeof g&&(g=!0);var l=b.createRange(k);if(a.collapsed)if(k=(k||document).getElementById(a.markerId)){k.style.display="inline";var h=k.previousSibling;h&&3==h.nodeType?(k.parentNode.removeChild(k),l.collapseToPoint(h,h.length)):(l.collapseBefore(k),k.parentNode.removeChild(k))}else f.warn("Marker element has been removed. Cannot restore selection.");else e(k,l,a.startMarkerId,!0),e(k,l,a.endMarkerId,!1);g&&l.normalizeBoundaries();
return l}function l(e,k){var f=[],l,h;e=e.slice(0);e.sort(a);var m=0;for(l=e.length;m<l;++m)f[m]=g(e[m],k);for(m=l-1;0<=m;--m)l=e[m],h=b.DomRange.getRangeDocument(l),l.collapsed?l.collapseAfter((h||document).getElementById(f[m].markerId)):(l.setEndBefore((h||document).getElementById(f[m].endMarkerId)),l.setStartAfter((h||document).getElementById(f[m].startMarkerId)));return f}function q(a){for(var b=[],e=a.length-1;0<=e;e--)b[e]=k(a[e],!0);return b}function m(a,b){var e=(a||document).getElementById(b);
e&&e.parentNode.removeChild(e)}var p=b.dom,n="\ufeff";b.util.extend(b,{saveRange:g,restoreRange:k,saveRanges:l,restoreRanges:q,saveSelection:function(a){if(!b.isSelectionValid(a))return f.warn("Cannot save selection. This usually happens when the selection is collapsed and the selection document has lost focus."),null;var e=b.getSelection(a),g=e.getAllRanges(),k=1==g.length&&e.isBackward(),h=l(g,k);k?e.setSingleRange(g[0],"backward"):e.setRanges(g);return{win:a,rangeInfos:h,restored:!1}},restoreSelection:function(a,
e){if(!a.restored){var g=a.rangeInfos,k=b.getSelection(a.win),f=q(g);1==g.length&&e&&b.features.selectionHasExtend&&g[0].backward?(k.removeAllRanges(),k.addRange(f[0],!0)):k.setRanges(f);a.restored=!0}},removeMarkerElement:m,removeMarkers:function(a){for(var b=a.rangeInfos,e=0,d=b.length,g;e<d;++e)g=b[e],g.collapsed?m(a.doc,g.markerId):(m(a.doc,g.startMarkerId),m(a.doc,g.endMarkerId))}})})},this);var Base=function(){};
Base.extend=function(b,d){var f=Base.prototype.extend;Base._prototyping=!0;var h=new this;f.call(h,b);h.base=function(){};delete Base._prototyping;var e=h.constructor,a=h.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==a)this._constructing=!0,e.apply(this,arguments),delete this._constructing;else if(null!=arguments[0])return(arguments[0].extend||f).call(arguments[0],h)};a.ancestor=this;a.extend=this.extend;a.forEach=this.forEach;a.implement=this.implement;a.prototype=
h;a.toString=this.toString;a.valueOf=function(b){return"object"==b?a:e.valueOf()};f.call(a,d);"function"==typeof a.init&&a.init();return a};
Base.prototype={extend:function(b,d){if(1<arguments.length){var f=this[b];if(f&&"function"==typeof d&&(!f.valueOf||f.valueOf()!=d.valueOf())&&/\bbase\b/.test(d)){var h=d.valueOf();d=function(){var a=this.base||Base.prototype.base;this.base=f;var b=h.apply(this,arguments);this.base=a;return b};d.valueOf=function(a){return"object"==a?d:h};d.toString=Base.toString}this[b]=d}else if(b){var e=Base.prototype.extend;Base._prototyping||"function"==typeof this||(e=this.extend||e);for(var a={toSource:null},
g=["constructor","toString","valueOf"],k=Base._prototyping?0:1;l=g[k++];)b[l]!=a[l]&&e.call(this,l,b[l]);for(var l in b)a[l]||e.call(this,l,b[l])}return this}};
Base=Base.extend({constructor:function(b){this.extend(b)}},{ancestor:Object,version:"1.1",forEach:function(b,d,f){for(var h in b)void 0===this.prototype[h]&&d.call(f,b[h],h,b)},implement:function(){for(var b=0;b<arguments.length;b++)if("function"==typeof arguments[b])arguments[b](this.prototype);else this.prototype.extend(arguments[b]);return this},toString:function(){return String(this.valueOf())}});
wysihtml5.browser=function(){function b(a,b){var e=-1,d;"Microsoft Internet Explorer"==navigator.appName?d=/MSIE ([0-9]{1,}[.0-9]{0,})/:"Netscape"==navigator.appName&&(d=/Trident\/.*rv:([0-9]{1,}[.0-9]{0,})/);d&&null!=d.exec(navigator.userAgent)&&(e=parseFloat(RegExp.$1));if(-1===e)return!1;if(!a)return!0;if(!b)return a===e;if("<"===b)return a<e;if(">"===b)return a>e;if("<="===b)return a<=e;if(">="===b)return a>=e}var d=navigator.userAgent,f=document.createElement("div"),h=-1!==d.indexOf("Gecko")&&
-1===d.indexOf("KHTML"),e=-1!==d.indexOf("AppleWebKit/"),a=-1!==d.indexOf("Chrome/"),g=-1!==d.indexOf("Opera/");return{USER_AGENT:d,supported:function(){var a=this.USER_AGENT.toLowerCase(),b="contentEditable"in f,e=document.execCommand&&document.queryCommandSupported&&document.queryCommandState,d=document.querySelector&&document.querySelectorAll,g;if(g=this.isIos())g=5>+(/ipad|iphone|ipod/.test(a)&&a.match(/ os (\d+).+? like mac os x/)||[void 0,0])[1];a=g||this.isAndroid()&&4>+(a.match(/android (\d+)/)||
[void 0,0])[1]||-1!==a.indexOf("opera mobi")||-1!==a.indexOf("hpwos/");return b&&e&&d&&!a},isTouchDevice:function(){return this.supportsEvent("touchmove")},isIos:function(){return/ipad|iphone|ipod/i.test(this.USER_AGENT)},isAndroid:function(){return-1!==this.USER_AGENT.indexOf("Android")},supportsSandboxedIframes:function(){return b()},throwsMixedContentWarningWhenIframeSrcIsEmpty:function(){return!("querySelector"in document)},displaysCaretInEmptyContentEditableCorrectly:function(){return b()},hasCurrentStyleProperty:function(){return"currentStyle"in
f},hasHistoryIssue:function(){return h&&"Mac"===navigator.platform.substr(0,3)},insertsLineBreaksOnReturn:function(){return h},supportsPlaceholderAttributeOn:function(a){return"placeholder"in a},supportsEvent:function(a){var b;(b="on"+a in f)||(f.setAttribute("on"+a,"return;"),b="function"===typeof f["on"+a]);return b},supportsEventsInIframeCorrectly:function(){return!g},supportsHTML5Tags:function(a){a=a.createElement("div");a.innerHTML="<article>foo</article>";return"<article>foo</article>"===a.innerHTML.toLowerCase()},
supportsCommand:function(){var a={formatBlock:b(10,"<="),insertUnorderedList:b(),insertOrderedList:b()},e={insertHTML:h};return function(b,d){if(!a[d]){try{return b.queryCommandSupported(d)}catch(g){}try{return b.queryCommandEnabled(d)}catch(f){return!!e[d]}}return!1}}(),doesAutoLinkingInContentEditable:function(){return b()},canDisableAutoLinking:function(){return this.supportsCommand(document,"AutoUrlDetect")},clearsContentEditableCorrectly:function(){return h||g||e},supportsGetAttributeCorrectly:function(){return"1"!=
document.createElement("td").getAttribute("rowspan")},canSelectImagesInContentEditable:function(){return h||b()||g},autoScrollsToCaret:function(){return!e},autoClosesUnclosedTags:function(){var a=f.cloneNode(!1),b;a.innerHTML="<p><div></div>";a=a.innerHTML.toLowerCase();b="<p></p><div></div>"===a||"<p><div></div></p>"===a;this.autoClosesUnclosedTags=function(){return b};return b},supportsNativeGetElementsByClassName:function(){return-1!==String(document.getElementsByClassName).indexOf("[native code]")},
supportsSelectionModify:function(){return"getSelection"in window&&"modify"in window.getSelection()},needsSpaceAfterLineBreak:function(){return g},supportsSpeechApiOn:function(a){return 11<=(d.match(/Chrome\/(\d+)/)||[void 0,0])[1]&&("onwebkitspeechchange"in a||"speech"in a)},crashesWhenDefineProperty:function(a){return b(9)&&("XMLHttpRequest"===a||"XDomainRequest"===a)},doesAsyncFocus:function(){return b()},hasProblemsSettingCaretAfterImg:function(){return b()},hasUndoInContextMenu:function(){return h||
a||g},hasInsertNodeIssue:function(){return g},hasIframeFocusIssue:function(){return b()},createsNestedInvalidMarkupAfterPaste:function(){return e},supportsMutationEvents:function(){return"MutationEvent"in window},supportsModenPaste:function(){return!("clipboardData"in window)}}}();
wysihtml5.lang.array=function(b){return{contains:function(d){if(Array.isArray(d)){for(var f=d.length;f--;)if(-1!==wysihtml5.lang.array(b).indexOf(d[f]))return!0;return!1}return-1!==wysihtml5.lang.array(b).indexOf(d)},indexOf:function(d){if(b.indexOf)return b.indexOf(d);for(var f=0,h=b.length;f<h;f++)if(b[f]===d)return f;return-1},without:function(d){d=wysihtml5.lang.array(d);for(var f=[],h=0,e=b.length;h<e;h++)d.contains(b[h])||f.push(b[h]);return f},get:function(){for(var d=0,f=b.length,h=[];d<f;d++)h.push(b[d]);
return h},map:function(d,f){if(Array.prototype.map)return b.map(d,f);for(var h=b.length>>>0,e=Array(h),a=0;a<h;a++)e[a]=d.call(f,b[a],a,b);return e},unique:function(){for(var d=[],f=b.length,h=0;h<f;)wysihtml5.lang.array(d).contains(b[h])||d.push(b[h]),h++;return d}}};
wysihtml5.lang.Dispatcher=Base.extend({on:function(b,d){this.events=this.events||{};this.events[b]=this.events[b]||[];this.events[b].push(d);return this},off:function(b,d){this.events=this.events||{};var f=0,h,e;if(b){h=this.events[b]||[];for(e=[];f<h.length;f++)h[f]!==d&&d&&e.push(h[f]);this.events[b]=e}else this.events={};return this},fire:function(b,d){this.events=this.events||{};for(var f=this.events[b]||[],h=0;h<f.length;h++)f[h].call(this,d);return this},observe:function(){return this.on.apply(this,
arguments)},stopObserving:function(){return this.off.apply(this,arguments)}});
wysihtml5.lang.object=function(b){return{merge:function(d){for(var f in d)b[f]=d[f];return this},get:function(){return b},clone:function(d){var f={},h;if(null===b||!wysihtml5.lang.object(b).isPlainObject())return b;for(h in b)b.hasOwnProperty(h)&&(f[h]=d?wysihtml5.lang.object(b[h]).clone(d):b[h]);return f},isArray:function(){return"[object Array]"===Object.prototype.toString.call(b)},isFunction:function(){return"[object Function]"===Object.prototype.toString.call(b)},isPlainObject:function(){return"[object Object]"===
Object.prototype.toString.call(b)}}};
(function(){var b=/^\s+/,d=/\s+$/,f=/[&<>\t"]/g,h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","\t":"&nbsp; "};wysihtml5.lang.string=function(e){e=String(e);return{trim:function(){return e.replace(b,"").replace(d,"")},interpolate:function(a){for(var b in a)e=this.replace("#{"+b+"}").by(a[b]);return e},replace:function(a){return{by:function(b){return e.split(a).join(b)}}},escapeHTML:function(a,b){var d=e.replace(f,function(a){return h[a]});a&&(d=d.replace(/(?:\r\n|\r|\n)/g,"<br />"));b&&(d=d.replace(/  /gi,
"&nbsp; "));return d}}}})();
(function(b){function d(b){return b.replace(e,function(b,e){var d=(e.match(a)||[])[1]||"",f=k[d];e=e.replace(a,"");e.split(f).length>e.split(d).length&&(e+=d,d="");var l=f=e;e.length>g&&(l=l.substr(0,g)+"...");"www."===f.substr(0,4)&&(f="http://"+f);return'<a href="'+f+'">'+l+"</a>"+d})}function f(a,g){if(!(h.contains(a.nodeName)||a.className&&b.lang.array(a.className.split(" ")).contains(g)))if(a.nodeType===b.TEXT_NODE&&a.data.match(e)){var k=a.parentNode,p=b.lang.string(a.data).escapeHTML(),n;n=
k.ownerDocument;var r=n._wysihtml5_tempElement;r||(r=n._wysihtml5_tempElement=n.createElement("div"));n=r;n.innerHTML="<span></span>"+d(p);for(n.removeChild(n.firstChild);n.firstChild;)k.insertBefore(n.firstChild,a);k.removeChild(a)}else{k=b.lang.array(a.childNodes).get();p=k.length;for(n=0;n<p;n++)f(k[n],g);return a}}var h=b.lang.array("CODE PRE A SCRIPT HEAD TITLE STYLE".split(" ")),e=/((https?:\/\/|www\.)[^\s<]{3,})/gi,a=/([^\w\/\-](,?))$/i,g=100,k={")":"(","]":"[","}":"{"};b.dom.autoLink=function(a,
e){var d;a:{d=a;for(var g;d.parentNode;){d=d.parentNode;g=d.nodeName;if(d.className&&b.lang.array(d.className.split(" ")).contains(e)||h.contains(g)){d=!0;break a}if("body"===g)break}d=!1}if(d)return a;a===a.ownerDocument.documentElement&&(a=a.ownerDocument.body);return f(a,e)};b.dom.autoLink.URL_REG_EXP=e})(wysihtml5);
(function(b){var d=b.dom;d.addClass=function(b,h){var e=b.classList;if(e)return e.add(h);d.hasClass(b,h)||(b.className+=" "+h)};d.removeClass=function(b,d){var e=b.classList;if(e)return e.remove(d);b.className=b.className.replace(new RegExp("(^|\\s+)"+d+"(\\s+|$)")," ")};d.hasClass=function(b,d){var e=b.classList;if(e)return e.contains(d);e=b.className;return 0<e.length&&(e==d||(new RegExp("(^|\\s)"+d+"(\\s|$)")).test(e))}})(wysihtml5);
wysihtml5.dom.contains=function(){var b=document.documentElement;if(b.contains)return function(b,f){f.nodeType!==wysihtml5.ELEMENT_NODE&&(f=f.parentNode);return b!==f&&b.contains(f)};if(b.compareDocumentPosition)return function(b,f){return!!(b.compareDocumentPosition(f)&16)}}();
wysihtml5.dom.convertToList=function(){function b(b,f){var h=b.createElement("li");f.appendChild(h);return h}return function(d,f,h){if("UL"===d.nodeName||"OL"===d.nodeName||"MENU"===d.nodeName)return d;var e=d.ownerDocument;f=e.createElement(f);var a=d.querySelectorAll("br"),g=a.length,k,l,q,m,p;for(p=0;p<g;p++)for(l=a[p];(k=l.parentNode)&&k!==d&&k.lastChild===l;){if("block"===wysihtml5.dom.getStyle("display").from(k)){k.removeChild(l);break}wysihtml5.dom.insert(l).after(l.parentNode)}k=wysihtml5.lang.array(d.childNodes).get();
a=k.length;for(p=0;p<a;p++)m=m||b(e,f),g=k[p],l="block"===wysihtml5.dom.getStyle("display").from(g),q="BR"===g.nodeName,!l||h&&wysihtml5.dom.hasClass(g,h)?q?m=m.firstChild?null:m:m.appendChild(g):(m=m.firstChild?b(e,f):m,m.appendChild(g),m=null);0===k.length&&b(e,f);d.parentNode.replaceChild(f,d);return f}}();wysihtml5.dom.copyAttributes=function(b){return{from:function(d){return{to:function(f){for(var h,e=0,a=b.length;e<a;e++)h=b[e],"undefined"!==typeof d[h]&&""!==d[h]&&(f[h]=d[h]);return{andTo:arguments.callee}}}}}};
(function(b){var d=["-webkit-box-sizing","-moz-box-sizing","-ms-box-sizing","box-sizing"],f=function(f){var e;a:{e=0;for(var a=d.length;e<a;e++)if("border-box"===b.getStyle(d[e]).from(f)){e=d[e];break a}e=void 0}return e?parseInt(b.getStyle("width").from(f),10)<f.offsetWidth:!1};b.copyStyles=function(h){return{from:function(e){f(e)&&(h=wysihtml5.lang.array(h).without(d));for(var a="",g=h.length,k=0,l;k<g;k++)l=h[k],a+=l+":"+b.getStyle(l).from(e)+";";return{to:function(e){b.setStyles(a).on(e);return{andTo:arguments.callee}}}}}}})(wysihtml5.dom);
(function(b){b.dom.delegate=function(d,f,h,e){return b.dom.observe(d,h,function(a){for(var g=a.target,k=b.lang.array(d.querySelectorAll(f));g&&g!==d;){if(k.contains(g)){e.call(g,a);break}g=g.parentNode}})}})(wysihtml5);
(function(b){b.dom.domNode=function(d){var f=[b.ELEMENT_NODE,b.TEXT_NODE];return{prev:function(h){var e=d.previousSibling;return e?!b.lang.array(h&&h.nodeTypes?h.nodeTypes:f).contains(e.nodeType)||h&&h.ignoreBlankTexts&&e.nodeType===b.TEXT_NODE&&/^\s*$/g.test(e.data)?b.dom.domNode(e).prev(h):e:null},next:function(h){var e=d.nextSibling;return e?!b.lang.array(h&&h.nodeTypes?h.nodeTypes:f).contains(e.nodeType)||h&&h.ignoreBlankTexts&&e.nodeType===b.TEXT_NODE&&/^\s*$/g.test(e.data)?b.dom.domNode(e).next(h):
e:null}}}})(wysihtml5);
wysihtml5.dom.getAsDom=function(){var b="abbr article aside audio bdi canvas command datalist details figcaption figure footer header hgroup keygen mark meter nav output progress rp rt ruby svg section source summary time track video wbr".split(" ");return function(d,f){f=f||document;var h;if("object"===typeof d&&d.nodeType)h=f.createElement("div"),h.appendChild(d);else if(wysihtml5.browser.supportsHTML5Tags(f))h=f.createElement("div"),h.innerHTML=d;else{h=f;if(!h._wysihtml5_supportsHTML5Tags){for(var e=0,
a=b.length;e<a;e++)h.createElement(b[e]);h._wysihtml5_supportsHTML5Tags=!0}h=f;e=h.createElement("div");e.style.display="none";h.body.appendChild(e);try{e.innerHTML=d}catch(g){}h.body.removeChild(e);h=e}return h}}();
wysihtml5.dom.getParentElement=function(){return function(b,d,f,h){var e=d.cssStyle||d.styleRegExp,a=d.className||d.classRegExp;for(f=f||50;f--&&b&&"BODY"!==b.nodeName&&(!h||b!==h);){var g;if(g=b.nodeType===wysihtml5.ELEMENT_NODE){g=b.nodeName;var k=d.nodeName;g=k&&k.length?"string"===typeof k?g===k:wysihtml5.lang.array(k).contains(g):!0;g&&((g=!e)||(g=d.cssStyle,k=d.styleRegExp,k=(b.getAttribute("style")||"").match(k)||[],g=g?k[k.length-1]===g:!!k.length),g&&!(g=!a)&&(g=d.className,k=(b.className||
"").match(d.classRegExp)||[],g=g?k[k.length-1]===g:!!k.length))}if(g)return b;b=b.parentNode}return null}}();
wysihtml5.dom.getStyle=function(){function b(b){return b.replace(f,function(b){return b.charAt(1).toUpperCase()})}var d={"float":"styleFloat"in document.createElement("div").style?"styleFloat":"cssFloat"},f=/\-[a-z]/g;return function(f){return{from:function(e){if(e.nodeType===wysihtml5.ELEMENT_NODE){var a=e.ownerDocument,g=d[f]||b(f),k=e.style,l=e.currentStyle,q=k[g];if(q)return q;if(l)try{return l[g]}catch(m){}var g=a.defaultView||a.parentWindow,a=("height"===f||"width"===f)&&"TEXTAREA"===e.nodeName,
p;if(g.getComputedStyle)return a&&(p=k.overflow,k.overflow="hidden"),e=g.getComputedStyle(e,null).getPropertyValue(f),a&&(k.overflow=p||""),e}}}}}();wysihtml5.dom.getTextNodes=function(b,d){var f=[];for(b=b.firstChild;b;b=b.nextSibling)3==b.nodeType?d&&/^\s*$/.test(b.innerText||b.textContent)||f.push(b):f=f.concat(wysihtml5.dom.getTextNodes(b,d));return f};
wysihtml5.dom.hasElementWithTagName=function(){var b={},d=1;return function(f,h){var e=(f._wysihtml5_identifier||(f._wysihtml5_identifier=d++))+":"+h,a=b[e];a||(a=b[e]=f.getElementsByTagName(h));return 0<a.length}}();(function(b){var d={},f=1;b.dom.hasElementWithClassName=function(h,e){if(!b.browser.supportsNativeGetElementsByClassName())return!!h.querySelector("."+e);var a=(h._wysihtml5_identifier||(h._wysihtml5_identifier=f++))+":"+e,g=d[a];g||(g=d[a]=h.getElementsByClassName(e));return 0<g.length}})(wysihtml5);
wysihtml5.dom.insert=function(b){return{after:function(d){d.parentNode.insertBefore(b,d.nextSibling)},before:function(d){d.parentNode.insertBefore(b,d)},into:function(d){d.appendChild(b)}}};wysihtml5.dom.insertCSS=function(b){b=b.join("\n");return{into:function(d){var f=d.createElement("style");f.type="text/css";f.styleSheet?f.styleSheet.cssText=b:f.appendChild(d.createTextNode(b));var h=d.querySelector("head link");h?h.parentNode.insertBefore(f,h):(d=d.querySelector("head"))&&d.appendChild(f)}}};
(function(b){b.dom.lineBreaks=function(d){function f(d){return"BR"===d.nodeName||"block"===b.dom.getStyle("display").from(d)?!0:!1}return{add:function(h){h=d.ownerDocument;var e=b.dom.domNode(d).next({ignoreBlankTexts:!0}),a=b.dom.domNode(d).prev({ignoreBlankTexts:!0});e&&!f(e)&&b.dom.insert(h.createElement("br")).after(d);a&&!f(a)&&b.dom.insert(h.createElement("br")).before(d)},remove:function(f){f=b.dom.domNode(d).next({ignoreBlankTexts:!0});var e=b.dom.domNode(d).prev({ignoreBlankTexts:!0});f&&
"BR"===f.nodeName&&f.parentNode.removeChild(f);e&&"BR"===e.nodeName&&e.parentNode.removeChild(e)}}}})(wysihtml5);
wysihtml5.dom.observe=function(b,d,f){d="string"===typeof d?[d]:d;for(var h,e,a=0,g=d.length;a<g;a++)e=d[a],b.addEventListener?b.addEventListener(e,f,!1):(h=function(a){"target"in a||(a.target=a.srcElement);a.preventDefault=a.preventDefault||function(){this.returnValue=!1};a.stopPropagation=a.stopPropagation||function(){this.cancelBubble=!0};f.call(b,a)},b.attachEvent("on"+e,h));return{stop:function(){for(var a,e=0,g=d.length;e<g;e++)a=d[e],b.removeEventListener?b.removeEventListener(a,f,!1):b.detachEvent("on"+
a,h)}}};
wysihtml5.dom.parse=function(b,d){function f(a,b,e,d){var l=a.nodeType,h=a.childNodes,m=h.length,n=g[l],q=0,r;if(d&&1===l&&wysihtml5.dom.hasClass(a,d))return a;n=n&&n(a,e);if(!n){if(!1===n){l=a.ownerDocument.createDocumentFragment();for(q=m;q--;)h[q]&&(r=f(h[q],b,e,d))&&(h[q]===r&&q--,l.insertBefore(r,l.firstChild));"block"===wysihtml5.dom.getStyle("display").from(a)&&l.appendChild(a.ownerDocument.createElement("br"));wysihtml5.lang.array("div pre p table td th ul ol li dd dl footer header section h1 h2 h3 h4 h5 h6".split(" ")).contains(a.nodeName.toLowerCase())&&a.parentNode.lastChild!==
a&&(a.nextSibling&&3===a.nextSibling.nodeType&&/^\s/.test(a.nextSibling.nodeValue)||l.appendChild(a.ownerDocument.createTextNode(" ")));l.normalize&&l.normalize();return l}return null}for(q=0;q<m;q++)h[q]&&(r=f(h[q],b,e,d))&&(h[q]===r&&q--,n.appendChild(r));if(b&&n.nodeName.toLowerCase()===k&&(!n.childNodes.length||/^\s*$/gi.test(n.innerHTML)&&(e||"_wysihtml5-temp-placeholder"!==a.className&&"rangySelectionBoundary"!==a.className)||!n.attributes.length)){for(l=n.ownerDocument.createDocumentFragment();n.firstChild;)l.appendChild(n.firstChild);
l.normalize&&l.normalize();return l}n.normalize&&n.normalize();return n}function h(a,b){var e=a.getAttribute("class"),d=a.getAttribute("style"),g,k,f;if(b.methods)for(g in b.methods)if(b.methods.hasOwnProperty(g)&&u[g]&&u[g](a))return!0;if(e&&b.classes){e=e.replace(/^\s+/g,"").replace(/\s+$/g,"").split(l);g=e.length;for(var h=0;h<g;h++)if(b.classes[e[h]])return!0}if(d&&b.styles)for(k in d=d.split(";"),b.styles)if(b.styles.hasOwnProperty(k))for(g=d.length;g--;)if(e=d[g].split(":"),e[0].replace(/\s/g,
"").toLowerCase()===k&&(!0===b.styles[k]||1===b.styles[k]||wysihtml5.lang.array(b.styles[k]).contains(e[1].replace(/\s/g,"").toLowerCase())))return!0;if(b.attrs)for(f in b.attrs)if(b.attrs.hasOwnProperty(f)&&(d=wysihtml5.dom.getAttribute(a,f),"string"===typeof d&&-1<d.search(b.attrs[f])))return!0;return!1}function e(a,b,e,d){return(e=n[e])&&(b||"alt"===a&&"IMG"==d)&&(a=e(b),"string"===typeof a)?a:!1}function a(a,b){var d=wysihtml5.lang.object(m.attributes||{}).clone(),d=wysihtml5.lang.object(d).merge(wysihtml5.lang.object(b||
{}).clone()).get(),g={},k=wysihtml5.dom.getAttributes(a),f,l,h;for(f in d)if(/\*$/.test(f)){l=f.slice(0,-1);h=k;var n=[],q=void 0;for(q in h)h.hasOwnProperty(q)&&0===q.indexOf(l)&&n.push(q);h=n;n=0;for(q=h.length;n<q;n++)l=e(h[n],k[h[n]],d[f],a.nodeName),!1!==l&&(g[h[n]]=l)}else l=e(f,k[f],d[f],a.nodeName),!1!==l&&(g[f]=l);return g}var g={1:function(b,e){var d,g;d=m.tags;g=b.nodeName.toLowerCase();var f=b.scopeName,n;if(b._wysihtml5)return null;b._wysihtml5=1;if("wysihtml5-temp"===b.className)return null;
f&&"HTML"!=f&&(g=f+":"+g);"outerHTML"in b&&(wysihtml5.browser.autoClosesUnclosedTags()||"P"!==b.nodeName||"</p>"===b.outerHTML.slice(-4).toLowerCase()||(g="div"));if(g in d){d=d[g];if(!d||d.remove)return null;if(d.unwrap)return!1;d="string"===typeof d?{rename_tag:d}:d}else if(b.firstChild)d={rename_tag:k};else return null;if(f=d.one_of_type){var q;a:{var f=m,p=d.one_of_type,t;if("SPAN"!==b.nodeName||e||"_wysihtml5-temp-placeholder"!==b.className&&"rangySelectionBoundary"!==b.className){for(q in p)if(p.hasOwnProperty(q)&&
f.type_definitions&&f.type_definitions[q]&&(t=f.type_definitions[q],h(b,t))){q=!0;break a}q=!1}else q=!0}f=!q}if(f)if(d.remove_action){if("unwrap"===d.remove_action)return!1;if("rename"===d.remove_action)n=d.remove_action_rename_to||k;else return null}else return null;g=b.ownerDocument.createElement(n||d.rename_tag||g);var u=d;n={};var K=u.set_class,$=u.add_class,U=u.add_style,oa=u.set_attributes;q=m.classes;f=0;p=[];t=[];var ea=[],ia=[],I;oa&&(n=wysihtml5.lang.object(oa).clone());n=wysihtml5.lang.object(n).merge(a(b,
u.check_attributes)).get();K&&p.push(K);if($)for(I in $)if(u=s[$[I]])u=u(wysihtml5.dom.getAttribute(b,I)),"string"===typeof u&&p.push(u);if(U)for(I in U)if(u=r[U[I]])newStyle=u(wysihtml5.dom.getAttribute(b,I)),"string"===typeof newStyle&&t.push(newStyle);if("string"===typeof q&&"any"===q&&b.getAttribute("class"))if(m.classes_blacklist){(ia=b.getAttribute("class"))&&(p=p.concat(ia.split(l)));for($=p.length;f<$;f++)U=p[f],m.classes_blacklist[U]||ea.push(U);ea.length&&(n["class"]=wysihtml5.lang.array(ea).unique().join(" "))}else n["class"]=
b.getAttribute("class");else{e||(q["_wysihtml5-temp-placeholder"]=1,q._rangySelectionBoundary=1,q["wysiwyg-tmp-selected-cell"]=1);(ia=b.getAttribute("class"))&&(p=p.concat(ia.split(l)));for($=p.length;f<$;f++)U=p[f],q[U]&&ea.push(U);ea.length&&(n["class"]=wysihtml5.lang.array(ea).unique().join(" "))}n["class"]&&e&&(n["class"]=n["class"].replace("wysiwyg-tmp-selected-cell",""),/^\s*$/g.test(n["class"])&&delete n["class"]);t.length&&(n.style=wysihtml5.lang.array(t).unique().join(" "));for(I in n)try{g.setAttribute(I,
n[I])}catch(Ba){}n.src&&("undefined"!==typeof n.width&&g.setAttribute("width",n.width),"undefined"!==typeof n.height&&g.setAttribute("height",n.height));I=d;var V;if(I&&I.keep_styles)for(V in I.keep_styles)I.keep_styles.hasOwnProperty(V)&&(d="float"===V?b.style.styleFloat||b.style.cssFloat:b.style[V],I.keep_styles[V]instanceof RegExp&&!I.keep_styles[V].test(d)||("float"===V?g.style[b.style.styleFloat?"styleFloat":"cssFloat"]=d:b.style[V]&&(g.style[V]=d)));g.normalize&&g.normalize();return g},3:function(a){var b=
a.nextSibling;if(b&&b.nodeType===wysihtml5.TEXT_NODE)b.data=a.data.replace(p,"")+b.data.replace(p,"");else return b=a.data.replace(p,""),a.ownerDocument.createTextNode(b)},8:function(a){if(m.comments)return a.ownerDocument.createComment(a.nodeValue)}},k="span",l=/\s+/,q={tags:{},classes:{}},m={},p=/\uFEFF/g,n={url:function(){var a=/^https?:\/\//i;return function(b){return b&&b.match(a)?b.replace(a,function(a){return a.toLowerCase()}):null}}(),src:function(){var a=/^(\/|https?:\/\/)/i;return function(b){return b&&
b.match(a)?b.replace(a,function(a){return a.toLowerCase()}):null}}(),href:function(){var a=/^(#|\/|https?:\/\/|mailto:)/i;return function(b){return b&&b.match(a)?b.replace(a,function(a){return a.toLowerCase()}):null}}(),alt:function(){var a=/[^ a-z0-9_\-]/gi;return function(b){return b?b.replace(a,""):""}}(),numbers:function(){var a=/\D/g;return function(b){return(b=(b||"").replace(a,""))||null}}(),any:function(){return function(a){return a}}()},r={align_text:function(){var a={left:"text-align: left;",
right:"text-align: right;",center:"text-align: center;"};return function(b){return a[String(b).toLowerCase()]}}()},s={align_img:function(){var a={left:"wysiwyg-float-left",right:"wysiwyg-float-right"};return function(b){return a[String(b).toLowerCase()]}}(),align_text:function(){var a={left:"wysiwyg-text-align-left",right:"wysiwyg-text-align-right",center:"wysiwyg-text-align-center",justify:"wysiwyg-text-align-justify"};return function(b){return a[String(b).toLowerCase()]}}(),clear_br:function(){var a=
{left:"wysiwyg-clear-left",right:"wysiwyg-clear-right",both:"wysiwyg-clear-both",all:"wysiwyg-clear-both"};return function(b){return a[String(b).toLowerCase()]}}(),size_font:function(){var a={1:"wysiwyg-font-size-xx-small",2:"wysiwyg-font-size-small",3:"wysiwyg-font-size-medium",4:"wysiwyg-font-size-large",5:"wysiwyg-font-size-x-large",6:"wysiwyg-font-size-xx-large",7:"wysiwyg-font-size-xx-large","-":"wysiwyg-font-size-smaller","+":"wysiwyg-font-size-larger"};return function(b){return a[String(b).charAt(0)]}}()},
u={has_visible_contet:function(){var a,b="img video picture br script noscript style table iframe object embed audio svg input button select textarea canvas".split(" ");return function(e){if((a=(e.innerText||e.textContent).replace(/\s/g,""))&&0<a.length)return!0;for(var d=b.length;d--;)if(e.querySelector(b[d]))return!0;return e.offsetWidth&&0<e.offsetWidth&&e.offsetHeight&&0<e.offsetHeight?!0:!1}}()},t={unwrap:function(a){wysihtml5.dom.unwrap(a)},remove:function(a){a.parentNode.removeChild(a)}};return function(a,
b){wysihtml5.lang.object(m).merge(q).merge(b.rules).get();var e=b.context||a.ownerDocument||document,d=e.createDocumentFragment(),g="string"===typeof a,k=!1,l,h;!0===b.clearInternals&&(k=!0);e=g?wysihtml5.dom.getAsDom(a,e):a;if(m.selectors){var n=m.selectors,r;for(l in n)if(n.hasOwnProperty(l)){wysihtml5.lang.object(n[l]).isFunction()?h=n[l]:"string"===typeof n[l]&&t[n[l]]&&(h=t[n[l]]);r=e.querySelectorAll(l);for(var p=r.length;p--;)h(r[p])}}for(;e.firstChild;)h=e.firstChild,(l=f(h,b.cleanUp,k,b.uneditableClass))&&
d.appendChild(l),h!==l&&e.removeChild(h);if(b.unjoinNbsps)for(k=wysihtml5.dom.getTextNodes(d),l=k.length;l--;)k[l].nodeValue=k[l].nodeValue.replace(/([\S\u00A0])\u00A0/gi,"$1 ");e.innerHTML="";e.appendChild(d);return g?wysihtml5.quirks.getCorrectInnerHTML(e):e}(b,d)};wysihtml5.dom.removeEmptyTextNodes=function(b){for(var d=wysihtml5.lang.array(b.childNodes).get(),f=d.length,h=0;h<f;h++)b=d[h],b.nodeType===wysihtml5.TEXT_NODE&&""===b.data&&b.parentNode.removeChild(b)};
wysihtml5.dom.renameElement=function(b,d){for(var f=b.ownerDocument.createElement(d),h;h=b.firstChild;)f.appendChild(h);wysihtml5.dom.copyAttributes(["align","className"]).from(b).to(f);b.parentNode.replaceChild(f,b);return f};wysihtml5.dom.replaceWithChildNodes=function(b){if(b.parentNode)if(b.firstChild){for(var d=b.ownerDocument.createDocumentFragment();b.firstChild;)d.appendChild(b.firstChild);b.parentNode.replaceChild(d,b)}else b.parentNode.removeChild(b)};
(function(b){function d(d){return"block"===b.getStyle("display").from(d)}function f(b){var e=b.ownerDocument.createElement("br");b.appendChild(e)}b.resolveList=function(b,e){if(b.nodeName.match(/^(MENU|UL|OL)$/)){var a=b.ownerDocument,g=a.createDocumentFragment(),k=wysihtml5.dom.domNode(b).prev({ignoreBlankTexts:!0}),l,q;if(e)for(k&&!d(k)&&"BR"!==k.nodeName&&f(g);q=b.firstElementChild||b.firstChild;){for(a=q.lastChild;k=q.firstChild;)l=(l=k===a)&&!d(k)&&"BR"!==k.nodeName,g.appendChild(k),l&&f(g);
q.parentNode.removeChild(q)}else for(;q=b.firstElementChild||b.firstChild;){if(q.querySelector&&q.querySelector("div, p, ul, ol, menu, blockquote, h1, h2, h3, h4, h5, h6"))for(;k=q.firstChild;)g.appendChild(k);else{for(l=a.createElement("p");k=q.firstChild;)l.appendChild(k);g.appendChild(l)}q.parentNode.removeChild(q)}b.parentNode.replaceChild(g,b)}}})(wysihtml5.dom);
(function(b){var d=document,f="parent top opener frameElement frames localStorage globalStorage sessionStorage indexedDB".split(" "),h="open close openDialog showModalDialog alert confirm prompt openDatabase postMessage XMLHttpRequest XDomainRequest".split(" "),e=["referrer","write","open","close"];b.dom.Sandbox=Base.extend({constructor:function(a,e){this.callback=a||b.EMPTY_FUNCTION;this.config=b.lang.object({}).merge(e).get();this.editableArea=this._createIframe()},insertInto:function(a){"string"===
typeof a&&(a=d.getElementById(a));a.appendChild(this.editableArea)},getIframe:function(){return this.editableArea},getWindow:function(){this._readyError()},getDocument:function(){this._readyError()},destroy:function(){var a=this.getIframe();a.parentNode.removeChild(a)},_readyError:function(){throw Error("wysihtml5.Sandbox: Sandbox iframe isn't loaded yet");},_createIframe:function(){var a=this,e=d.createElement("iframe");e.className="wysihtml5-sandbox";b.dom.setAttributes({security:"restricted",allowtransparency:"true",
frameborder:0,width:0,height:0,marginwidth:0,marginheight:0}).on(e);b.browser.throwsMixedContentWarningWhenIframeSrcIsEmpty()&&(e.src="javascript:'<html></html>'");e.onload=function(){e.onreadystatechange=e.onload=null;a._onLoadIframe(e)};e.onreadystatechange=function(){/loaded|complete/.test(e.readyState)&&(e.onreadystatechange=e.onload=null,a._onLoadIframe(e))};return e},_onLoadIframe:function(a){if(b.dom.contains(d.documentElement,a)){var g=this,k=a.contentWindow,l=a.contentWindow.document,q=this._getHtml({charset:d.characterSet||
d.charset||"utf-8",stylesheets:this.config.stylesheets});l.open("text/html","replace");l.write(q);l.close();this.getWindow=function(){return a.contentWindow};this.getDocument=function(){return a.contentWindow.document};k.onerror=function(a,b,e){throw Error("wysihtml5.Sandbox: "+a,b,e);};if(!b.browser.supportsSandboxedIframes()){var m,q=0;for(m=f.length;q<m;q++)this._unset(k,f[q]);q=0;for(m=h.length;q<m;q++)this._unset(k,h[q],b.EMPTY_FUNCTION);q=0;for(m=e.length;q<m;q++)this._unset(l,e[q]);this._unset(l,
"cookie","",!0)}this.loaded=!0;setTimeout(function(){g.callback(g)},0)}},_getHtml:function(a){var e=a.stylesheets,d="",f=0,h;if(e="string"===typeof e?[e]:e)for(h=e.length;f<h;f++)d+='<link rel="stylesheet" href="'+e[f]+'">';a.stylesheets=d;return b.lang.string('<!DOCTYPE html><html><head><meta charset="#{charset}">#{stylesheets}</head><body></body></html>').interpolate(a)},_unset:function(a,e,d,f){try{a[e]=d}catch(h){}try{a.__defineGetter__(e,function(){return d})}catch(m){}if(f)try{a.__defineSetter__(e,
function(){})}catch(p){}if(!b.browser.crashesWhenDefineProperty(e))try{var n={get:function(){return d}};f&&(n.set=function(){});Object.defineProperty(a,e,n)}catch(r){}}})})(wysihtml5);
(function(b){var d=document;b.dom.ContentEditableArea=Base.extend({getContentEditable:function(){return this.element},getWindow:function(){return this.element.ownerDocument.defaultView},getDocument:function(){return this.element.ownerDocument},constructor:function(d,h,e){this.callback=d||b.EMPTY_FUNCTION;this.config=b.lang.object({}).merge(h).get();this.element=e?this._bindElement(e):this._createElement()},_createElement:function(){var b=d.createElement("div");b.className="wysihtml5-sandbox";this._loadElement(b);
return b},_bindElement:function(b){b.className=b.className&&""!=b.className?b.className+" wysihtml5-sandbox":"wysihtml5-sandbox";this._loadElement(b,!0);return b},_loadElement:function(b,d){var e=this;if(!d){var a=this._getHtml();b.innerHTML=a}this.getWindow=function(){return b.ownerDocument.defaultView};this.getDocument=function(){return b.ownerDocument};this.loaded=!0;setTimeout(function(){e.callback(e)},0)},_getHtml:function(b){return""}})})(wysihtml5);
(function(){var b={className:"class"};wysihtml5.dom.setAttributes=function(d){return{on:function(f){for(var h in d)f.setAttribute(b[h]||h,d[h])}}}})();wysihtml5.dom.setStyles=function(b){return{on:function(d){d=d.style;if("string"===typeof b)d.cssText+=";"+b;else for(var f in b)"float"===f?(d.cssFloat=b[f],d.styleFloat=b[f]):d[f]=b[f]}}};
(function(b){b.simulatePlaceholder=function(d,f,h){var e=function(){var a=0<f.element.offsetWidth&&0<f.element.offsetHeight;f.hasPlaceholderSet()&&(f.clear(),f.element.focus(),a&&setTimeout(function(){var a=f.selection.getSelection();a.focusNode&&a.anchorNode||f.selection.selectNode(f.element.firstChild||f.element)},0));f.placeholderSet=!1;b.removeClass(f.element,"placeholder")},a=function(){f.isEmpty()&&(f.placeholderSet=!0,f.setValue(h),b.addClass(f.element,"placeholder"))};d.on("set_placeholder",
a).on("unset_placeholder",e).on("focus:composer",e).on("paste:composer",e).on("blur:composer",a);a()}})(wysihtml5.dom);(function(b){var d=document.documentElement;"textContent"in d?(b.setTextContent=function(b,d){b.textContent=d},b.getTextContent=function(b){return b.textContent}):"innerText"in d?(b.setTextContent=function(b,d){b.innerText=d},b.getTextContent=function(b){return b.innerText}):(b.setTextContent=function(b,d){b.nodeValue=d},b.getTextContent=function(b){return b.nodeValue})})(wysihtml5.dom);
wysihtml5.dom.getAttribute=function(b,d){var f=!wysihtml5.browser.supportsGetAttributeCorrectly();d=d.toLowerCase();return"IMG"==b.nodeName&&"src"==d&&!0===wysihtml5.dom.isLoadedImage(b)?b.src:f&&"outerHTML"in b?-1!=b.outerHTML.toLowerCase().indexOf(" "+d+"=")?b.getAttribute(d):null:b.getAttribute(d)};
wysihtml5.dom.getAttributes=function(b){var d=!wysihtml5.browser.supportsGetAttributeCorrectly(),f=b.nodeName,h=[],e;for(e in b.attributes)(b.attributes.hasOwnProperty&&b.attributes.hasOwnProperty(e)||!b.attributes.hasOwnProperty&&Object.prototype.hasOwnProperty.call(b.attributes,e))&&b.attributes[e].specified&&("IMG"==f&&"src"==b.attributes[e].name.toLowerCase()&&!0===wysihtml5.dom.isLoadedImage(b)?h.src=b.src:wysihtml5.lang.array(["rowspan","colspan"]).contains(b.attributes[e].name.toLowerCase())&&
d?1!==b.attributes[e].value&&(h[b.attributes[e].name]=b.attributes[e].value):h[b.attributes[e].name]=b.attributes[e].value);return h};wysihtml5.dom.isLoadedImage=function(b){try{return b.complete&&!b.mozMatchesSelector(":-moz-broken")}catch(d){if(b.complete&&"complete"===b.readyState)return!0}};
(function(b){function d(a,b){for(var e=[],d,g=0,f=a.length;g<f;g++)if(d=a[g].querySelectorAll(b))for(var h=d.length;h--;e.unshift(d[h]));return e}function f(a){a.parentNode.removeChild(a)}function h(a,b){a.parentNode.insertBefore(b,a.nextSibling)}var e=b.dom,a=function(a){this.el=a;this.isRowspan=this.isColspan=!1;this.isReal=this.lastRow=this.firstRow=this.lastCol=this.firstCol=!0;this.spanCollection=[];this.modified=!1},g=function(a,b){a?(this.cell=a,this.table=e.getParentElement(a,{nodeName:["TABLE"]})):
b&&(this.table=b,this.cell=this.table.querySelectorAll("th, td")[0])};g.prototype={addSpannedCellToMap:function(b,e,d,g,f,h){for(var r=[],s=d+(h?parseInt(h,10)-1:0),u=g+(f?parseInt(f,10)-1:0),t=d;t<=s;t++){"undefined"==typeof e[t]&&(e[t]=[]);for(var x=g;x<=u;x++)e[t][x]=new a(b),e[t][x].isColspan=f&&1<parseInt(f,10),e[t][x].isRowspan=h&&1<parseInt(h,10),e[t][x].firstCol=x==g,e[t][x].lastCol=x==u,e[t][x].firstRow=t==d,e[t][x].lastRow=t==s,e[t][x].isReal=x==g&&t==d,e[t][x].spanCollection=r,r.push(e[t][x])}},
setCellAsModified:function(a){a.modified=!0;if(0<a.spanCollection.length)for(var b=0,e=a.spanCollection.length;b<e;b++)a.spanCollection[b].modified=!0},setTableMap:function(){var b=[],d=this.getTableRows(),g,f,h,n,r,s,u;for(g=0;g<d.length;g++)for(f=d[g],f=this.getRowCells(f),r=0,"undefined"==typeof b[g]&&(b[g]=[]),h=0;h<f.length;h++){for(n=f[h];"undefined"!=typeof b[g][r];)r++;s=e.getAttribute(n,"colspan");u=e.getAttribute(n,"rowspan");s||u?(this.addSpannedCellToMap(n,b,g,r,s,u),r+=s?parseInt(s,10):
1):(b[g][r]=new a(n),r++)}return this.map=b},getRowCells:function(a){var e=this.table.querySelectorAll("table"),e=e?d(e,"th, td"):[];a=a.querySelectorAll("th, td");return 0<e.length?b.lang.array(a).without(e):a},getTableRows:function(){var a=this.table.querySelectorAll("table"),a=a?d(a,"tr"):[],e=this.table.querySelectorAll("tr");return 0<a.length?b.lang.array(e).without(a):e},getMapIndex:function(a){for(var b=this.map.length,e=this.map&&this.map[0]?this.map[0].length:0,d=0;d<b;d++)for(var g=0;g<
e;g++)if(this.map[d][g].el===a)return{row:d,col:g};return!1},getElementAtIndex:function(a){this.setTableMap();return this.map[a.row]&&this.map[a.row][a.col]&&this.map[a.row][a.col].el?this.map[a.row][a.col].el:null},getMapElsTo:function(a){var b=[];this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(a);if(this.idx_start.row>this.idx_end.row||this.idx_start.row==this.idx_end.row&&this.idx_start.col>this.idx_end.col)a=this.idx_start,this.idx_start=this.idx_end,
this.idx_end=a;this.idx_start.col>this.idx_end.col&&(a=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=a);if(null!=this.idx_start&&null!=this.idx_end){a=this.idx_start.row;for(var e=this.idx_end.row;a<=e;a++)for(var d=this.idx_start.col,g=this.idx_end.col;d<=g;d++)b.push(this.map[a][d].el)}return b},orderSelectionEnds:function(a){this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(a);if(this.idx_start.row>this.idx_end.row||this.idx_start.row==
this.idx_end.row&&this.idx_start.col>this.idx_end.col)a=this.idx_start,this.idx_start=this.idx_end,this.idx_end=a;this.idx_start.col>this.idx_end.col&&(a=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=a);return{start:this.map[this.idx_start.row][this.idx_start.col].el,end:this.map[this.idx_end.row][this.idx_end.col].el}},createCells:function(a,b,e){for(var d=this.table.ownerDocument,g=d.createDocumentFragment(),f,h=0;h<b;h++){f=d.createElement(a);if(e)for(var s in e)e.hasOwnProperty(s)&&
f.setAttribute(s,e[s]);f.appendChild(document.createTextNode("\u00a0"));g.appendChild(f)}return g},correctColIndexForUnreals:function(a,b){for(var e=this.map[b],d=-1,g=0;g<a;g++)e[g].isReal&&d++;return d},getLastNewCellOnRow:function(a,b){for(var e=this.getRowCells(a),d,g,f=0,h=e.length;f<h;f++)if(d=e[f],g=this.getMapIndex(d),!1===g||"undefined"!=typeof b&&g.row!=b)return d;return null},removeEmptyTable:function(){var a=this.table.querySelectorAll("td, th");if(a&&0!=a.length)return!1;f(this.table);
return!0},splitRowToCells:function(a){if(a.isColspan){var b=parseInt(e.getAttribute(a.el,"colspan")||1,10),d=a.el.tagName.toLowerCase();1<b&&(b=this.createCells(d,b-1),h(a.el,b));a.el.removeAttribute("colspan")}},getRealRowEl:function(a,b){var d=null,g=null;b=b||this.idx;for(var f=0,h=this.map[b.row].length;f<h;f++)if(g=this.map[b.row][f],g.isReal&&(d=e.getParentElement(g.el,{nodeName:["TR"]})))return d;null===d&&a&&(d=e.getParentElement(this.map[b.row][b.col].el,{nodeName:["TR"]})||null);return d},
injectRowAt:function(a,b,d,g,f){var n=this.getRealRowEl(!1,{row:a,col:b});d=this.createCells(g,d);n?(f=this.correctColIndexForUnreals(b,a),0<=f?h(this.getRowCells(n)[f],d):n.insertBefore(d,n.firstChild)):(n=this.table.ownerDocument.createElement("tr"),n.appendChild(d),h(e.getParentElement(f.el,{nodeName:["TR"]}),n))},canMerge:function(a){this.to=a;this.setTableMap();this.idx_start=this.getMapIndex(this.cell);this.idx_end=this.getMapIndex(this.to);if(this.idx_start.row>this.idx_end.row||this.idx_start.row==
this.idx_end.row&&this.idx_start.col>this.idx_end.col)a=this.idx_start,this.idx_start=this.idx_end,this.idx_end=a;this.idx_start.col>this.idx_end.col&&(a=this.idx_start.col,this.idx_start.col=this.idx_end.col,this.idx_end.col=a);a=this.idx_start.row;for(var b=this.idx_end.row;a<=b;a++)for(var e=this.idx_start.col,d=this.idx_end.col;e<=d;e++)if(this.map[a][e].isColspan||this.map[a][e].isRowspan)return!1;return!0},decreaseCellSpan:function(a,b){var d=parseInt(e.getAttribute(a.el,b),10)-1;1<=d?a.el.setAttribute(b,
d):(a.el.removeAttribute(b),"colspan"==b&&(a.isColspan=!1),"rowspan"==b&&(a.isRowspan=!1),a.firstCol=!0,a.lastCol=!0,a.firstRow=!0,a.lastRow=!0,a.isReal=!0)},removeSurplusLines:function(){var a,b,d,g,h,n,r;this.setTableMap();if(this.map){d=0;for(g=this.map.length;d<g;d++){a=this.map[d];r=!0;h=0;for(n=a.length;h<n;h++)if(b=a[h],!(e.getAttribute(b.el,"rowspan")&&1<parseInt(e.getAttribute(b.el,"rowspan"),10)&&!0!==b.firstRow)){r=!1;break}if(r)for(h=0;h<n;h++)this.decreaseCellSpan(a[h],"rowspan")}b=this.getTableRows();
d=0;for(g=b.length;d<g;d++)a=b[d],0==a.childNodes.length&&/^\s*$/.test(a.textContent||a.innerText)&&f(a)}},fillMissingCells:function(){var b=0,e=0,d=null;this.setTableMap();if(this.map){b=this.map.length;for(d=0;d<b;d++)this.map[d].length>e&&(e=this.map[d].length);for(var g=0;g<b;g++)for(var f=0;f<e;f++)this.map[g]&&!this.map[g][f]&&0<f&&(this.map[g][f]=new a(this.createCells("td",1)),(d=this.map[g][f-1])&&d.el&&d.el.parent&&h(this.map[g][f-1].el,this.map[g][f].el))}},rectify:function(){if(this.removeEmptyTable())return!1;
this.removeSurplusLines();this.fillMissingCells();return!0},unmerge:function(){if(this.rectify()&&(this.setTableMap(),this.idx=this.getMapIndex(this.cell))){var a=this.map[this.idx.row][this.idx.col],b=e.getAttribute(a.el,"colspan")?parseInt(e.getAttribute(a.el,"colspan"),10):1,d=a.el.tagName.toLowerCase();if(a.isRowspan){var g=parseInt(e.getAttribute(a.el,"rowspan"),10);if(1<g)for(var f=1,g=g-1;f<=g;f++)this.injectRowAt(this.idx.row+f,this.idx.col,b,d,a);a.el.removeAttribute("rowspan")}this.splitRowToCells(a)}},
merge:function(a){if(this.rectify())if(this.canMerge(a)){a=this.idx_end.row-this.idx_start.row+1;for(var b=this.idx_end.col-this.idx_start.col+1,e=this.idx_start.row,d=this.idx_end.row;e<=d;e++)for(var g=this.idx_start.col,h=this.idx_end.col;g<=h;g++)e==this.idx_start.row&&g==this.idx_start.col?(1<a&&this.map[e][g].el.setAttribute("rowspan",a),1<b&&this.map[e][g].el.setAttribute("colspan",b)):(/^\s*<br\/?>\s*$/.test(this.map[e][g].el.innerHTML.toLowerCase())||(this.map[this.idx_start.row][this.idx_start.col].el.innerHTML+=
" "+this.map[e][g].el.innerHTML),f(this.map[e][g].el));this.rectify()}else window.console&&console.log("Do not know how to merge allready merged cells.")},collapseCellToNextRow:function(a){var b=this.getMapIndex(a.el),d=b.row+1,g={row:d,col:b.col};d<this.map.length&&(b=this.getRealRowEl(!1,g),null!==b&&(g=this.correctColIndexForUnreals(g.col,g.row),0<=g?h(this.getRowCells(b)[g],a.el):(d=this.getLastNewCellOnRow(b,d),null!==d?h(d,a.el):b.insertBefore(a.el,b.firstChild)),2<parseInt(e.getAttribute(a.el,
"rowspan"),10)?a.el.setAttribute("rowspan",parseInt(e.getAttribute(a.el,"rowspan"),10)-1):a.el.removeAttribute("rowspan")))},removeRowCell:function(a){a.isReal?a.isRowspan?this.collapseCellToNextRow(a):f(a.el):2<parseInt(e.getAttribute(a.el,"rowspan"),10)?a.el.setAttribute("rowspan",parseInt(e.getAttribute(a.el,"rowspan"),10)-1):a.el.removeAttribute("rowspan")},getRowElementsByCell:function(){var a=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var b=this.map[this.idx.row],
e=0,d=b.length;e<d;e++)b[e].isReal&&a.push(b[e].el);return a},getColumnElementsByCell:function(){var a=[];this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var b=0,e=this.map.length;b<e;b++)this.map[b][this.idx.col]&&this.map[b][this.idx.col].isReal&&a.push(this.map[b][this.idx.col].el);return a},removeRow:function(){var a=e.getParentElement(this.cell,{nodeName:["TR"]});if(a){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var b=this.map[this.idx.row],
d=0,g=b.length;d<g;d++)b[d].modified||(this.setCellAsModified(b[d]),this.removeRowCell(b[d]));f(a)}},removeColCell:function(a){a.isColspan?2<parseInt(e.getAttribute(a.el,"colspan"),10)?a.el.setAttribute("colspan",parseInt(e.getAttribute(a.el,"colspan"),10)-1):a.el.removeAttribute("colspan"):a.isReal&&f(a.el)},removeColumn:function(){this.setTableMap();this.idx=this.getMapIndex(this.cell);if(!1!==this.idx)for(var a=0,b=this.map.length;a<b;a++)this.map[a][this.idx.col].modified||(this.setCellAsModified(this.map[a][this.idx.col]),
this.removeColCell(this.map[a][this.idx.col]))},remove:function(a){if(this.rectify()){switch(a){case "row":this.removeRow();break;case "column":this.removeColumn()}this.rectify()}},addRow:function(a){var b=this.table.ownerDocument;this.setTableMap();this.idx=this.getMapIndex(this.cell);"below"==a&&e.getAttribute(this.cell,"rowspan")&&(this.idx.row=this.idx.row+parseInt(e.getAttribute(this.cell,"rowspan"),10)-1);if(!1!==this.idx){for(var d=this.map[this.idx.row],b=b.createElement("tr"),g=0,f=d.length;g<
f;g++)d[g].modified||(this.setCellAsModified(d[g]),this.addRowCell(d[g],b,a));switch(a){case "below":h(this.getRealRowEl(!0),b);break;case "above":(a=e.getParentElement(this.map[this.idx.row][this.idx.col].el,{nodeName:["TR"]}))&&a.parentNode.insertBefore(b,a)}}},addRowCell:function(a,b,d){var g=a.isColspan?{colspan:e.getAttribute(a.el,"colspan")}:null;a.isReal?"above"!=d&&a.isRowspan?a.el.setAttribute("rowspan",parseInt(e.getAttribute(a.el,"rowspan"),10)+1):b.appendChild(this.createCells("td",1,
g)):"above"!=d&&a.isRowspan&&a.lastRow?b.appendChild(this.createCells("td",1,g)):c.isRowspan&&a.el.attr("rowspan",parseInt(e.getAttribute(a.el,"rowspan"),10)+1)},add:function(a){this.rectify()&&("below"!=a&&"above"!=a||this.addRow(a),"before"!=a&&"after"!=a||this.addColumn(a))},addColCell:function(a,b,d){var g,f=a.el.tagName.toLowerCase();switch(d){case "before":g=!a.isColspan||a.firstCol;break;case "after":g=!a.isColspan||a.lastCol||a.isColspan&&c.el==this.cell}if(g){switch(d){case "before":a.el.parentNode.insertBefore(this.createCells(f,
1),a.el);break;case "after":h(a.el,this.createCells(f,1))}a.isRowspan&&this.handleCellAddWithRowspan(a,b+1,d)}else a.el.setAttribute("colspan",parseInt(e.getAttribute(a.el,"colspan"),10)+1)},addColumn:function(a){var b;this.setTableMap();this.idx=this.getMapIndex(this.cell);"after"==a&&e.getAttribute(this.cell,"colspan")&&(this.idx.col=this.idx.col+parseInt(e.getAttribute(this.cell,"colspan"),10)-1);if(!1!==this.idx)for(var d=0,g=this.map.length;d<g;d++)b=this.map[d],b[this.idx.col]&&(b=b[this.idx.col],
b.modified||(this.setCellAsModified(b),this.addColCell(b,d,a)))},handleCellAddWithRowspan:function(a,b,d){var g=parseInt(e.getAttribute(this.cell,"rowspan"),10)-1,f=e.getParentElement(a.el,{nodeName:["TR"]});a=a.el.tagName.toLowerCase();for(var n,r,s=this.table.ownerDocument,u=0;u<g;u++){n=this.correctColIndexForUnreals(this.idx.col,b+u);a:{for(f=f.nextSibling;1!=f.nodeType;)if(f=f.nextSibling,"tr"==f.tagName.toLowerCase())break a;f=null}if(f)if(0<n)switch(d){case "before":r=this.getRowCells(f);0<
n&&this.map[b+u][this.idx.col].el!=r[n]&&n==r.length-1?h(r[n],this.createCells(a,1)):r[n].parentNode.insertBefore(this.createCells(a,1),r[n]);break;case "after":h(this.getRowCells(f)[n],this.createCells(a,1))}else f.insertBefore(this.createCells(a,1),f.firstChild);else n=s.createElement("tr"),n.appendChild(this.createCells(a,1)),this.table.appendChild(n)}}};e.table={getCellsBetween:function(a,b){return(new g(a)).getMapElsTo(b)},addCells:function(a,b){(new g(a)).add(b)},removeCells:function(a,b){(new g(a)).remove(b)},
mergeCellsBetween:function(a,b){(new g(a)).merge(b)},unmergeCell:function(a){(new g(a)).unmerge()},orderSelectionEnds:function(a,b){return(new g(a)).orderSelectionEnds(b)},indexOf:function(a){var b=new g(a);b.setTableMap();return b.getMapIndex(a)},findCell:function(a,b){return(new g(null,a)).getElementAtIndex(b)},findRowByCell:function(a){return(new g(a)).getRowElementsByCell()},findColumnByCell:function(a){return(new g(a)).getColumnElementsByCell()},canMerge:function(a,b){return(new g(a)).canMerge(b)}}})(wysihtml5);
wysihtml5.dom.query=function(b,d){var f=[],h;b.nodeType&&(b=[b]);for(var e=0,a=b.length;e<a;e++)if(h=b[e].querySelectorAll(d))for(var g=h.length;g--;f.unshift(h[g]));return f};
wysihtml5.dom.compareDocumentPosition=function(){return document.documentElement.compareDocumentPosition?function(b,d){return b.compareDocumentPosition(d)}:function(b,d){if(b===d)return 0;if(b===d.ownerDocument)return 20;if(b.ownerDocument===d)return 10;if((9===b.nodeType?b:b.ownerDocument)!==(9===d.nodeType?d:d.ownerDocument))return 1;if(2===b.nodeType&&b.childNodes&&-1!==wysihtml5.lang.array(b.childNodes).indexOf(d))return 20;if(2===d.nodeType&&d.childNodes&&-1!==wysihtml5.lang.array(d.childNodes).indexOf(b))return 10;
for(var f=b,h=[],e=null;f;){if(f==d)return 10;h.push(f);f=f.parentNode}f=d;for(e=null;f;){if(f==b)return 20;var a=wysihtml5.lang.array(h).indexOf(f);if(-1!==a)return f=h[a],h=wysihtml5.lang.array(f.childNodes).indexOf(h[a-1]),e=wysihtml5.lang.array(f.childNodes).indexOf(e),h>e?2:4;e=f;f=f.parentNode}return 1}}();wysihtml5.dom.unwrap=function(b){if(b.parentNode){for(;b.lastChild;)wysihtml5.dom.insert(b.lastChild).after(b);b.parentNode.removeChild(b)}};
wysihtml5.dom.getPastedHtml=function(b){var d;b.clipboardData&&(wysihtml5.lang.array(b.clipboardData.types).contains("text/html")?d=b.clipboardData.getData("text/html"):wysihtml5.lang.array(b.clipboardData.types).contains("text/plain")&&(d=wysihtml5.lang.string(b.clipboardData.getData("text/plain")).escapeHTML(!0,!0)));return d};
wysihtml5.dom.getPastedHtmlWithDiv=function(b,d){var f=b.selection.getBookmark(),h=b.element.ownerDocument,e=h.createElement("DIV");h.body.appendChild(e);e.style.width="1px";e.style.height="1px";e.style.overflow="hidden";e.setAttribute("contenteditable","true");e.focus();setTimeout(function(){b.selection.setBookmark(f);d(e.innerHTML);e.parentNode.removeChild(e)},0)};
wysihtml5.quirks.cleanPastedHTML=function(){return function(b,d){var f={color:wysihtml5.dom.getStyle("color").from(d.referenceNode),fontSize:wysihtml5.dom.getStyle("font-size").from(d.referenceNode)},h;a:{h=d.rules;var e;if(h){for(var a=0,g=h.length;a<g;a++)if(h[a].condition||(e=h[a].set),h[a].condition&&h[a].condition.test(b)){h=h[a].set;break a}h=e}else h=null}h=wysihtml5.lang.object(h||{}).clone(!0);var k,l;for(k in h.tags)if(h.tags.hasOwnProperty(k)&&h.tags[k].keep_styles)for(l in h.tags[k].keep_styles)h.tags[k].keep_styles.hasOwnProperty(l)&&
f[l]&&(e=h.tags[k].keep_styles,a=l,g=wysihtml5.lang.string(f[l]).trim().replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),e[a]=new RegExp("^((?!^"+g+"$).)*$","i"));return wysihtml5.dom.parse(b,{rules:h,cleanUp:!0,context:d.referenceNode.ownerDocument,uneditableClass:d.uneditableClass,clearInternals:!0,unjoinNbsps:!0})}}();
wysihtml5.quirks.ensureProperClearing=function(){var b=function(){var b=this;setTimeout(function(){var f=b.innerHTML.toLowerCase();if("<p>&nbsp;</p>"==f||"<p>&nbsp;</p><p>&nbsp;</p>"==f)b.innerHTML=""},0)};return function(d){wysihtml5.dom.observe(d.element,["cut","keydown"],b)}}();
(function(b){b.quirks.getCorrectInnerHTML=function(d){var f=d.innerHTML;if(-1===f.indexOf("%7E"))return f;d=d.querySelectorAll("[href*='~'], [src*='~']");var h,e,a,g;g=0;for(a=d.length;g<a;g++)h=d[g].href||d[g].src,e=b.lang.string(h).replace("~").by("%7E"),f=b.lang.string(f).replace(e).by(h);return f}})(wysihtml5);
(function(b){b.quirks.redraw=function(d){b.dom.addClass(d,"wysihtml5-quirks-redraw");b.dom.removeClass(d,"wysihtml5-quirks-redraw");try{var f=d.ownerDocument;f.execCommand("italic",!1,null);f.execCommand("italic",!1,null)}catch(h){}}})(wysihtml5);
wysihtml5.quirks.tableCellsSelection=function(b,d){function f(){if(b){var a=b.querySelectorAll("."+q);if(0<a.length)for(var e=0;e<a.length;e++)k.removeClass(a[e],q)}}function h(a){for(var b=0;b<a.length;b++)k.addClass(a[b],q)}function e(a){var b=null;(a=k.getParentElement(a.target,{nodeName:["TD","TH"]}))&&l.table&&l.start&&(b=k.getParentElement(a,{nodeName:["TABLE"]}))&&b===l.table&&(f(),b=l.end,l.end=a,l.cells=k.table.getCellsBetween(l.start,a),1<l.cells.length&&d.composer.selection.deselect(),
h(l.cells),l.end!==b&&d.fire("tableselectchange").fire("tableselectchange:composer"))}function a(a){m.stop();p.stop();d.fire("tableselect").fire("tableselect:composer");setTimeout(function(){g()},0)}function g(){var a=k.observe(b.ownerDocument,"click",function(b){a.stop();k.getParentElement(b.target,{nodeName:["TABLE"]})!=l.table&&(f(),l.table=null,l.start=null,l.end=null,d.fire("tableunselect").fire("tableunselect:composer"))})}var k=wysihtml5.dom,l={table:null,start:null,end:null,cells:null,select:function(a,
b){l.start=a;l.end=b;l.table=k.getParentElement(l.start,{nodeName:["TABLE"]});selectedCells=k.table.getCellsBetween(l.start,l.end);h(selectedCells);g();d.fire("tableselect").fire("tableselect:composer")}},q="wysiwyg-tmp-selected-cell",m=null,p=null;return function(){k.observe(b,"mousedown",function(g){if(g=wysihtml5.dom.getParentElement(g.target,{nodeName:["TD","TH"]}))l.start=g,l.end=g,l.cells=[g],l.table=k.getParentElement(l.start,{nodeName:["TABLE"]}),l.table&&(f(),k.addClass(g,q),m=k.observe(b,
"mousemove",e),p=k.observe(b,"mouseup",a),d.fire("tableselectstart").fire("tableselectstart:composer"))});return l}()};
(function(b){var d=/^rgba\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*([\d\.]+)\s*\)/i,f=/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)/i,h=/^#([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])/i,e=/^#([0-9a-f])([0-9a-f])([0-9a-f])/i,a=function(a){return new RegExp("(^|\\s|;)"+a+"\\s*:\\s*[^;$]+","gi")};b.quirks.styleParser={parseColor:function(g,k){var l=a(k),l=g.match(l),q=10,m;if(l){for(var p=l.length;p--;)l[p]=b.lang.string(l[p].split(":")[1]).trim();l=l[l.length-1];if(d.test(l))m=
l.match(d);else if(f.test(l))m=l.match(f);else if(h.test(l))m=l.match(h),q=16;else if(e.test(l))return m=l.match(e),m.shift(),m.push(1),b.lang.array(m).map(function(a,b){return 3>b?16*parseInt(a,16)+parseInt(a,16):parseFloat(a)});if(m)return m.shift(),m[3]||m.push(1),b.lang.array(m).map(function(a,b){return 3>b?parseInt(a,q):parseFloat(a)})}return!1},unparseColor:function(a,b){if(b){if("hex"==b)return a[0].toString(16).toUpperCase()+a[1].toString(16).toUpperCase()+a[2].toString(16).toUpperCase();
if("hash"==b)return"#"+a[0].toString(16).toUpperCase()+a[1].toString(16).toUpperCase()+a[2].toString(16).toUpperCase();if("rgb"==b)return"rgb("+a[0]+","+a[1]+","+a[2]+")";if("rgba"==b)return"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")";if("csv"==b)return a[0]+","+a[1]+","+a[2]+","+a[3]}return a[3]&&1!==a[3]?"rgba("+a[0]+","+a[1]+","+a[2]+","+a[3]+")":"rgb("+a[0]+","+a[1]+","+a[2]+")"},parseFontSize:function(e){return(e=e.match(a("font-size")))?b.lang.string(e[e.length-1].split(":")[1]).trim():!1}}})(wysihtml5);
(function(b){function d(b,a){for(var d=0;a!==b;)if(d++,a=a.parentNode,!a)throw Error("not a descendant of ancestor!");return d}function f(b){if(!b.canSurroundContents())for(var a=b.commonAncestorContainer,g=d(a,b.startContainer),f=d(a,b.endContainer);!b.canSurroundContents();)g>f?(b.setStartBefore(b.startContainer),g=d(a,b.startContainer)):(b.setEndAfter(b.endContainer),f=d(a,b.endContainer))}var h=b.dom;b.Selection=Base.extend({constructor:function(b,a,d){window.rangy.init();this.editor=b;this.composer=
b.composer;this.doc=this.composer.doc;this.contain=a;this.unselectableClass=d||!1},getBookmark:function(){var b=this.getRange();b&&f(b);return b&&b.cloneRange()},setBookmark:function(b){b&&this.setSelection(b)},setBefore:function(b){var a=rangy.createRange(this.doc);a.setStartBefore(b);a.setEndBefore(b);return this.setSelection(a)},setAfter:function(b){var a=rangy.createRange(this.doc);a.setStartAfter(b);a.setEndAfter(b);return this.setSelection(a)},selectNode:function(e,a){var d=rangy.createRange(this.doc),
f=e.nodeType===b.ELEMENT_NODE,l="canHaveHTML"in e?e.canHaveHTML:"IMG"!==e.nodeName,q=f?e.innerHTML:e.data,q=""===q||q===b.INVISIBLE_SPACE,m=h.getStyle("display").from(e),m="block"===m||"list-item"===m;if(q&&f&&l&&!a)try{e.innerHTML=b.INVISIBLE_SPACE}catch(p){}l?d.selectNodeContents(e):d.selectNode(e);l&&q&&f?d.collapse(m):l&&q&&(d.setStartAfter(e),d.setEndAfter(e));this.setSelection(d)},getSelectedNode:function(b){if(b&&this.doc.selection&&"Control"===this.doc.selection.type&&(b=this.doc.selection.createRange())&&
b.length)return b.item(0);b=this.getSelection(this.doc);return b.focusNode===b.anchorNode?b.focusNode:(b=this.getRange(this.doc))?b.commonAncestorContainer:this.doc.body},fixSelBorders:function(){var b=this.getRange();f(b);this.setSelection(b)},getSelectedOwnNodes:function(b){b=this.getOwnRanges();for(var a=[],d=0,f=b.length;d<f;d++)a.push(b[d].commonAncestorContainer||this.doc.body);return a},findNodesInSelection:function(e){for(var a=this.getOwnRanges(),d=[],f,h=0,q=a.length;h<q;h++)f=a[h].getNodes([1],
function(a){return b.lang.array(e).contains(a.nodeName)}),d=d.concat(f);return d},containsUneditable:function(){for(var b=this.getOwnUneditables(),a=this.getSelection(),d=0,f=b.length;d<f;d++)if(a.containsNode(b[d]))return!0;return!1},deleteContents:function(){for(var b=this.getOwnRanges(),a=b.length;a--;)b[a].deleteContents();this.setSelection(b[0])},getPreviousNode:function(e,a){e||(e=this.getSelection().anchorNode);if(e===this.contain)return!1;var d=e.previousSibling,f;if(d===this.contain)return!1;
d&&3!==d.nodeType&&1!==d.nodeType?d=this.getPreviousNode(d,a):d&&3===d.nodeType&&/^\s*$/.test(d.textContent)?d=this.getPreviousNode(d,a):a&&d&&1===d.nodeType&&!b.lang.array(["BR","HR","IMG"]).contains(d.nodeName)&&/^[\s]*$/.test(d.innerHTML)?d=this.getPreviousNode(d,a):d||e===this.contain||(f=e.parentNode,f!==this.contain&&(d=this.getPreviousNode(f,a)));return d!==this.contain?d:!1},getSelectionParentsByTag:function(e){e=this.getSelectedOwnNodes();for(var a,d=[],f=0,h=e.length;f<h;f++)(a=e[f].nodeName&&
"LI"===e[f].nodeName?e[f]:b.dom.getParentElement(e[f],{nodeName:["LI"]},!1,this.contain))&&d.push(a);return d.length?d:null},getRangeToNodeEnd:function(){if(this.isCollapsed()){var b=this.getRange(),a=b.startContainer,b=b.startOffset,d=rangy.createRange(this.doc);d.selectNodeContents(a);d.setStart(a,b);return d}},caretIsLastInSelection:function(){rangy.createRange(this.doc);this.getSelection();var b=this.getRangeToNodeEnd().cloneContents().textContent;return/^\s*$/.test(b)},caretIsFirstInSelection:function(){var e=
rangy.createRange(this.doc),a=this.getSelection(),d=this.getRange(),f=d.startContainer;if(f.nodeType===b.TEXT_NODE)return this.isCollapsed()&&f.nodeType===b.TEXT_NODE&&/^\s*$/.test(f.data.substr(0,d.startOffset));e.selectNodeContents(this.getRange().commonAncestorContainer);e.collapse(!0);return this.isCollapsed()&&(e.startContainer===a.anchorNode||e.endContainer===a.anchorNode)&&e.startOffset===a.anchorOffset},caretIsInTheBeginnig:function(e){var a=this.getSelection(),d=a.anchorNode,a=a.anchorOffset;
return e?0===a&&(d.nodeName&&d.nodeName===e.toUpperCase()||b.dom.getParentElement(d.parentNode,{nodeName:e},1)):0===a&&!this.getPreviousNode(d,!0)},caretIsBeforeUneditable:function(){var b=this.getSelection(),a=b.anchorNode;if(0===b.anchorOffset&&(b=this.getPreviousNode(a,!0)))for(var a=this.getOwnUneditables(),d=0,f=a.length;d<f;d++)if(b===a[d])return a[d];return!1},executeAndRestoreRangy:function(b,a){var d=rangy.saveSelection(this.doc.defaultView||this.doc.parentWindow);if(d)try{b()}catch(f){setTimeout(function(){throw f;
},0)}else b();rangy.restoreSelection(d)},executeAndRestore:function(e,a){var d=this.doc.body,f=a&&d.scrollTop,l=a&&d.scrollLeft,q='<span class="_wysihtml5-temp-placeholder">'+b.INVISIBLE_SPACE+"</span>",m=this.getRange(!0),p,n,r;if(m){m.collapsed||(r=m.cloneRange(),p=r.createContextualFragment(q),r.collapse(!1),r.insertNode(p),r.detach());q=m.createContextualFragment(q);m.insertNode(q);p&&(p=this.contain.querySelectorAll("._wysihtml5-temp-placeholder"),m.setStartBefore(p[0]),m.setEndAfter(p[p.length-
1]));this.setSelection(m);try{e(m.startContainer,m.endContainer)}catch(s){setTimeout(function(){throw s;},0)}if((p=this.contain.querySelectorAll("._wysihtml5-temp-placeholder"))&&p.length)for(m=rangy.createRange(this.doc),q=p[0].nextSibling,1<p.length&&(n=p[p.length-1].previousSibling),n&&q?m.setStartBefore(q):(n=this.doc.createTextNode(b.INVISIBLE_SPACE),h.insert(n).after(p[0]),m.setStartBefore(n)),m.setEndAfter(n),this.setSelection(m),n=p.length;n--;)p[n].parentNode.removeChild(p[n]);else this.contain.focus();
a&&(d.scrollTop=f,d.scrollLeft=l);try{p.parentNode.removeChild(p)}catch(u){}}else e(d,d)},set:function(b,a){var d=rangy.createRange(this.doc);d.setStart(b,a||0);this.setSelection(d)},insertHTML:function(b){rangy.createRange(this.doc);var a=this.doc.createElement("DIV"),d=this.doc.createDocumentFragment();a.innerHTML=b;for(b=a.lastChild;a.firstChild;)d.appendChild(a.firstChild);this.insertNode(d);b&&this.setAfter(b)},insertNode:function(b){var a=this.getRange();a&&a.insertNode(b)},surround:function(b){var a=
this.getOwnRanges(),d,f=[];if(0==a.length)return f;for(var h=a.length;h--;){d=this.doc.createElement(b.nodeName);f.push(d);b.className&&(d.className=b.className);b.cssStyle&&d.setAttribute("style",b.cssStyle);try{a[h].surroundContents(d),this.selectNode(d)}catch(q){d.appendChild(a[h].extractContents()),a[h].insertNode(d)}}return f},deblockAndSurround:function(d){var a=this.doc.createElement("div"),g=rangy.createRange(this.doc),f;a.className=d.className;this.composer.commands.exec("formatBlock",d.nodeName,
d.className);f=this.contain.querySelectorAll("."+d.className);if(f[0])for(f[0].parentNode.insertBefore(a,f[0]),g.setStartBefore(f[0]),g.setEndAfter(f[f.length-1]),g=g.extractContents();g.firstChild;)if(f=g.firstChild,1==f.nodeType&&b.dom.hasClass(f,d.className)){for(;f.firstChild;)a.appendChild(f.firstChild);"BR"!==f.nodeName&&a.appendChild(this.doc.createElement("br"));g.removeChild(f)}else a.appendChild(f);else a=null;return a},scrollIntoView:function(){var d=this.doc,a=d.documentElement.scrollHeight>
d.documentElement.offsetHeight,g;(g=d._wysihtml5ScrollIntoViewElement)||(g=d.createElement("span"),g.innerHTML=b.INVISIBLE_SPACE);g=d._wysihtml5ScrollIntoViewElement=g;if(a){this.insertNode(g);var a=g,f=0;if(a.parentNode){do f+=a.offsetTop||0,a=a.offsetParent;while(a)}a=f;g.parentNode.removeChild(g);a>=d.body.scrollTop+d.documentElement.offsetHeight-5&&(d.body.scrollTop=a)}},selectLine:function(){b.browser.supportsSelectionModify()?this._selectLine_W3C():this.doc.selection&&this._selectLine_MSIE()},
_selectLine_W3C:function(){var b=this.doc.defaultView.getSelection();b.modify("move","left","lineboundary");b.modify("extend","right","lineboundary")},_selectLine_MSIE:function(){var b=this.doc.selection.createRange(),a=b.boundingTop,d=this.doc.body.scrollWidth,f;if(b.moveToPoint){0===a&&(f=this.doc.createElement("span"),this.insertNode(f),a=f.offsetTop,f.parentNode.removeChild(f));a+=1;for(f=-10;f<d;f+=2)try{b.moveToPoint(f,a);break}catch(h){}for(f=this.doc.selection.createRange();0<=d;d--)try{f.moveToPoint(d,
a);break}catch(q){}b.setEndPoint("EndToEnd",f);b.select()}},getText:function(){var b=this.getSelection();return b?b.toString():""},getNodes:function(b,a){var d=this.getRange();return d?d.getNodes([b],a):[]},fixRangeOverflow:function(b){if(this.contain&&this.contain.firstChild&&b){var a=b.compareNode(this.contain);2!==a?(1===a&&b.setStartBefore(this.contain.firstChild),0===a&&b.setEndAfter(this.contain.lastChild),3===a&&(b.setStartBefore(this.contain.firstChild),b.setEndAfter(this.contain.lastChild))):
this._detectInlineRangeProblems(b)&&(a=b.endContainer.previousElementSibling)&&b.setEnd(a,this._endOffsetForNode(a))}},_endOffsetForNode:function(b){var a=document.createRange();a.selectNodeContents(b);return a.endOffset},_detectInlineRangeProblems:function(b){var a=h.compareDocumentPosition(b.startContainer,b.endContainer);return 0==b.endOffset&&a&4},getRange:function(b){var a=this.getSelection(),a=a&&a.rangeCount&&a.getRangeAt(0);!0!==b&&this.fixRangeOverflow(a);return a},getOwnUneditables:function(){var d=
h.query(this.contain,"."+this.unselectableClass),a=h.query(d,"."+this.unselectableClass);return b.lang.array(d).without(a)},getOwnRanges:function(){var b=[],a=this.getRange();a&&b.push(a);if(this.unselectableClass&&this.contain&&a){var d=this.getOwnUneditables(),f;if(0<d.length)for(var h=0,q=d.length;h<q;h++)for(var a=[],m=0,p=b.length;m<p;m++){if(b[m])switch(b[m].compareNode(d[h])){case 2:break;case 3:f=b[m].cloneRange();f.setEndBefore(d[h]);a.push(f);f=b[m].cloneRange();f.setStartAfter(d[h]);a.push(f);
break;default:a.push(b[m])}b=a}}return b},getSelection:function(){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow)},setSelection:function(b){return rangy.getSelection(this.doc.defaultView||this.doc.parentWindow).setSingleRange(b)},createRange:function(){return rangy.createRange(this.doc)},isCollapsed:function(){return this.getSelection().isCollapsed},getHtml:function(){return this.getSelection().toHtml()},isEndToEndInNode:function(d){var a=this.getRange(),f=a.commonAncestorContainer,
h=a.startContainer,l=a.endContainer;f.nodeType===b.TEXT_NODE&&(f=f.parentNode);if(h.nodeType===b.TEXT_NODE&&!/^\s*$/.test(h.data.substr(a.startOffset))||l.nodeType===b.TEXT_NODE&&!/^\s*$/.test(l.data.substr(a.endOffset)))return!1;for(;h&&h!==f;){if(h.nodeType!==b.TEXT_NODE&&!b.dom.contains(f,h)||b.dom.domNode(h).prev({ignoreBlankTexts:!0}))return!1;h=h.parentNode}for(;l&&l!==f;){if(l.nodeType!==b.TEXT_NODE&&!b.dom.contains(f,l)||b.dom.domNode(l).next({ignoreBlankTexts:!0}))return!1;l=l.parentNode}return b.lang.array(d).contains(f.nodeName)?
f:!1},deselect:function(){var b=this.getSelection();b&&b.removeAllRanges()}})})(wysihtml5);
(function(b,d){function f(a,b,d){a.getAttribute("style")?(h(a,d),a.getAttribute("style")&&!/^\s*$/.test(a.getAttribute("style"))?a.setAttribute("style",b+";"+a.getAttribute("style")):a.setAttribute("style",b)):a.setAttribute("style",b)}function h(a,b){var d,e=[];if(a.getAttribute("style")){d=a.getAttribute("style").split(";");for(var f=d.length;f--;)d[f].match(b)||/^\s*$/.test(d[f])||e.push(d[f]);e.length?a.setAttribute("style",e.join(";")):a.removeAttribute("style")}}function e(a,b){var d=[],e=b.split(";"),
f=a.getAttribute("style");if(f){f=f.replace(/\s/gi,"").toLowerCase();d.push(new RegExp("(^|\\s|;)"+b.replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));for(var g=e.length;0<g--;)/^\s*$/.test(e[g])||d.push(new RegExp("(^|\\s|;)"+e[g].replace(/\s/gi,"").replace(/([\(\)])/gi,"\\$1").toLowerCase().replace(";",";?").replace(/rgb\\\((\d+),(\d+),(\d+)\\\)/gi,"\\s?rgb\\($1,\\s?$2,\\s?$3\\)"),"gi"));
e=0;for(g=d.length;e<g;e++)if(f.match(d[e]))return d[e]}return!1}function a(a,f,g,h){for(var k=a.length;k--;){var l;l=a[k];var m=f,q=h;l=g?e(l,g):q?b.dom.hasClass(l,q):d.dom.arrayContains(m,l.tagName.toLowerCase());if(!l)return!1}return a.length?!0:!1}function g(a,b){return d.dom.isCharacterDataNode(a)?0==b?!!a.previousSibling:b==a.length?!!a.nextSibling:!0:0<b&&b<a.childNodes.length}function k(a,b,e,f){var g;d.dom.isCharacterDataNode(b)&&(0==e?(e=d.dom.getNodeIndex(b),b=b.parentNode):e==b.length?
(e=d.dom.getNodeIndex(b)+1,b=b.parentNode):g=d.dom.splitDataNode(b,e));if(!(g||f&&b===f)){g=b.cloneNode(!1);g.id&&g.removeAttribute("id");for(var h;h=b.childNodes[e];)g.appendChild(h);d.dom.insertAfter(g,b)}return b==a?g:k(a,g.parentNode,d.dom.getNodeIndex(g),f)}function l(a){this.firstTextNode=(this.isElementMerge=a.nodeType==b.ELEMENT_NODE)?a.lastChild:a;this.textNodes=[this.firstTextNode]}function q(a,b,d,e,f,g,h){this.tagNames=a||[m];this.cssClass=b||(!1===b?!1:"");this.similarClassRegExp=d;this.cssStyle=
f||"";this.similarStyleRegExp=g;this.normalize=e;this.applyToAnyTagName=!1;this.container=h}var m="span",p=/\s+/g;l.prototype={doMerge:function(){for(var a=[],b,d,e=0,f=this.textNodes.length;e<f;++e)b=this.textNodes[e],d=b.parentNode,a[e]=b.data,e&&(d.removeChild(b),d.hasChildNodes()||d.parentNode.removeChild(d));return this.firstTextNode.data=a=a.join("")},getLength:function(){for(var a=this.textNodes.length,b=0;a--;)b+=this.textNodes[a].length;return b},toString:function(){for(var a=[],b=0,d=this.textNodes.length;b<
d;++b)a[b]="'"+this.textNodes[b].data+"'";return"[Merge("+a.join(",")+")]"}};q.prototype={getAncestorWithClass:function(a){for(var e;a;){if(this.cssClass)if(e=this.cssClass,a.className){var f=a.className.match(this.similarClassRegExp)||[];e=f[f.length-1]===e}else e=!1;else e=""!==this.cssStyle?!1:!0;if(a.nodeType==b.ELEMENT_NODE&&"false"!=a.getAttribute("contenteditable")&&d.dom.arrayContains(this.tagNames,a.tagName.toLowerCase())&&e)return a;a=a.parentNode}return!1},getAncestorWithStyle:function(a){for(var e;a;){if(this.cssStyle){e=
a;var f=this.similarStyleRegExp;e.getAttribute&&e.getAttribute("style")?(e.getAttribute("style").match(f),e=e.getAttribute("style").match(f)?!0:!1):e=!1}else e=!1;if(a.nodeType==b.ELEMENT_NODE&&"false"!=a.getAttribute("contenteditable")&&d.dom.arrayContains(this.tagNames,a.tagName.toLowerCase())&&e)return a;a=a.parentNode}return!1},getMatchingAncestor:function(a){var b=this.getAncestorWithClass(a),d=!1;b?this.cssStyle&&(d="class"):(b=this.getAncestorWithStyle(a))&&(d="style");return{element:b,type:d}},
postApply:function(a,b){for(var d=a[0],e=a[a.length-1],f=[],g,h=d,k=e,m=0,q=e.length,p,w,z=0,H=a.length;z<H;++z)p=a[z],w=null,p&&p.parentNode&&(w=this.getAdjacentMergeableTextNode(p.parentNode,!1)),w?(g||(g=new l(w),f.push(g)),g.textNodes.push(p),p===d&&(h=g.firstTextNode,m=h.length),p===e&&(k=g.firstTextNode,q=g.getLength())):g=null;e&&e.parentNode&&(d=this.getAdjacentMergeableTextNode(e.parentNode,!0))&&(g||(g=new l(e),f.push(g)),g.textNodes.push(d));if(f.length){z=0;for(H=f.length;z<H;++z)f[z].doMerge();
b.setStart(h,m);b.setEnd(k,q)}},getAdjacentMergeableTextNode:function(a,d){var e=a.nodeType==b.TEXT_NODE,f=e?a.parentNode:a,g=d?"nextSibling":"previousSibling";if(e){if((e=a[g])&&e.nodeType==b.TEXT_NODE)return e}else if((e=f[g])&&this.areElementsMergeable(a,e))return e[d?"firstChild":"lastChild"];return null},areElementsMergeable:function(a,b){var e;if(e=d.dom.arrayContains(this.tagNames,(a.tagName||"").toLowerCase()))if(e=d.dom.arrayContains(this.tagNames,(b.tagName||"").toLowerCase()))if(e=a.className.replace(p,
" ")==b.className.replace(p," "))a:if(a.attributes.length!=b.attributes.length)e=!1;else{e=0;for(var f=a.attributes.length,g,h;e<f;++e)if(g=a.attributes[e],h=g.name,"class"!=h&&(h=b.attributes.getNamedItem(h),g.specified!=h.specified||g.specified&&g.nodeValue!==h.nodeValue)){e=!1;break a}e=!0}return e},createContainer:function(a){a=a.createElement(this.tagNames[0]);this.cssClass&&(a.className=this.cssClass);this.cssStyle&&a.setAttribute("style",this.cssStyle);return a},applyToTextNode:function(a){var b=
a.parentNode;1==b.childNodes.length&&d.dom.arrayContains(this.tagNames,b.tagName.toLowerCase())?(this.cssClass&&(a=this.cssClass,b.className?(b.className&&(b.className=b.className.replace(this.similarClassRegExp,"")),b.className+=" "+a):b.className=a),this.cssStyle&&f(b,this.cssStyle,this.similarStyleRegExp)):(b=this.createContainer(d.dom.getDocument(a)),a.parentNode.insertBefore(b,a),b.appendChild(a))},isRemovable:function(a){return d.dom.arrayContains(this.tagNames,a.tagName.toLowerCase())&&""===
b.lang.string(a.className).trim()&&(!a.getAttribute("style")||""===b.lang.string(a.getAttribute("style")).trim())},undoToTextNode:function(a,b,d,l){a=d?!1:!0;d=d||l;l=!1;if(!b.containsNode(d)){var m=b.cloneRange();m.selectNode(d);m.isPointInRange(b.endContainer,b.endOffset)&&g(b.endContainer,b.endOffset)&&(k(d,b.endContainer,b.endOffset,this.container),b.setEndAfter(d));m.isPointInRange(b.startContainer,b.startOffset)&&g(b.startContainer,b.startOffset)&&(d=k(d,b.startContainer,b.startOffset,this.container))}!a&&
this.similarClassRegExp&&d.className&&(d.className=d.className.replace(this.similarClassRegExp,""));a&&this.similarStyleRegExp&&(b=d,a=this.cssStyle,l=this.similarStyleRegExp,(m=e(b,a))?(h(b,m),b="remove"):(f(b,a,l),b="change"),l="change"===b);if(this.isRemovable(d)&&!l){for(b=d.parentNode;d.firstChild;)b.insertBefore(d.firstChild,d);b.removeChild(d)}},applyToRange:function(a){for(var d,e=a.length;e--;){d=a[e].getNodes([b.TEXT_NODE]);if(!d.length)try{var f=this.createContainer(a[e].endContainer.ownerDocument);
a[e].surroundContents(f);this.selectNode(a[e],f);break}catch(g){}a[e].splitBoundaries();d=a[e].getNodes([b.TEXT_NODE]);if(d.length){for(var h,k=0,l=d.length;k<l;++k)h=d[k],this.getMatchingAncestor(h).element||this.applyToTextNode(h);a[e].setStart(d[0],0);h=d[d.length-1];a[e].setEnd(h,h.length);this.normalize&&this.postApply(d,a[e])}}},undoToRange:function(a){for(var d,e,f,g=a.length;g--;){d=a[g].getNodes([b.TEXT_NODE]);d.length?(a[g].splitBoundaries(),d=a[g].getNodes([b.TEXT_NODE])):(d=a[g].endContainer.ownerDocument.createTextNode(b.INVISIBLE_SPACE),
a[g].insertNode(d),a[g].selectNode(d),d=[d]);for(var h=0,k=d.length;h<k;++h)a[g].isValid()&&(e=d[h],f=this.getMatchingAncestor(e),"style"===f.type?this.undoToTextNode(e,a[g],!1,f.element):f.element&&this.undoToTextNode(e,a[g],f.element));1==k?this.selectNode(a[g],d[0]):(a[g].setStart(d[0],0),e=d[d.length-1],a[g].setEnd(e,e.length),this.normalize&&this.postApply(d,a[g]))}},selectNode:function(a,d){var e=d.nodeType===b.ELEMENT_NODE,f="canHaveHTML"in d?d.canHaveHTML:!0,g=e?d.innerHTML:d.data;if((g=""===
g||g===b.INVISIBLE_SPACE)&&e&&f)try{d.innerHTML=b.INVISIBLE_SPACE}catch(h){}a.selectNodeContents(d);g&&e?a.collapse(!1):g&&(a.setStartAfter(d),a.setEndAfter(d))},getTextSelectedByRange:function(a,b){var d=b.cloneRange();d.selectNodeContents(a);var e=d.intersection(b),e=e?e.toString():"";d.detach();return e},isAppliedToRange:function(a){for(var d=[],e="full",f,g,h=a.length;h--;){g=a[h].getNodes([b.TEXT_NODE]);if(!g.length)return(f=this.getMatchingAncestor(a[h].startContainer).element)?{elements:[f],
coverage:e}:!1;for(var k=0,l=g.length,m;k<l;++k)m=this.getTextSelectedByRange(g[k],a[h]),(f=this.getMatchingAncestor(g[k]).element)&&""!=m?(d.push(f),1===b.dom.getTextNodes(f,!0).length?e="full":"full"===e&&(e="inline")):f||(e="partial")}return d.length?{elements:d,coverage:e}:!1},toggleRange:function(b){var d=this.isAppliedToRange(b);d?"full"===d.coverage?this.undoToRange(b):"inline"===d.coverage?(d=a(d.elements,this.tagNames,this.cssStyle,this.cssClass),this.undoToRange(b),d||this.applyToRange(b)):
(a(d.elements,this.tagNames,this.cssStyle,this.cssClass)||this.undoToRange(b),this.applyToRange(b)):this.applyToRange(b)}};b.selection.HTMLApplier=q})(wysihtml5,rangy);
wysihtml5.Commands=Base.extend({constructor:function(b){this.editor=b;this.composer=b.composer;this.doc=this.composer.doc},support:function(b){return wysihtml5.browser.supportsCommand(this.doc,b)},exec:function(b,d){var f=wysihtml5.commands[b],h=wysihtml5.lang.array(arguments).get(),e=f&&f.exec,a=null;this.editor.fire("beforecommand:composer");if(e)h.unshift(this.composer),a=e.apply(f,h);else try{a=this.doc.execCommand(b,!1,d)}catch(g){}this.editor.fire("aftercommand:composer");return a},state:function(b,
d){var f=wysihtml5.commands[b],h=wysihtml5.lang.array(arguments).get(),e=f&&f.state;if(e)return h.unshift(this.composer),e.apply(f,h);try{return this.doc.queryCommandState(b)}catch(a){return!1}},stateValue:function(b){var d=wysihtml5.commands[b],f=wysihtml5.lang.array(arguments).get(),h=d&&d.stateValue;return h?(f.unshift(this.composer),h.apply(d,f)):!1}});
wysihtml5.commands.bold={exec:function(b,d){wysihtml5.commands.formatInline.execWithToggle(b,d,"b")},state:function(b,d){return wysihtml5.commands.formatInline.state(b,d,"b")}};
(function(b){function d(a,d){var k=a.doc,l="_wysihtml5-temp-"+ +new Date,q=0,m,p,n;b.commands.formatInline.exec(a,f,h,l,/non-matching-class/g,f,f,!0,!0);m=k.querySelectorAll(h+"."+l);for(l=m.length;q<l;q++)for(n in p=m[q],p.removeAttribute("class"),d)"text"!==n&&p.setAttribute(n,d[n]);q=p;1===l&&(n=e.getTextContent(p),l=!!p.querySelector("*"),n=""===n||n===b.INVISIBLE_SPACE,!l&&n&&(e.setTextContent(p,d.text||p.href),k=k.createTextNode(" "),a.selection.setAfter(p),e.insert(k).after(p),q=k));a.selection.setAfter(q)}
var f,h="A",e=b.dom;b.commands.createLink={exec:function(a,b,e){var f=this.state(a,b);f?a.selection.executeAndRestore(function(){for(var a=e,b,d=f.length;d--;){b=f[d].attributes;for(var g=b.length;g--;)f[d].removeAttribute(b.item(g).name);for(var h in a)a.hasOwnProperty(h)&&f[d].setAttribute(h,a[h])}}):(e="object"===typeof e?e:{href:e},d(a,e))},state:function(a,d){return b.commands.formatInline.state(a,d,"A")}}})(wysihtml5);
(function(b){var d=b.dom;b.commands.removeLink={exec:function(b,h){var e=this.state(b,h);e&&b.selection.executeAndRestore(function(){for(var a=e.length,b=0,f,h,q;b<a;b++)f=e[b],h=d.getParentElement(f,{nodeName:"code"}),q=d.getTextContent(f),q.match(d.autoLink.URL_REG_EXP)&&!h?d.renameElement(f,"code"):d.replaceWithChildNodes(f)})},state:function(d,h){return b.commands.formatInline.state(d,h,"A")}}})(wysihtml5);
(function(b){var d=/wysiwyg-font-size-[0-9a-z\-]+/g;b.commands.fontSize={exec:function(f,h,e){b.commands.formatInline.execWithToggle(f,h,"span","wysiwyg-font-size-"+e,d)},state:function(f,h,e){return b.commands.formatInline.state(f,h,"span","wysiwyg-font-size-"+e,d)}}})(wysihtml5);
(function(b){var d=/(\s|^)font-size\s*:\s*[^;\s]+;?/gi;b.commands.fontSizeStyle={exec:function(f,h,e){e="object"==typeof e?e.size:e;/^\s*$/.test(e)||b.commands.formatInline.execWithToggle(f,h,"span",!1,!1,"font-size:"+e,d)},state:function(f,h,e){return b.commands.formatInline.state(f,h,"span",!1,!1,"font-size",d)},stateValue:function(d,h){var e=this.state(d,h);e&&b.lang.object(e).isArray()&&(e=e[0]);return e&&(e=e.getAttribute("style"))?b.quirks.styleParser.parseFontSize(e):!1}}})(wysihtml5);
(function(b){var d=/wysiwyg-color-[0-9a-z]+/g;b.commands.foreColor={exec:function(f,h,e){b.commands.formatInline.execWithToggle(f,h,"span","wysiwyg-color-"+e,d)},state:function(f,h,e){return b.commands.formatInline.state(f,h,"span","wysiwyg-color-"+e,d)}}})(wysihtml5);
(function(b){var d=/(\s|^)color\s*:\s*[^;\s]+;?/gi;b.commands.foreColorStyle={exec:function(f,h,e){e=b.quirks.styleParser.parseColor("object"==typeof e?"color:"+e.color:"color:"+e,"color");var a;e&&(a="color: rgb("+e[0]+","+e[1]+","+e[2]+");",1!==e[3]&&(a+="color: rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+");"),b.commands.formatInline.execWithToggle(f,h,"span",!1,!1,a,d))},state:function(f,h){return b.commands.formatInline.state(f,h,"span",!1,!1,"color",d)},stateValue:function(d,h,e){(d=this.state(d,
h))&&b.lang.object(d).isArray()&&(d=d[0]);return d&&(d=d.getAttribute("style"))&&d?(val=b.quirks.styleParser.parseColor(d,"color"),b.quirks.styleParser.unparseColor(val,e)):!1}}})(wysihtml5);
(function(b){var d=/(\s|^)background-color\s*:\s*[^;\s]+;?/gi;b.commands.bgColorStyle={exec:function(f,h,e){e=b.quirks.styleParser.parseColor("object"==typeof e?"background-color:"+e.color:"background-color:"+e,"background-color");var a;e&&(a="background-color: rgb("+e[0]+","+e[1]+","+e[2]+");",1!==e[3]&&(a+="background-color: rgba("+e[0]+","+e[1]+","+e[2]+","+e[3]+");"),b.commands.formatInline.execWithToggle(f,h,"span",!1,!1,a,d))},state:function(f,h){return b.commands.formatInline.state(f,h,"span",
!1,!1,"background-color",d)},stateValue:function(d,h,e){d=this.state(d,h);h=!1;d&&b.lang.object(d).isArray()&&(d=d[0]);return d&&(d=d.getAttribute("style"))?(h=b.quirks.styleParser.parseColor(d,"background-color"),b.quirks.styleParser.unparseColor(h,e)):!1}}})(wysihtml5);
(function(b){function d(a,d){var e=d.test(a.className);a.className=a.className.replace(d,"");""==b.lang.string(a.className).trim()&&a.removeAttribute("class");return e}function f(a,d){var e=d.test(a.getAttribute("style"));a.setAttribute("style",(a.getAttribute("style")||"").replace(d,""));""==b.lang.string(a.getAttribute("style")||"").trim()&&a.removeAttribute("style");return e}function h(a,d){a.selection.isCollapsed()&&a.selection.selectLine();for(var e=a.selection.surround(d),f=0,h=e.length;f<h;f++){b.dom.lineBreaks(e[f]).remove();
var p=e[f].lastChild;p&&"BR"===p.nodeName&&p.parentNode.removeChild(p)}}var e=b.dom,a="H1 H2 H3 H4 H5 H6 P PRE DIV".split(" ");b.commands.formatBlock={exec:function(g,k,l,q,m,p,n){var r=this.state(g,k,l,q,m,p,n),s=g.config.useLineBreaks,u=s?"DIV":"P",t,x,F,E,A;l="string"===typeof l?l.toUpperCase():l;if(r.length)g.selection.executeAndRestoreRangy(function(){for(var a=r.length;a--;){m&&(x=d(r[a],m));n&&(E=f(r[a],n));if((E||x)&&null===l&&r[a].nodeName!=u)break;var g=!!b.lang.string(r[a].className).trim(),
h=!!b.lang.string(r[a].getAttribute("style")||"").trim();g||h||!s&&"P"!==l?e.renameElement(r[a],"P"===l?"DIV":u):(b.dom.lineBreaks(r[a]).add(),e.replaceWithChildNodes(r[a]))}});else{if(null===l||b.lang.array(a).contains(l))if(t=g.selection.findNodesInSelection(a).concat(g.selection.getSelectedOwnNodes()),g.selection.executeAndRestoreRangy(function(){for(var h=t.length;h--;)if(A=e.getParentElement(t[h],{nodeName:a}),A==g.element&&(A=null),A){l&&(A=e.renameElement(A,l));if(q){var k=A,r=q;k.className?
(d(k,m),k.className=b.lang.string(k.className+" "+r).trim()):k.className=r}p&&(k=A,r=p,f(k,n),k.getAttribute("style")?k.setAttribute("style",b.lang.string(k.getAttribute("style")+" "+r).trim()):k.setAttribute("style",r));F=!0}}),F)return;h(g,{nodeName:l||u,className:q||null,cssStyle:p||null})}},state:function(a,d,f,h,m,p,n){a=a.selection.getSelectedOwnNodes();d=[];var r;f="string"===typeof f?f.toUpperCase():f;for(var s=0,u=a.length;s<u;s++)(r=e.getParentElement(a[s],{nodeName:f,className:h,classRegExp:m,
cssStyle:p,styleRegExp:n}))&&-1==b.lang.array(d).indexOf(r)&&d.push(r);return 0==d.length?!1:d}}})(wysihtml5);
wysihtml5.commands.formatCode={exec:function(b,d,f){var h=this.state(b),e,a;h?b.selection.executeAndRestore(function(){e=h.querySelector("code");wysihtml5.dom.replaceWithChildNodes(h);e&&wysihtml5.dom.replaceWithChildNodes(e)}):(d=b.selection.getRange(),a=d.extractContents(),h=b.doc.createElement("pre"),e=b.doc.createElement("code"),f&&(e.className=f),h.appendChild(e),e.appendChild(a),d.insertNode(h),b.selection.selectNode(h))},state:function(b){return(b=b.selection.getSelectedNode())&&b.nodeName&&
"PRE"==b.nodeName&&b.firstChild&&b.firstChild.nodeName&&"CODE"==b.firstChild.nodeName?b:wysihtml5.dom.getParentElement(b,{nodeName:"CODE"})&&wysihtml5.dom.getParentElement(b,{nodeName:"PRE"})}};
(function(b){function d(d,a,g,k,l,q){var m=d;a&&(m+=":"+a);k&&(m+=":"+k);if(!h[m]){var p=h,n=m,r=b.selection.HTMLApplier,s=f[d];d=s?[d.toLowerCase(),s.toLowerCase()]:[d.toLowerCase()];p[n]=new r(d,a,g,!0,k,l,q)}return h[m]}var f={strong:"b",em:"i",b:"strong",i:"em"},h={};b.commands.formatInline={exec:function(b,a,f,h,l,q,m,p,n){a=b.selection.createRange();var r=b.selection.getOwnRanges();if(!r||0==r.length)return!1;b.selection.getSelection().removeAllRanges();d(f,h,l,q,m,b.element).toggleRange(r);
p?n||b.cleanUp():(a.setStart(r[0].startContainer,r[0].startOffset),a.setEnd(r[r.length-1].endContainer,r[r.length-1].endOffset),b.selection.setSelection(a),b.selection.executeAndRestore(function(){n||b.cleanUp()},!0,!0))},execWithToggle:function(d,a,f,h,l,q,m){if(this.state(d,a,f,h,l,q,m)&&d.selection.isCollapsed()&&!d.selection.caretIsLastInSelection()&&!d.selection.caretIsFirstInSelection()){var p=this.state(d,a,f,h,l)[0];d.selection.executeAndRestoreRangy(function(){d.selection.selectNode(p,!0);
b.commands.formatInline.exec(d,a,f,h,l,q,m,!0,!0)})}else this.state(d,a,f,h,l,q,m)&&!d.selection.isCollapsed()?d.selection.executeAndRestoreRangy(function(){b.commands.formatInline.exec(d,a,f,h,l,q,m,!0,!0)}):b.commands.formatInline.exec(d,a,f,h,l,q,m)},state:function(e,a,g,h,l,q,m){a=e.doc;var p=f[g]||g;if(!b.dom.hasElementWithTagName(a,g)&&!b.dom.hasElementWithTagName(a,p)||h&&!b.dom.hasElementWithClassName(a,h))return!1;a=e.selection.getOwnRanges();return a&&0!==a.length?(e=d(g,h,l,q,m,e.element).isAppliedToRange(a))&&
e.elements?e.elements:!1:!1}}})(wysihtml5);
(function(b){b.commands.insertBlockQuote={exec:function(d,f){var h=this.state(d,f),e=d.selection.isEndToEndInNode("H1 H2 H3 H4 H5 H6 P".split(" "));d.selection.executeAndRestore(function(){if(h)d.config.useLineBreaks&&b.dom.lineBreaks(h).add(),b.dom.unwrap(h);else if(d.selection.isCollapsed()&&d.selection.selectLine(),e){var a=e.ownerDocument.createElement("blockquote");b.dom.insert(a).after(e);a.appendChild(e)}else d.selection.surround({nodeName:"blockquote"})})},state:function(d,f){var h=d.selection.getSelectedNode();
return(h=b.dom.getParentElement(h,{nodeName:"BLOCKQUOTE"},!1,d.element))?h:!1}}})(wysihtml5);wysihtml5.commands.insertHTML={exec:function(b,d,f){b.commands.support(d)?b.doc.execCommand(d,!1,f):b.selection.insertHTML(f)},state:function(){return!1}};
(function(b){b.commands.insertImage={exec:function(d,f,h){h="object"===typeof h?h:{src:h};var e=d.doc;if(f=this.state(d))d.selection.setBefore(f),h=f.parentNode,h.removeChild(f),b.dom.removeEmptyTextNodes(h),"A"!==h.nodeName||h.firstChild||(d.selection.setAfter(h),h.parentNode.removeChild(h)),b.quirks.redraw(d.element);else{f=e.createElement("IMG");for(var a in h)f.setAttribute("className"===a?"class":a,h[a]);d.selection.insertNode(f);b.browser.hasProblemsSettingCaretAfterImg()?(h=e.createTextNode(b.INVISIBLE_SPACE),
d.selection.insertNode(h),d.selection.setAfter(h)):d.selection.setAfter(f)}},state:function(d){var f;if(!b.dom.hasElementWithTagName(d.doc,"IMG"))return!1;f=d.selection.getSelectedNode();if(!f)return!1;if("IMG"===f.nodeName)return f;if(f.nodeType!==b.ELEMENT_NODE)return!1;f=d.selection.getText();if(f=b.lang.string(f).trim())return!1;d=d.selection.getNodes(b.ELEMENT_NODE,function(b){return"IMG"===b.nodeName});return 1!==d.length?!1:d[0]}}})(wysihtml5);
(function(b){var d="<br>"+(b.browser.needsSpaceAfterLineBreak()?" ":"");b.commands.insertLineBreak={exec:function(f,h){f.commands.support(h)?(f.doc.execCommand(h,!1,null),b.browser.autoScrollsToCaret()||f.selection.scrollIntoView()):f.commands.exec("insertHTML",d)},state:function(){return!1}}})(wysihtml5);wysihtml5.commands.insertOrderedList={exec:function(b,d){wysihtml5.commands.insertList.exec(b,d,"OL")},state:function(b,d){return wysihtml5.commands.insertList.state(b,d,"OL")}};
wysihtml5.commands.insertUnorderedList={exec:function(b,d){wysihtml5.commands.insertList.exec(b,d,"UL")},state:function(b,d){return wysihtml5.commands.insertList.state(b,d,"UL")}};
wysihtml5.commands.insertList=function(b){var d=function(a,b){if(a&&a.nodeName){"string"===typeof b&&(b=[b]);for(var d=b.length;d--;)if(a.nodeName===b[d])return!0}return!1},f=function(a,e,f){var g={el:null,other:!1};if(a){var h=b.dom.getParentElement(a,{nodeName:"LI"}),n="UL"===e?"OL":"UL";d(a,e)?g.el=a:d(a,n)?g={el:a,other:!0}:h&&(d(h.parentNode,e)?g.el=h.parentNode:d(h.parentNode,n)&&(g={el:h.parentNode,other:!0}))}g.el&&!f.element.contains(g.el)&&(g.el=null);return g},h=function(d,e,f){var g="UL"===
e?"OL":"UL",h;f.selection.executeAndRestore(function(){var n=a(g,f);if(n.length)for(var r=n.length;r--;)b.dom.renameElement(n[r],e.toLowerCase());else{h=a(["OL","UL"],f);for(n=h.length;n--;)b.dom.resolveList(h[n],f.config.useLineBreaks);b.dom.resolveList(d,f.config.useLineBreaks)}})},e=function(d,e,f){var g="UL"===e?"OL":"UL";f.selection.executeAndRestore(function(){for(var h=[d].concat(a(g,f)),n=h.length;n--;)b.dom.renameElement(h[n],e.toLowerCase())})},a=function(a,b){for(var e=b.selection.getOwnRanges(),
f=[],g=e.length;g--;)f=f.concat(e[g].getNodes([1],function(b){return d(b,a)}));return f},g=function(a,d){d.selection.executeAndRestoreRangy(function(){var e="_wysihtml5-temp-"+(new Date).getTime(),f=d.selection.deblockAndSurround({nodeName:"div",className:e});f.innerHTML=f.innerHTML.replace(/\uFEFF/g,"");f&&(e=b.lang.array(["","<br>",b.INVISIBLE_SPACE]).contains(f.innerHTML),f=b.dom.convertToList(f,a.toLowerCase(),d.parent.config.uneditableContainerClassname),e&&d.selection.selectNode(f.querySelector("li"),
!0))})};return{exec:function(a,b,d){b=a.doc;var m="OL"===d?"insertOrderedList":"insertUnorderedList",p=a.selection.getSelectedNode(),p=f(p,d,a);p.el?p.other?e(p.el,d,a):h(p.el,d,a):a.commands.support(m)?b.execCommand(m,!1,null):g(d,a)},state:function(a,b,d){b=a.selection.getSelectedNode();a=f(b,d,a);return a.el&&!a.other?a.el:!1}}}(wysihtml5);
wysihtml5.commands.italic={exec:function(b,d){wysihtml5.commands.formatInline.execWithToggle(b,d,"i")},state:function(b,d){return wysihtml5.commands.formatInline.state(b,d,"i")}};(function(b){var d=/wysiwyg-text-align-[0-9a-z]+/g;b.commands.justifyCenter={exec:function(f,h){return b.commands.formatBlock.exec(f,"formatBlock",null,"wysiwyg-text-align-center",d)},state:function(f,h){return b.commands.formatBlock.state(f,"formatBlock",null,"wysiwyg-text-align-center",d)}}})(wysihtml5);
(function(b){var d=/wysiwyg-text-align-[0-9a-z]+/g;b.commands.justifyLeft={exec:function(f,h){return b.commands.formatBlock.exec(f,"formatBlock",null,"wysiwyg-text-align-left",d)},state:function(f,h){return b.commands.formatBlock.state(f,"formatBlock",null,"wysiwyg-text-align-left",d)}}})(wysihtml5);
(function(b){var d=/wysiwyg-text-align-[0-9a-z]+/g;b.commands.justifyRight={exec:function(f,h){return b.commands.formatBlock.exec(f,"formatBlock",null,"wysiwyg-text-align-right",d)},state:function(f,h){return b.commands.formatBlock.state(f,"formatBlock",null,"wysiwyg-text-align-right",d)}}})(wysihtml5);
(function(b){var d=/wysiwyg-text-align-[0-9a-z]+/g;b.commands.justifyFull={exec:function(f,h){return b.commands.formatBlock.exec(f,"formatBlock",null,"wysiwyg-text-align-justify",d)},state:function(f,h){return b.commands.formatBlock.state(f,"formatBlock",null,"wysiwyg-text-align-justify",d)}}})(wysihtml5);
(function(b){var d=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;b.commands.alignRightStyle={exec:function(f,h){return b.commands.formatBlock.exec(f,"formatBlock",null,null,null,"text-align: right;",d)},state:function(f,h){return b.commands.formatBlock.state(f,"formatBlock",null,null,null,"text-align: right;",d)}}})(wysihtml5);
(function(b){var d=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;b.commands.alignLeftStyle={exec:function(f,h){return b.commands.formatBlock.exec(f,"formatBlock",null,null,null,"text-align: left;",d)},state:function(f,h){return b.commands.formatBlock.state(f,"formatBlock",null,null,null,"text-align: left;",d)}}})(wysihtml5);
(function(b){var d=/(\s|^)text-align\s*:\s*[^;\s]+;?/gi;b.commands.alignCenterStyle={exec:function(f,h){return b.commands.formatBlock.exec(f,"formatBlock",null,null,null,"text-align: center;",d)},state:function(f,h){return b.commands.formatBlock.state(f,"formatBlock",null,null,null,"text-align: center;",d)}}})(wysihtml5);wysihtml5.commands.redo={exec:function(b){return b.undoManager.redo()},state:function(b){return!1}};
wysihtml5.commands.underline={exec:function(b,d){wysihtml5.commands.formatInline.execWithToggle(b,d,"u")},state:function(b,d){return wysihtml5.commands.formatInline.state(b,d,"u")}};wysihtml5.commands.undo={exec:function(b){return b.undoManager.undo()},state:function(b){return!1}};
wysihtml5.commands.createTable={exec:function(b,d,f){var h,e;if(f&&f.cols&&f.rows&&0<parseInt(f.cols,10)&&0<parseInt(f.rows,10)){e=f.tableStyle?'<table style="'+f.tableStyle+'">':"<table>";e+="<tbody>";for(h=0;h<f.rows;h++){e+="<tr>";for(d=0;d<f.cols;d++)e+="<td>&nbsp;</td>";e+="</tr>"}b.commands.exec("insertHTML",e+"</tbody></table>")}},state:function(b,d){return!1}};
wysihtml5.commands.mergeTableCells={exec:function(b,d){b.tableSelection&&b.tableSelection.start&&b.tableSelection.end&&(this.state(b,d)?wysihtml5.dom.table.unmergeCell(b.tableSelection.start):wysihtml5.dom.table.mergeCellsBetween(b.tableSelection.start,b.tableSelection.end))},state:function(b,d){if(b.tableSelection){var f=b.tableSelection.start,h=b.tableSelection.end;if(f&&h&&f==h&&(wysihtml5.dom.getAttribute(f,"colspan")&&1<parseInt(wysihtml5.dom.getAttribute(f,"colspan"),10)||wysihtml5.dom.getAttribute(f,
"rowspan")&&1<parseInt(wysihtml5.dom.getAttribute(f,"rowspan"),10)))return[f]}return!1}};
wysihtml5.commands.addTableCells={exec:function(b,d,f){if(b.tableSelection&&b.tableSelection.start&&b.tableSelection.end){var h=wysihtml5.dom.table.orderSelectionEnds(b.tableSelection.start,b.tableSelection.end);"before"==f||"above"==f?wysihtml5.dom.table.addCells(h.start,f):"after"!=f&&"below"!=f||wysihtml5.dom.table.addCells(h.end,f);setTimeout(function(){b.tableSelection.select(h.start,h.end)},0)}},state:function(b,d){return!1}};
wysihtml5.commands.deleteTableCells={exec:function(b,d,f){if(b.tableSelection&&b.tableSelection.start&&b.tableSelection.end){d=wysihtml5.dom.table.orderSelectionEnds(b.tableSelection.start,b.tableSelection.end);var h=wysihtml5.dom.table.indexOf(d.start),e,a=b.tableSelection.table;wysihtml5.dom.table.removeCells(d.start,f);setTimeout(function(){e=wysihtml5.dom.table.findCell(a,h);e||("row"==f&&(e=wysihtml5.dom.table.findCell(a,{row:h.row-1,col:h.col})),"column"==f&&(e=wysihtml5.dom.table.findCell(a,
{row:h.row,col:h.col-1})));e&&b.tableSelection.select(e,e)},0)}},state:function(b,d){return!1}};
wysihtml5.commands.indentList={exec:function(b,d,f){return(d=b.selection.getSelectionParentsByTag("LI"))?this.tryToPushLiLevel(d,b.selection):!1},state:function(b,d){return!1},tryToPushLiLevel:function(b,d){var f,h,e,a,g,k=!1;d.executeAndRestoreRangy(function(){for(var d=b.length;d--;)a=b[d],f="OL"===a.parentNode.nodeName?"OL":"UL",h=a.ownerDocument.createElement(f),g=(e=wysihtml5.dom.domNode(a).prev({nodeTypes:[wysihtml5.ELEMENT_NODE]}))?e.querySelector("ul, ol"):null,e&&(g?g.appendChild(a):(h.appendChild(a),
e.appendChild(h)),k=!0)});return k}};
wysihtml5.commands.outdentList={exec:function(b,d,f){return(d=b.selection.getSelectionParentsByTag("LI"))?this.tryToPullLiLevel(d,b):!1},state:function(b,d){return!1},tryToPullLiLevel:function(b,d){var f,h,e,a,g,k=!1,l=this;d.selection.executeAndRestoreRangy(function(){for(var q=b.length;q--;)if(a=b[q],a.parentNode&&(f=a.parentNode,"OL"===f.tagName||"UL"===f.tagName)){k=!0;h=wysihtml5.dom.getParentElement(f.parentNode,{nodeName:["OL","UL"]},!1,d.element);e=wysihtml5.dom.getParentElement(f.parentNode,{nodeName:["LI"]},
!1,d.element);if(h&&e)a.nextSibling&&(g=l.getAfterList(f,a),a.appendChild(g)),h.insertBefore(a,e.nextSibling);else{a.nextSibling&&(g=l.getAfterList(f,a),a.appendChild(g));for(var m=a.childNodes.length;m--;)f.parentNode.insertBefore(a.childNodes[m],f.nextSibling);f.parentNode.insertBefore(document.createElement("br"),f.nextSibling);a.parentNode.removeChild(a)}0===f.childNodes.length&&f.parentNode.removeChild(f)}});return k},getAfterList:function(b,d){for(var f=document.createElement(b.nodeName);d.nextSibling;)f.appendChild(d.nextSibling);
return f}};
(function(b){var d=b.dom;b.UndoManager=b.lang.Dispatcher.extend({constructor:function(b){this.editor=b;this.composer=b.composer;this.element=this.composer.element;this.position=0;this.historyStr=[];this.historyDom=[];this.transact();this._observe()},_observe:function(){var b=this;this.composer.sandbox.getDocument();var h;d.observe(this.element,"keydown",function(d){if(!d.altKey&&(d.ctrlKey||d.metaKey)){var a=d.keyCode,g=90===a&&d.shiftKey||89===a;90!==a||d.shiftKey?g&&(b.redo(),d.preventDefault()):(b.undo(),
d.preventDefault())}});d.observe(this.element,"keydown",function(d){d=d.keyCode;d!==h&&(h=d,8!==d&&46!==d||b.transact())});this.editor.on("newword:composer",function(){b.transact()}).on("beforecommand:composer",function(){b.transact()})},transact:function(){var d=this.historyStr[this.position-1],h=this.composer.getValue(!1,!1),e=0<this.element.offsetWidth&&0<this.element.offsetHeight,a,g;h!==d&&(25<(this.historyStr.length=this.historyDom.length=this.position)&&(this.historyStr.shift(),this.historyDom.shift(),
this.position--),this.position++,e&&(d=(a=this.composer.selection.getRange())&&a.startContainer?a.startContainer:this.element,e=a&&a.startOffset?a.startOffset:0,d.nodeType===b.ELEMENT_NODE?a=d:(a=d.parentNode,g=this.getChildNodeIndex(a,d)),a.setAttribute("data-wysihtml5-selection-offset",e),"undefined"!==typeof g&&a.setAttribute("data-wysihtml5-selection-node",g)),g=this.element.cloneNode(!!h),this.historyDom.push(g),this.historyStr.push(h),a&&(a.removeAttribute("data-wysihtml5-selection-offset"),
a.removeAttribute("data-wysihtml5-selection-node")))},undo:function(){this.transact();this.undoPossible()&&(this.set(this.historyDom[--this.position-1]),this.editor.fire("undo:composer"))},redo:function(){this.redoPossible()&&(this.set(this.historyDom[++this.position-1]),this.editor.fire("redo:composer"))},undoPossible:function(){return 1<this.position},redoPossible:function(){return this.position<this.historyStr.length},set:function(b){this.element.innerHTML="";for(var d=0,e=b.childNodes,a=b.childNodes.length;d<
a;d++)this.element.appendChild(e[d].cloneNode(!0));b.hasAttribute("data-wysihtml5-selection-offset")?(d=b.getAttribute("data-wysihtml5-selection-offset"),e=b.getAttribute("data-wysihtml5-selection-node"),b=this.element):(b=this.element.querySelector("[data-wysihtml5-selection-offset]")||this.element,d=b.getAttribute("data-wysihtml5-selection-offset"),e=b.getAttribute("data-wysihtml5-selection-node"),b.removeAttribute("data-wysihtml5-selection-offset"),b.removeAttribute("data-wysihtml5-selection-node"));
null!==e&&(b=this.getChildNodeByIndex(b,+e));this.composer.selection.set(b,d)},getChildNodeIndex:function(b,d){for(var e=0,a=b.childNodes,g=a.length;e<g;e++)if(a[e]===d)return e},getChildNodeByIndex:function(b,d){return b.childNodes[d]}})})(wysihtml5);
wysihtml5.views.View=Base.extend({constructor:function(b,d,f){this.parent=b;this.element=d;this.config=f;this.config.noTextarea||this._observeViewChange()},_observeViewChange:function(){var b=this;this.parent.on("beforeload",function(){b.parent.on("change_view",function(d){d===b.name?(b.parent.currentView=b,b.show(),setTimeout(function(){b.focus()},0)):b.hide()})})},focus:function(){if(this.element.ownerDocument.querySelector(":focus")!==this.element)try{this.element.focus()}catch(b){}},hide:function(){this.element.style.display=
"none"},show:function(){this.element.style.display=""},disable:function(){this.element.setAttribute("disabled","disabled")},enable:function(){this.element.removeAttribute("disabled")}});
(function(b){var d=b.dom,f=b.browser;b.views.Composer=b.views.View.extend({name:"composer",CARET_HACK:"<br>",constructor:function(b,d,a){this.base(b,d,a);this.config.noTextarea?this.editableArea=d:this.textarea=this.parent.textarea;this.config.contentEditableMode?this._initContentEditableArea():this._initSandbox()},clear:function(){this.element.innerHTML=f.displaysCaretInEmptyContentEditableCorrectly()?"":this.CARET_HACK},getValue:function(d,e){var a=this.isEmpty()?"":b.quirks.getCorrectInnerHTML(this.element);
!1!==d&&(a=this.parent.parse(a,!1===e?!1:!0));return a},setValue:function(b,d){d&&(b=this.parent.parse(b));try{this.element.innerHTML=b}catch(a){this.element.innerText=b}},cleanUp:function(){this.parent.parse(this.element)},show:function(){this.editableArea.style.display=this._displayStyle||"";this.config.noTextarea||this.textarea.element.disabled||(this.disable(),this.enable())},hide:function(){this._displayStyle=d.getStyle("display").from(this.editableArea);"none"===this._displayStyle&&(this._displayStyle=
null);this.editableArea.style.display="none"},disable:function(){this.parent.fire("disable:composer");this.element.removeAttribute("contentEditable")},enable:function(){this.parent.fire("enable:composer");this.element.setAttribute("contentEditable","true")},focus:function(d){b.browser.doesAsyncFocus()&&this.hasPlaceholderSet()&&this.clear();this.base();var e=this.element.lastChild;d&&e&&this.selection&&("BR"===e.nodeName?this.selection.setBefore(this.element.lastChild):this.selection.setAfter(this.element.lastChild))},
getTextContent:function(){return d.getTextContent(this.element)},hasPlaceholderSet:function(){return this.getTextContent()==(this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&this.placeholderSet},isEmpty:function(){var b=this.element.innerHTML.toLowerCase();return/^(\s|<br>|<\/br>|<p>|<\/p>)*$/i.test(b)||""===b||"<br>"===b||"<p></p>"===b||"<p><br></p>"===b||this.hasPlaceholderSet()},_initContentEditableArea:function(){var b=
this;this.config.noTextarea?this.sandbox=new d.ContentEditableArea(function(){b._create()},{},this.editableArea):(this.sandbox=new d.ContentEditableArea(function(){b._create()}),this.editableArea=this.sandbox.getContentEditable(),d.insert(this.editableArea).after(this.textarea.element),this._createWysiwygFormField())},_initSandbox:function(){var b=this;this.sandbox=new d.Sandbox(function(){b._create()},{stylesheets:this.config.stylesheets});this.editableArea=this.sandbox.getIframe();var e=this.textarea.element;
d.insert(this.editableArea).after(e);this._createWysiwygFormField()},_createWysiwygFormField:function(){if(this.textarea.element.form){var b=document.createElement("input");b.type="hidden";b.name="_wysihtml5_mode";b.value=1;d.insert(b).after(this.textarea.element)}},_create:function(){var h=this;this.doc=this.sandbox.getDocument();this.element=this.config.contentEditableMode?this.sandbox.getContentEditable():this.doc.body;this.config.noTextarea?this.cleanUp():(this.textarea=this.parent.textarea,this.element.innerHTML=
this.textarea.getValue(!0,!1));this.selection=new b.Selection(this.parent,this.element,this.config.uneditableContainerClassname);this.commands=new b.Commands(this.parent);this.config.noTextarea||d.copyAttributes("className spellcheck title lang dir accessKey".split(" ")).from(this.textarea.element).to(this.element);d.addClass(this.element,this.config.composerClassName);this.config.style&&!this.config.contentEditableMode&&this.style();this.observe();var e=this.config.name;e&&(d.addClass(this.element,
e),this.config.contentEditableMode||d.addClass(this.editableArea,e));this.enable();!this.config.noTextarea&&this.textarea.element.disabled&&this.disable();(e="string"===typeof this.config.placeholder?this.config.placeholder:this.config.noTextarea?this.editableArea.getAttribute("data-placeholder"):this.textarea.element.getAttribute("placeholder"))&&d.simulatePlaceholder(this.parent,this,e);this.commands.exec("styleWithCSS",!1);this._initAutoLinking();this._initObjectResizing();this._initUndoManager();
this._initLineBreaking();this.config.noTextarea||!this.textarea.element.hasAttribute("autofocus")&&document.querySelector(":focus")!=this.textarea.element||f.isIos()||setTimeout(function(){h.focus(!0)},100);f.clearsContentEditableCorrectly()||b.quirks.ensureProperClearing(this);this.initSync&&this.config.sync&&this.initSync();this.config.noTextarea||this.textarea.hide();this.parent.fire("beforeload").fire("load")},_initAutoLinking:function(){var h=this,e=f.canDisableAutoLinking(),a=f.doesAutoLinkingInContentEditable();
e&&this.commands.exec("autoUrlDetect",!1);if(this.config.autoLink){if(!a||a&&e)this.parent.on("newword:composer",function(){d.getTextContent(h.element).match(d.autoLink.URL_REG_EXP)&&h.selection.executeAndRestore(function(a,e){for(var f=h.element.querySelectorAll("."+h.config.uneditableContainerClassname),g=!1,k=f.length;k--;)b.dom.contains(f[k],e)&&(g=!0);g||d.autoLink(e.parentNode,[h.config.uneditableContainerClassname])})}),d.observe(this.element,"blur",function(){d.autoLink(h.element,[h.config.uneditableContainerClassname])});
var g=this.sandbox.getDocument().getElementsByTagName("a"),k=d.autoLink.URL_REG_EXP,l=function(a){a=b.lang.string(d.getTextContent(a)).trim();"www."===a.substr(0,4)&&(a="http://"+a);return a};d.observe(this.element,"keydown",function(a){if(g.length){a=h.selection.getSelectedNode(a.target.ownerDocument);var b=d.getParentElement(a,{nodeName:"A"},4),e;b&&(e=l(b),setTimeout(function(){var a=l(b);a!==e&&a.match(k)&&b.setAttribute("href",a)},0))}})}},_initObjectResizing:function(){this.commands.exec("enableObjectResizing",
!0);if(f.supportsEvent("resizeend")){var h=["width","height"],e=h.length,a=this.element;d.observe(a,"resizeend",function(d){d=d.target||d.srcElement;var f=d.style,l=0,q;if("IMG"===d.nodeName){for(;l<e;l++)q=h[l],f[q]&&(d.setAttribute(q,parseInt(f[q],10)),f[q]="");b.quirks.redraw(a)}})}},_initUndoManager:function(){this.undoManager=new b.UndoManager(this.parent)},_initLineBreaking:function(){function h(a){var b=d.getParentElement(a,{nodeName:["P","DIV"]},2);b&&d.contains(e.element,b)&&e.selection.executeAndRestore(function(){e.config.useLineBreaks?
d.replaceWithChildNodes(b):"P"!==b.nodeName&&d.renameElement(b,"p")})}var e=this,a="LI P H1 H2 H3 H4 H5 H6".split(" "),g=["UL","OL","MENU"];this.config.useLineBreaks||d.observe(this.element,["focus","keydown"],function(){if(e.isEmpty()){var a=e.doc.createElement("P");e.element.innerHTML="";e.element.appendChild(a);f.displaysCaretInEmptyContentEditableCorrectly()?e.selection.selectNode(a,!0):(a.innerHTML="<br>",e.selection.setBefore(a.firstChild))}});d.observe(this.element,"keydown",function(f){var l=
f.keyCode;if(!f.shiftKey&&(l===b.ENTER_KEY||l===b.BACKSPACE_KEY)){var q=d.getParentElement(e.selection.getSelectedNode(),{nodeName:a},4);q?setTimeout(function(){var a=e.selection.getSelectedNode(),f;if("LI"===q.nodeName){if(!a)return;(f=d.getParentElement(a,{nodeName:g},2))||h(a)}l===b.ENTER_KEY&&q.nodeName.match(/^H[1-6]$/)&&h(a)},0):e.config.useLineBreaks&&l===b.ENTER_KEY&&!b.browser.insertsLineBreaksOnReturn()&&(f.preventDefault(),e.commands.exec("insertLineBreak"))}})}})})(wysihtml5);
(function(b){var d=b.dom,f=document,h=window,e=f.createElement("div"),a="background-color color cursor font-family font-size font-style font-variant font-weight line-height letter-spacing text-align text-decoration text-indent text-rendering word-break word-wrap word-spacing".split(" "),g="background-color border-collapse border-bottom-color border-bottom-style border-bottom-width border-left-color border-left-style border-left-width border-right-color border-right-style border-right-width border-top-color border-top-style border-top-width clear display float margin-bottom margin-left margin-right margin-top outline-color outline-offset outline-width outline-style padding-left padding-right padding-top padding-bottom position top left right bottom z-index vertical-align text-align -webkit-box-sizing -moz-box-sizing -ms-box-sizing box-sizing -webkit-box-shadow -moz-box-shadow -ms-box-shadow box-shadow -webkit-border-top-right-radius -moz-border-radius-topright border-top-right-radius -webkit-border-bottom-right-radius -moz-border-radius-bottomright border-bottom-right-radius -webkit-border-bottom-left-radius -moz-border-radius-bottomleft border-bottom-left-radius -webkit-border-top-left-radius -moz-border-radius-topleft border-top-left-radius width height".split(" "),
k=["html                 { height: 100%; }","body                 { height: 100%; padding: 1px 0 0 0; margin: -1px 0 0 0; }","body > p:first-child { margin-top: 0; }","._wysihtml5-temp     { display: none; }",b.browser.isGecko?"body.placeholder { color: graytext !important; }":"body.placeholder { color: #a9a9a9 !important; }","img:-moz-broken      { -moz-force-broken-image-icon: 1; height: 24px; width: 24px; }"],l=function(a){if(a.setActive)try{a.setActive()}catch(b){}else{var e=a.style,g=f.documentElement.scrollTop||
f.body.scrollTop,k=f.documentElement.scrollLeft||f.body.scrollLeft,e={position:e.position,top:e.top,left:e.left,WebkitUserSelect:e.WebkitUserSelect};d.setStyles({position:"absolute",top:"-99999px",left:"-99999px",WebkitUserSelect:"none"}).on(a);a.focus();d.setStyles(e).on(a);h.scrollTo&&h.scrollTo(k,g)}};b.views.Composer.prototype.style=function(){var h=this,m=f.querySelector(":focus"),p=this.textarea.element,n=p.hasAttribute("placeholder"),r=n&&p.getAttribute("placeholder"),s=p.style.display,u=p.disabled,
t;this.focusStylesHost=e.cloneNode(!1);this.blurStylesHost=e.cloneNode(!1);this.disabledStylesHost=e.cloneNode(!1);n&&p.removeAttribute("placeholder");p===m&&p.blur();p.disabled=!1;p.style.display=t="none";if(p.getAttribute("rows")&&"auto"===d.getStyle("height").from(p)||p.getAttribute("cols")&&"auto"===d.getStyle("width").from(p))p.style.display=t=s;d.copyStyles(g).from(p).to(this.editableArea).andTo(this.blurStylesHost);d.copyStyles(a).from(p).to(this.element).andTo(this.blurStylesHost);d.insertCSS(k).into(this.element.ownerDocument);
p.disabled=!0;d.copyStyles(g).from(p).to(this.disabledStylesHost);d.copyStyles(a).from(p).to(this.disabledStylesHost);p.disabled=u;p.style.display=s;l(p);p.style.display=t;d.copyStyles(g).from(p).to(this.focusStylesHost);d.copyStyles(a).from(p).to(this.focusStylesHost);p.style.display=s;d.copyStyles(["display"]).from(p).to(this.editableArea);var x=b.lang.array(g).without(["display"]);m?m.focus():p.blur();n&&p.setAttribute("placeholder",r);this.parent.on("focus:composer",function(){d.copyStyles(x).from(h.focusStylesHost).to(h.editableArea);
d.copyStyles(a).from(h.focusStylesHost).to(h.element)});this.parent.on("blur:composer",function(){d.copyStyles(x).from(h.blurStylesHost).to(h.editableArea);d.copyStyles(a).from(h.blurStylesHost).to(h.element)});this.parent.observe("disable:composer",function(){d.copyStyles(x).from(h.disabledStylesHost).to(h.editableArea);d.copyStyles(a).from(h.disabledStylesHost).to(h.element)});this.parent.observe("enable:composer",function(){d.copyStyles(x).from(h.blurStylesHost).to(h.editableArea);d.copyStyles(a).from(h.blurStylesHost).to(h.element)});
return this}})(wysihtml5);
(function(b){var d=b.dom,f=b.browser,h={66:"bold",73:"italic",85:"underline"};b.views.Composer.prototype.observe=function(){var e=this,a=this.getValue(!1,!1),g=this.sandbox.getIframe?this.sandbox.getIframe():this.sandbox.getContentEditable(),k=this.element,l=f.supportsEventsInIframeCorrectly()||this.sandbox.getContentEditable?k:this.sandbox.getWindow();d.observe(g,"DOMNodeRemoved",function(){clearInterval(q);e.parent.fire("destroy:composer")});if(!f.supportsMutationEvents())var q=setInterval(function(){d.contains(document.documentElement,
g)||(clearInterval(q),e.parent.fire("destroy:composer"))},250);d.observe(l,["drop","paste","mouseup","focus","keyup"],function(){setTimeout(function(){e.parent.fire("interaction").fire("interaction:composer")},0)});this.config.handleTables&&(!this.tableClickHandle&&this.doc.execCommand&&b.browser.supportsCommand(this.doc,"enableObjectResizing")&&b.browser.supportsCommand(this.doc,"enableInlineTableEditing")&&(this.sandbox.getIframe?this.tableClickHandle=d.observe(g,["focus","mouseup","mouseover"],
function(){e.doc.execCommand("enableObjectResizing",!1,"false");e.doc.execCommand("enableInlineTableEditing",!1,"false");e.tableClickHandle.stop()}):setTimeout(function(){e.doc.execCommand("enableObjectResizing",!1,"false");e.doc.execCommand("enableInlineTableEditing",!1,"false")},0)),this.tableSelection=b.quirks.tableCellsSelection(k,e.parent));d.observe(l,"focus",function(b){e.parent.fire("focus",b).fire("focus:composer",b);setTimeout(function(){a=e.getValue(!1,!1)},0)});d.observe(l,"blur",function(b){if(a!==
e.getValue(!1,!1)){var d=b;"function"==typeof Object.create&&(d=Object.create(b,{type:{value:"change"}}));e.parent.fire("change",d).fire("change:composer",d)}e.parent.fire("blur",b).fire("blur:composer",b)});d.observe(k,"dragenter",function(){e.parent.fire("unset_placeholder")});d.observe(k,["drop","paste","beforepaste"],function(a){e.parent.fire(a.type,a).fire(a.type+":composer",a)});this.config.copyedFromMarking&&d.observe(k,"copy",function(a){a.clipboardData&&(a.clipboardData.setData("text/html",
e.config.copyedFromMarking+e.selection.getHtml()),a.preventDefault());e.parent.fire(a.type,a).fire(a.type+":composer",a)});d.observe(k,"keyup",function(a){a=a.keyCode;a!==b.SPACE_KEY&&a!==b.ENTER_KEY||e.parent.fire("newword:composer")});this.parent.on("paste:composer",function(){setTimeout(function(){e.parent.fire("newword:composer")},0)});f.canSelectImagesInContentEditable()||d.observe(k,"mousedown",function(a){a=a.target;var d=k.querySelectorAll("img"),f=k.querySelectorAll("."+e.config.uneditableContainerClassname+
" img"),d=b.lang.array(d).without(f);"IMG"===a.nodeName&&b.lang.array(d).contains(a)&&e.selection.selectNode(a)});f.canSelectImagesInContentEditable()||d.observe(k,"drop",function(a){setTimeout(function(){e.selection.getSelection().removeAllRanges()},0)});f.hasHistoryIssue()&&f.supportsSelectionModify()&&d.observe(k,"keydown",function(a){if(a.metaKey||a.ctrlKey){var b=a.keyCode,d=k.ownerDocument.defaultView.getSelection();if(37===b||39===b)37===b&&(d.modify("extend","left","lineboundary"),a.shiftKey||
d.collapseToStart()),39===b&&(d.modify("extend","right","lineboundary"),a.shiftKey||d.collapseToEnd()),a.preventDefault()}});d.observe(k,"keydown",function(a){var b=a.keyCode,d=h[b];(a.ctrlKey||a.metaKey)&&!a.altKey&&d&&(e.commands.exec(d),a.preventDefault());if(8===b)if(b=e.selection,b.isCollapsed())if(b.caretIsInTheBeginnig("LI"))a.preventDefault(),e.commands.exec("outdentList");else if(b.caretIsInTheBeginnig())a.preventDefault();else{if(b.caretIsFirstInSelection()&&b.getPreviousNode()&&b.getPreviousNode().nodeName&&
/^H\d$/gi.test(b.getPreviousNode().nodeName))if(d=b.getPreviousNode(),a.preventDefault(),/^\s*$/.test(d.textContent||d.innerText))d.parentNode.removeChild(d);else{var f=d.ownerDocument.createRange();f.selectNodeContents(d);f.collapse(!1);b.setSelection(f)}if(d=b.caretIsBeforeUneditable())if(a.preventDefault(),a=b.getPreviousNode(d,!0),f=b.getSelectedNode(),1!==f.nodeType&&f.parentNode!==k&&(f=f.parentNode),a)if(1==f.nodeType){var g=f.firstChild;if(1==a.nodeType)for(;f.firstChild;)a.appendChild(f.firstChild);
else for(;f.firstChild;)d.parentNode.insertBefore(f.firstChild,d);f.parentNode&&f.parentNode.removeChild(f);b.setBefore(g)}else 1==a.nodeType?a.appendChild(f):d.parentNode.insertBefore(f,d),b.setBefore(f)}else b.containsUneditable()&&(a.preventDefault(),b.deleteContents());else if(e.config.handleTabKey&&9===b)a:{if(a.preventDefault(),!e.selection.isCollapsed())e.selection.deleteContents();else if(e.selection.caretIsInTheBeginnig("LI")&&e.commands.exec("indentList"))break a;e.commands.exec("insertHTML",
"&emsp;")}});d.observe(k,"keydown",function(a){var d=e.selection.getSelectedNode(!0),f=a.keyCode;!d||"IMG"!==d.nodeName||f!==b.BACKSPACE_KEY&&f!==b.DELETE_KEY||(f=d.parentNode,f.removeChild(d),"A"!==f.nodeName||f.firstChild||f.parentNode.removeChild(f),setTimeout(function(){b.quirks.redraw(k)},0),a.preventDefault())});!this.config.contentEditableMode&&f.hasIframeFocusIssue()&&(d.observe(g,"focus",function(){setTimeout(function(){e.doc.querySelector(":focus")!==e.element&&e.focus()},0)}),d.observe(this.element,
"blur",function(){setTimeout(function(){e.selection.getSelection().removeAllRanges()},0)}));var m={IMG:"Image: ",A:"Link: "};d.observe(k,"mouseover",function(a){a=a.target;var b=a.nodeName;"A"!==b&&"IMG"!==b||a.hasAttribute("title")||(b=m[b]+(a.getAttribute("href")||a.getAttribute("src")),a.setAttribute("title",b))})}})(wysihtml5);
(function(b){b.views.Synchronizer=Base.extend({constructor:function(b,f,h){this.editor=b;this.textarea=f;this.composer=h;this._observe()},fromComposerToTextarea:function(d){this.textarea.setValue(b.lang.string(this.composer.getValue(!1,!1)).trim(),d)},fromTextareaToComposer:function(b){var f=this.textarea.getValue(!1,!1);f?this.composer.setValue(f,b):(this.composer.clear(),this.editor.fire("set_placeholder"))},sync:function(b){"textarea"===this.editor.currentView.name?this.fromTextareaToComposer(b):
this.fromComposerToTextarea(b)},_observe:function(){var d,f=this,h=this.textarea.element.form,e=function(){d=setInterval(function(){f.fromComposerToTextarea()},400)},a=function(){clearInterval(d);d=null};e();h&&(b.dom.observe(h,"submit",function(){f.sync(!0)}),b.dom.observe(h,"reset",function(){setTimeout(function(){f.fromTextareaToComposer()},0)}));this.editor.on("change_view",function(b){"composer"!==b||d?"textarea"===b&&(f.fromComposerToTextarea(!0),a()):(f.fromTextareaToComposer(!0),e())});this.editor.on("destroy:composer",
a)}})})(wysihtml5);
wysihtml5.views.Textarea=wysihtml5.views.View.extend({name:"textarea",constructor:function(b,d,f){this.base(b,d,f);this._observe()},clear:function(){this.element.value=""},getValue:function(b){var d=this.isEmpty()?"":this.element.value;!1!==b&&(d=this.parent.parse(d));return d},setValue:function(b,d){d&&(b=this.parent.parse(b));this.element.value=b},cleanUp:function(){var b=this.parent.parse(this.element.value);this.element.value=b},hasPlaceholderSet:function(){var b=wysihtml5.browser.supportsPlaceholderAttributeOn(this.element),d=
this.element.getAttribute("placeholder")||null,f=this.element.value;return b&&!f||f===d},isEmpty:function(){return!wysihtml5.lang.string(this.element.value).trim()||this.hasPlaceholderSet()},_observe:function(){var b=this.element,d=this.parent,f={focusin:"focus",focusout:"blur"},h=wysihtml5.browser.supportsEvent("focusin")?["focusin","focusout","change"]:["focus","blur","change"];d.on("beforeload",function(){wysihtml5.dom.observe(b,h,function(b){b=f[b.type]||b.type;d.fire(b).fire(b+":textarea")});
wysihtml5.dom.observe(b,["paste","drop"],function(){setTimeout(function(){d.fire("paste").fire("paste:textarea")},0)})})}});
(function(b){var d={name:void 0,style:!0,toolbar:void 0,showToolbarAfterInit:!0,autoLink:!0,handleTables:!0,handleTabKey:!0,parserRules:{tags:{br:{},span:{},div:{},p:{}},classes:{}},pasteParserRulesets:null,parser:b.dom.parse,composerClassName:"wysihtml5-editor",bodyClassName:"wysihtml5-supported",useLineBreaks:!0,stylesheets:[],placeholderText:void 0,supportTouchDevices:!0,cleanUp:!0,contentEditableMode:!1,uneditableContainerClassname:"wysihtml5-uneditable-container",copyedFromMarking:'<meta name="copied-from" content="wysihtml5">'};
b.Editor=b.lang.Dispatcher.extend({constructor:function(f,h){this.editableElement="string"===typeof f?document.getElementById(f):f;this.config=b.lang.object({}).merge(d).merge(h).get();this._isCompatible=b.browser.supported();"textarea"!=this.editableElement.nodeName.toLowerCase()&&(this.config.contentEditableMode=!0,this.config.noTextarea=!0);this.config.noTextarea||(this.currentView=this.textarea=new b.views.Textarea(this,this.editableElement,this.config));if(!this._isCompatible||!this.config.supportTouchDevices&&
b.browser.isTouchDevice()){var e=this;setTimeout(function(){e.fire("beforeload").fire("load")},0)}else b.dom.addClass(document.body,this.config.bodyClassName),this.currentView=this.composer=new b.views.Composer(this,this.editableElement,this.config),"function"===typeof this.config.parser&&this._initParser(),this.on("beforeload",this.handleBeforeLoad)},handleBeforeLoad:function(){this.config.noTextarea||(this.synchronizer=new b.views.Synchronizer(this,this.textarea,this.composer));this.config.toolbar&&
(this.toolbar=new b.toolbar.Toolbar(this,this.config.toolbar,this.config.showToolbarAfterInit))},isCompatible:function(){return this._isCompatible},clear:function(){this.currentView.clear();return this},getValue:function(b,d){return this.currentView.getValue(b,d)},setValue:function(b,d){this.fire("unset_placeholder");if(!b)return this.clear();this.currentView.setValue(b,d);return this},cleanUp:function(){this.currentView.cleanUp()},focus:function(b){this.currentView.focus(b);return this},disable:function(){this.currentView.disable();
return this},enable:function(){this.currentView.enable();return this},isEmpty:function(){return this.currentView.isEmpty()},hasPlaceholderSet:function(){return this.currentView.hasPlaceholderSet()},parse:function(d,h){var e=this.config.contentEditableMode?document:this.composer?this.composer.sandbox.getDocument():null,e=this.config.parser(d,{rules:this.config.parserRules,cleanUp:this.config.cleanUp,context:e,uneditableClass:this.config.uneditableContainerClassname,clearInternals:h});"object"===typeof d&&
b.quirks.redraw(d);return e},_initParser:function(){var d=this,h;if(b.browser.supportsModenPaste())this.on("paste:composer",function(e){e.preventDefault();(h=b.dom.getPastedHtml(e))&&d._cleanAndPaste(h)});else this.on("beforepaste:composer",function(e){e.preventDefault();b.dom.getPastedHtmlWithDiv(d.composer,function(a){a&&d._cleanAndPaste(a)})})},_cleanAndPaste:function(d){d=b.quirks.cleanPastedHTML(d,{referenceNode:this.composer.element,rules:this.config.pasteParserRulesets||[{set:this.config.parserRules}],
uneditableClass:this.config.uneditableContainerClassname});this.composer.selection.deleteContents();this.composer.selection.insertHTML(d)}})})(wysihtml5);
(function(b){var d=b.dom;b.toolbar.Dialog=b.lang.Dispatcher.extend({constructor:function(b,d){this.link=b;this.container=d},_observe:function(){if(!this._observed){var f=this,h=function(a){var b=f._serialize();b==f.elementToChange?f.fire("edit",b):f.fire("save",b);f.hide();a.preventDefault();a.stopPropagation()};d.observe(f.link,"click",function(){d.hasClass(f.link,"wysihtml5-command-dialog-opened")&&setTimeout(function(){f.hide()},0)});d.observe(this.container,"keydown",function(a){var d=a.keyCode;
d===b.ENTER_KEY&&h(a);d===b.ESCAPE_KEY&&(f.fire("cancel"),f.hide())});d.delegate(this.container,"[data-wysihtml5-dialog-action=save]","click",h);d.delegate(this.container,"[data-wysihtml5-dialog-action=cancel]","click",function(a){f.fire("cancel");f.hide();a.preventDefault();a.stopPropagation()});for(var e=this.container.querySelectorAll("input, select, textarea"),a=0,g=e.length,k=function(){clearInterval(f.interval)};a<g;a++)d.observe(e[a],"change",k);this._observed=!0}},_serialize:function(){for(var b=
this.elementToChange||{},d=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),e=d.length,a=0;a<e;a++)b[d[a].getAttribute("data-wysihtml5-dialog-field")]=d[a].value;return b},_interpolate:function(b){for(var d,e,a=document.querySelector(":focus"),g=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),k=g.length,l=0;l<k;l++)d=g[l],d===a||b&&"hidden"===d.type||(e=d.getAttribute("data-wysihtml5-dialog-field"),e=this.elementToChange&&"boolean"!==typeof this.elementToChange?this.elementToChange.getAttribute(e)||
"":d.defaultValue,d.value=e)},show:function(b){if(!d.hasClass(this.link,"wysihtml5-command-dialog-opened")){var h=this,e=this.container.querySelector("input, select, textarea");this.elementToChange=b;this._observe();this._interpolate();b&&(this.interval=setInterval(function(){h._interpolate(!0)},500));d.addClass(this.link,"wysihtml5-command-dialog-opened");this.container.style.display="";this.fire("show");if(e&&!b)try{e.focus()}catch(a){}}},hide:function(){clearInterval(this.interval);this.elementToChange=
null;d.removeClass(this.link,"wysihtml5-command-dialog-opened");this.container.style.display="none";this.fire("hide")}})})(wysihtml5);
(function(b){var d=b.dom,f={position:"relative"},h={left:0,margin:0,opacity:0,overflow:"hidden",padding:0,position:"absolute",top:0,zIndex:1},e={cursor:"inherit",fontSize:"50px",height:"50px",marginTop:"-25px",outline:0,padding:0,position:"absolute",right:"-4px",top:"50%"},a={"x-webkit-speech":"",speech:""};b.toolbar.Speech=function(g,k){var l=document.createElement("input");if(b.browser.supportsSpeechApiOn(l)){var q=g.editor.textarea.element.getAttribute("lang");q&&(a.lang=q);q=document.createElement("div");
b.lang.object(h).merge({width:k.offsetWidth+"px",height:k.offsetHeight+"px"});d.insert(l).into(q);d.insert(q).into(k);d.setStyles(e).on(l);d.setAttributes(a).on(l);d.setStyles(h).on(q);d.setStyles(f).on(k);d.observe(l,"onwebkitspeechchange"in l?"webkitspeechchange":"speechchange",function(){g.execCommand("insertText",l.value);l.value=""});d.observe(l,"click",function(a){d.hasClass(k,"wysihtml5-command-disabled")&&a.preventDefault();a.stopPropagation()})}else k.style.display="none"}})(wysihtml5);
(function(b){var d="wysihtml5-command-disabled",f="wysihtml5-commands-disabled",h="wysihtml5-command-active",e="wysihtml5-action-active",a=b.dom;b.toolbar.Toolbar=Base.extend({constructor:function(a,k,l){this.editor=a;this.container="string"===typeof k?document.getElementById(k):k;this.composer=a.composer;this._getLinks("command");this._getLinks("action");this._observe();l&&this.show();null!=a.config.classNameCommandDisabled&&(d=a.config.classNameCommandDisabled);null!=a.config.classNameCommandsDisabled&&
(f=a.config.classNameCommandsDisabled);null!=a.config.classNameCommandActive&&(h=a.config.classNameCommandActive);null!=a.config.classNameActionActive&&(e=a.config.classNameActionActive);a=this.container.querySelectorAll("[data-wysihtml5-command=insertSpeech]");k=a.length;for(l=0;l<k;l++)new b.toolbar.Speech(this,a[l])},_getLinks:function(a){for(var d=this[a+"Links"]=b.lang.array(this.container.querySelectorAll("[data-wysihtml5-"+a+"]")).get(),e=d.length,f=0,h=this[a+"Mapping"]={},p,n,r,s,u;f<e;f++)p=
d[f],r=p.getAttribute("data-wysihtml5-"+a),s=p.getAttribute("data-wysihtml5-"+a+"-value"),n=this.container.querySelector("[data-wysihtml5-"+a+"-group='"+r+"']"),u=this._getDialog(p,r),h[r+":"+s]={link:p,group:n,name:r,value:s,dialog:u,state:!1}},_getDialog:function(a,d){var e=this,f=this.container.querySelector("[data-wysihtml5-dialog='"+d+"']"),h,p;f&&(h=b.toolbar["Dialog_"+d]?new b.toolbar["Dialog_"+d](a,f):new b.toolbar.Dialog(a,f),h.on("show",function(){p=e.composer.selection.getBookmark();e.editor.fire("show:dialog",
{command:d,dialogContainer:f,commandLink:a})}),h.on("save",function(b){p&&e.composer.selection.setBookmark(p);e._execCommand(d,b);e.editor.fire("save:dialog",{command:d,dialogContainer:f,commandLink:a})}),h.on("cancel",function(){e.editor.focus(!1);e.editor.fire("cancel:dialog",{command:d,dialogContainer:f,commandLink:a})}));return h},execCommand:function(a,b){if(!this.commandsDisabled){var d=this.commandMapping[a+":"+b];d&&d.dialog&&!d.state?d.dialog.show():this._execCommand(a,b)}},_execCommand:function(a,
b){this.editor.focus(!1);this.composer.commands.exec(a,b);this._updateLinkStates()},execAction:function(a){var b=this.editor;"change_view"===a&&b.textarea&&(b.currentView===b.textarea?b.fire("change_view","composer"):b.fire("change_view","textarea"));"showSource"==a&&b.fire("showSource")},_observe:function(){for(var b=this,d=this.editor,e=this.container,h=this.commandLinks.concat(this.actionLinks),m=h.length,p=0;p<m;p++)if("A"===h[p].nodeName)a.setAttributes({href:"javascript:;",unselectable:"on"}).on(h[p]);
else a.setAttributes({unselectable:"on"}).on(h[p]);a.delegate(e,"[data-wysihtml5-command], [data-wysihtml5-action]","mousedown",function(a){a.preventDefault()});a.delegate(e,"[data-wysihtml5-command]","click",function(a){var d=this.getAttribute("data-wysihtml5-command"),e=this.getAttribute("data-wysihtml5-command-value");b.execCommand(d,e);a.preventDefault()});a.delegate(e,"[data-wysihtml5-action]","click",function(a){var d=this.getAttribute("data-wysihtml5-action");b.execAction(d);a.preventDefault()});
d.on("interaction:composer",function(){b._updateLinkStates()});d.on("focus:composer",function(){b.bookmark=null});this.editor.config.handleTables&&(d.on("tableselect:composer",function(){b.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display=""}),d.on("tableunselect:composer",function(){b.container.querySelectorAll('[data-wysihtml5-hiddentools="table"]')[0].style.display="none"}));d.on("change_view",function(h){d.textarea&&setTimeout(function(){b.commandsDisabled="composer"!==
h;b._updateLinkStates();b.commandsDisabled?a.addClass(e,f):a.removeClass(e,f)},0)})},_updateLinkStates:function(){var f=this.commandMapping,k=this.actionMapping,l,q,m;for(l in f)m=f[l],this.commandsDisabled?(q=!1,a.removeClass(m.link,h),m.group&&a.removeClass(m.group,h),m.dialog&&m.dialog.hide()):(q=this.composer.commands.state(m.name,m.value),a.removeClass(m.link,d),m.group&&a.removeClass(m.group,d)),m.state!==q&&((m.state=q)?(a.addClass(m.link,h),m.group&&a.addClass(m.group,h),m.dialog&&("object"===
typeof q||b.lang.object(q).isArray()?(!m.dialog.multiselect&&b.lang.object(q).isArray()&&(q=1===q.length?q[0]:!0,m.state=q),m.dialog.show(q)):m.dialog.hide())):(a.removeClass(m.link,h),m.group&&a.removeClass(m.group,h),m.dialog&&m.dialog.hide()));for(l in k)f=k[l],"change_view"===f.name&&(f.state=this.editor.currentView===this.editor.textarea,f.state?a.addClass(f.link,e):a.removeClass(f.link,e))},show:function(){this.container.style.display=""},hide:function(){this.container.style.display="none"}})})(wysihtml5);
(function(b){b.toolbar.Dialog_createTable=b.toolbar.Dialog.extend({show:function(b){this.base(b)}})})(wysihtml5);
(function(b){b.toolbar.Dialog_foreColorStyle=b.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){for(var b={},f=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),h=f.length,e=0;e<h;e++)b[f[e].getAttribute("data-wysihtml5-dialog-field")]=f[e].value;return b},_interpolate:function(d){for(var f,h=document.querySelector(":focus"),e=this.container.querySelectorAll("[data-wysihtml5-dialog-field]"),a=e.length,g=0,k=(f=(f=this.elementToChange?b.lang.object(this.elementToChange).isArray()?
this.elementToChange[0]:this.elementToChange:null)?f.getAttribute("style"):null)?b.quirks.styleParser.parseColor(f,"color"):null;g<a;g++)f=e[g],f===h||d&&"hidden"===f.type||"color"!==f.getAttribute("data-wysihtml5-dialog-field")||(f.value=k?k[3]&&1!=k[3]?"rgba("+k[0]+","+k[1]+","+k[2]+","+k[3]+");":"rgb("+k[0]+","+k[1]+","+k[2]+");":"rgb(0,0,0);")}})})(wysihtml5);
(function(b){b.toolbar.Dialog_fontSizeStyle=b.toolbar.Dialog.extend({multiselect:!0,_serialize:function(){return{size:this.container.querySelector('[data-wysihtml5-dialog-field="size"]').value}},_interpolate:function(d){d=document.querySelector(":focus");var f=this.container.querySelector("[data-wysihtml5-dialog-field='size']"),h=this.elementToChange?b.lang.object(this.elementToChange).isArray()?this.elementToChange[0]:this.elementToChange:null,h=(h=h?h.getAttribute("style"):null)?b.quirks.styleParser.parseFontSize(h):
null;f&&f!==d&&h&&!/^\s*$/.test(h)&&(f.value=h)}})})(wysihtml5);
var Handlebars=function(){var b=function(){function a(a){this.string=a}return a.prototype.toString=function(){return""+this.string},a}(),d=function(a){function b(a){return e[a]||"&amp;"}var d={},e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},f=/[&<>"'`]/g,h=/[&<>"'`]/;d.extend=function(a,b){for(var d in b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d])};var p=Object.prototype.toString;d.toString=p;var n=function(a){return"function"==typeof a};n(/x/)&&(n=function(a){return"function"==
typeof a&&"[object Function]"===p.call(a)});d.isFunction=n;var r=Array.isArray||function(a){return a&&"object"==typeof a?"[object Array]"===p.call(a):!1};return d.isArray=r,d.escapeExpression=function(d){return d instanceof a?d.toString():d||0===d?(d=""+d,h.test(d)?d.replace(f,b):d):""},d.isEmpty=function(a){return a||0===a?r(a)&&0===a.length?!0:!1:!0},d}(b),f=function(){function a(a,d){var e;d&&d.firstLine&&(e=d.firstLine,a+=" - "+e+":"+d.firstColumn);for(var f=Error.prototype.constructor.call(this,
a),h=0;h<b.length;h++)this[b[h]]=f[b[h]];e&&(this.lineNumber=e,this.column=d.firstColumn)}var b="description fileName lineNumber message name number stack".split(" ");return a.prototype=Error(),a}(),h=function(a,b){function d(a,b){this.helpers=a||{};this.partials=b||{};e(this)}function e(a){a.registerHelper("helperMissing",function(a){if(2!==arguments.length)throw new n("Missing helper: '"+a+"'");});a.registerHelper("blockHelperMissing",function(b,d){var e=d.inverse||function(){},f=d.fn;return s(b)&&
(b=b.call(this)),!0===b?f(this):!1===b||null==b?e(this):r(b)?0<b.length?a.helpers.each(b,d):e(this):f(b)});a.registerHelper("each",function(a,b){var d,e=b.fn,f=b.inverse,g=0,h="";if(s(a)&&(a=a.call(this)),b.data&&(d=x(b.data)),a&&"object"==typeof a)if(r(a))for(var k=a.length;k>g;g++)d&&(d.index=g,d.first=0===g,d.last=g===a.length-1),h+=e(a[g],{data:d});else for(k in a)a.hasOwnProperty(k)&&(d&&(d.key=k,d.index=g,d.first=0===g),h+=e(a[k],{data:d}),g++);return 0===g&&(h=f(this)),h});a.registerHelper("if",
function(a,b){return s(a)&&(a=a.call(this)),!b.hash.includeZero&&!a||p.isEmpty(a)?b.inverse(this):b.fn(this)});a.registerHelper("unless",function(b,d){return a.helpers["if"].call(this,b,{fn:d.inverse,inverse:d.fn,hash:d.hash})});a.registerHelper("with",function(a,b){return s(a)&&(a=a.call(this)),p.isEmpty(a)?void 0:b.fn(a)});a.registerHelper("log",function(b,d){var e=d.data&&null!=d.data.level?parseInt(d.data.level,10):1;a.log(e,b)})}function f(a,b){t.log(a,b)}var h={},p=a,n=b;h.VERSION="1.3.0";h.COMPILER_REVISION=
4;h.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};var r=p.isArray,s=p.isFunction,u=p.toString;h.HandlebarsEnvironment=d;d.prototype={constructor:d,logger:t,log:f,registerHelper:function(a,b,d){if("[object Object]"===u.call(a)){if(d||b)throw new n("Arg not supported with multiple helpers");p.extend(this.helpers,a)}else d&&(b.not=d),this.helpers[a]=b},registerPartial:function(a,b){"[object Object]"===u.call(a)?p.extend(this.partials,a):this.partials[a]=b}};var t=
{methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(a,b){if(t.level<=a){var d=t.methodMap[a];"undefined"!=typeof console&&console[d]&&console[d].call(console,b)}}};h.logger=t;h.log=f;var x=function(a){var b={};return p.extend(b,a),b};return h.createFrame=x,h}(d,f),e=function(a,b,d){function e(a,b,d){var f=function(a,e){return e=e||{},b(a,e.data||d)};return f.program=a,f.depth=0,f}var f={},h=d.COMPILER_REVISION,p=d.REVISION_CHANGES;return f.checkRevision=
function(a){var d=a&&a[0]||1;if(d!==h){if(h>d)throw new b("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+p[h]+") or downgrade your runtime to an older version ("+p[d]+").");throw new b("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+a[1]+").");}},f.template=function(d,f){if(!f)throw new b("No environment passed to template");
var h={escapeExpression:a.escapeExpression,invokePartial:function(a,d,e,h,k,l){var m=f.VM.invokePartial.apply(this,arguments);if(null!=m)return m;if(f.compile)return m={helpers:h,partials:k,data:l},k[d]=f.compile(a,{data:void 0!==l},f),k[d](e,m);throw new b("The partial "+d+" could not be compiled when running in runtime-only mode");},programs:[],program:function(a,b,d){var f=this.programs[a];return d?f=e(a,b,d):f||(f=this.programs[a]=e(a,b)),f},merge:function(b,d){var e=b||d;return b&&d&&b!==d&&
(e={},a.extend(e,d),a.extend(e,b)),e},programWithDepth:f.VM.programWithDepth,noop:f.VM.noop,compilerInfo:null};return function(a,b){b=b||{};var e,g,k=b.partial?b:f;b.partial||(e=b.helpers,g=b.partials);e=d.call(h,k,a,e,g,b.data);return b.partial||f.VM.checkRevision(h.compilerInfo),e}},f.programWithDepth=function(a,b,d){var e=Array.prototype.slice.call(arguments,3),f=function(a,f){return f=f||{},b.apply(this,[a,f.data||d].concat(e))};return f.program=a,f.depth=e.length,f},f.program=e,f.invokePartial=
function(a,d,e,f,h,k){f={partial:!0,helpers:f,partials:h,data:k};if(void 0===a)throw new b("The partial "+d+" could not be found");return a instanceof Function?a(e,f):void 0},f.noop=function(){return""},f}(d,f,h);return function(a,b,d,e,f){var h=function(){var h=new a.HandlebarsEnvironment;return e.extend(h,a),h.SafeString=b,h.Exception=d,h.Utils=e,h.VM=f,h.template=function(a){return f.template(a,h)},h},p=h();return p.create=h,p}(h,b,f,d,e)}();this.wysihtml5=this.wysihtml5||{};
this.wysihtml5.tpl=this.wysihtml5.tpl||{};
this.wysihtml5.tpl.blockquote=Handlebars.template(function(b,d,f,h,e){this.compilerInfo=[4,">= 1.0.0"];f=this.merge(f,b.helpers);e=e||{};var a,g=this.escapeExpression;b='<li>\n  <a class="btn ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.size),{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){var d,e;return d="btn-"+g((e=(e=(e=a&&a.options,null==e||!1===e?e:e.toolbar),null==e||!1===e?e:e.size),"function"===typeof e?e.apply(a):e))},e),data:e}))||
0===a)b+=a;b+=' btn-default" data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="blockquote" data-wysihtml5-display-format-name="false" tabindex="-1">\n    ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.fa),{hash:{},inverse:this.program(5,function(a,b){return'\n      <span class="glyphicon glyphicon-quote"></span>\n    '},e),fn:this.program(3,function(a,b){return' \n      <span class="fa fa-quote-left"></span>\n    '},e),data:e}))||0===a)b+=
a;return b+"\n  </a>\n</li>\n"});
this.wysihtml5.tpl.color=Handlebars.template(function(b,d,f,h,e){this.compilerInfo=[4,">= 1.0.0"];f=this.merge(f,b.helpers);e=e||{};var a,g=this.escapeExpression;b='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.size),{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){var d,e;return d="btn-"+g((e=(e=(e=a&&a.options,null==e||!1===e?e:e.toolbar),null==e||!1===e?e:e.size),"function"===
typeof e?e.apply(a):e))},e),data:e}))||0===a)b+=a;return b+='" data-toggle="dropdown" tabindex="-1">\n    <span class="current-color">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.black),"function"===typeof a?a.apply(d):a))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="black"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="black">'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.black),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="silver"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="silver">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.silver),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="gray"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="gray">'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.gray),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="maroon"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="maroon">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.maroon),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="red"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="red">'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.red),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="purple"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="purple">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.purple),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="green"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="green">'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.green),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="olive"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="olive">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.olive),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="navy"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="navy">'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.navy),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="blue"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="blue">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.blue),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><div class="wysihtml5-colors" data-wysihtml5-command-value="orange"></div><a class="wysihtml5-colors-title" data-wysihtml5-command="foreColor" data-wysihtml5-command-value="orange">'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.colours),null==a||!1===a?a:a.orange),"function"===typeof a?a.apply(d):a))+"</a></li>\n  </ul>\n</li>\n"});
this.wysihtml5.tpl.emphasis=Handlebars.template(function(b,d,f,h,e){function a(a,b){var d,e;return d="btn-"+l((e=(e=(e=a&&a.options,null==e||!1===e?e:e.toolbar),null==e||!1===e?e:e.size),typeof e===k?e.apply(a):e))}this.compilerInfo=[4,">= 1.0.0"];f=this.merge(f,b.helpers);e=e||{};var g,k="function",l=this.escapeExpression,q=this;b='<li>\n  <div class="btn-group">\n    <a class="btn ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.size),{hash:{},inverse:q.noop,
fn:q.program(1,a,e),data:e}))||0===g)b+=g;b+=' btn-default" data-wysihtml5-command="bold" title="CTRL+B" tabindex="-1">'+l((g=(g=(g=d&&d.locale,null==g||!1===g?g:g.emphasis),null==g||!1===g?g:g.bold),typeof g===k?g.apply(d):g))+'</a>\n    <a class="btn ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.size),{hash:{},inverse:q.noop,fn:q.program(1,a,e),data:e}))||0===g)b+=g;b+=' btn-default" data-wysihtml5-command="italic" title="CTRL+I" tabindex="-1">'+l((g=
(g=(g=d&&d.locale,null==g||!1===g?g:g.emphasis),null==g||!1===g?g:g.italic),typeof g===k?g.apply(d):g))+'</a>\n    <a class="btn ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.size),{hash:{},inverse:q.noop,fn:q.program(1,a,e),data:e}))||0===g)b+=g;b+=' btn-default" data-wysihtml5-command="underline" title="CTRL+U" tabindex="-1">'+l((g=(g=(g=d&&d.locale,null==g||!1===g?g:g.emphasis),null==g||!1===g?g:g.underline),typeof g===k?g.apply(d):g))+"</a>\n    ";
if((g=f["if"].call(d,(g=(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.emphasis),null==g||!1===g?g:g.small),{hash:{},inverse:q.noop,fn:q.program(3,function(b,d){var e,g;e='\n    <a class="btn ';if((g=f["if"].call(b,(g=(g=b&&b.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.size),{hash:{},inverse:q.noop,fn:q.program(1,a,d),data:d}))||0===g)e+=g;return e+=' btn-default" data-wysihtml5-command="small" title="CTRL+S" tabindex="-1">'+l((g=(g=(g=b&&b.locale,null==g||!1===g?
g:g.emphasis),null==g||!1===g?g:g.small),typeof g===k?g.apply(b):g))+"</a>\n    "},e),data:e}))||0===g)b+=g;return b+"\n  </div>\n</li>\n"});
this.wysihtml5.tpl["font-styles"]=Handlebars.template(function(b,d,f,h,e){this.compilerInfo=[4,">= 1.0.0"];f=this.merge(f,b.helpers);e=e||{};var a,g=this.escapeExpression;b='<li class="dropdown">\n  <a class="btn btn-default dropdown-toggle ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.size),{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){var d,e;return d="btn-"+g((e=(e=(e=a&&a.options,null==e||!1===e?e:e.toolbar),null==e||!1===e?e:e.size),"function"===
typeof e?e.apply(a):e))},e),data:e}))||0===a)b+=a;b+='" data-toggle="dropdown">\n    ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.fa),{hash:{},inverse:this.program(5,function(a,b){return'\n      <span class="glyphicon glyphicon-font"></span>\n    '},e),fn:this.program(3,function(a,b){return'\n      <span class="fa fa-font"></span>\n    '},e),data:e}))||0===a)b+=a;return b+='\n    <span class="current-font">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.font_styles),
null==a||!1===a?a:a.normal),"function"===typeof a?a.apply(d):a))+'</span>\n    <b class="caret"></b>\n  </a>\n  <ul class="dropdown-menu">\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="p" tabindex="-1">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.font_styles),null==a||!1===a?a:a.normal),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h1" tabindex="-1">'+g((a=(a=(a=d&&d.locale,null==a||!1===
a?a:a.font_styles),null==a||!1===a?a:a.h1),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h2" tabindex="-1">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.font_styles),null==a||!1===a?a:a.h2),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h3" tabindex="-1">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.font_styles),null==a||!1===a?a:a.h3),"function"===
typeof a?a.apply(d):a))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h4" tabindex="-1">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.font_styles),null==a||!1===a?a:a.h4),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h5" tabindex="-1">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.font_styles),null==a||!1===a?a:a.h5),"function"===typeof a?a.apply(d):a))+'</a></li>\n    <li><a data-wysihtml5-command="formatBlock" data-wysihtml5-command-value="h6" tabindex="-1">'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.font_styles),null==a||!1===a?a:a.h6),"function"===typeof a?a.apply(d):a))+"</a></li>\n  </ul>\n</li>\n"});
this.wysihtml5.tpl.html=Handlebars.template(function(b,d,f,h,e){this.compilerInfo=[4,">= 1.0.0"];f=this.merge(f,b.helpers);e=e||{};var a,g=this.escapeExpression;b='<li>\n  <div class="btn-group">\n    <a class="btn ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.size),{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){var d,e;return d="btn-"+g((e=(e=(e=a&&a.options,null==e||!1===e?e:e.toolbar),null==e||!1===e?e:e.size),"function"===typeof e?e.apply(a):
e))},e),data:e}))||0===a)b+=a;b+=' btn-default" data-wysihtml5-action="change_view" title="'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.html),null==a||!1===a?a:a.edit),"function"===typeof a?a.apply(d):a))+'" tabindex="-1">\n      ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.fa),{hash:{},inverse:this.program(5,function(a,b){return'\n        <span class="glyphicon glyphicon-pencil"></span>\n      '},e),fn:this.program(3,function(a,b){return'\n        <span class="fa fa-pencil"></span>\n      '},
e),data:e}))||0===a)b+=a;return b+"\n    </a>\n  </div>\n</li>\n"});
this.wysihtml5.tpl.image=Handlebars.template(function(b,d,f,h,e){this.compilerInfo=[4,">= 1.0.0"];f=this.merge(f,b.helpers);e=e||{};var a,g=this.escapeExpression;b='<li>\n  <div class="bootstrap-wysihtml5-insert-image-modal modal fade" data-wysihtml5-dialog="insertImage">\n    <div class="modal-dialog ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.smallmodals),{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){return"modal-sm"},e),data:e}))||0===
a)b+=a;b+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.image),null==a||!1===a?a:a.insert),"function"===typeof a?a.apply(d):a))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-image-url form-control" data-wysihtml5-dialog-field="src">\n          </div> \n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.image),null==a||!1===a?a:a.cancel),"function"===typeof a?a.apply(d):a))+'</a>\n          <a class="btn btn-primary" data-dismiss="modal"  data-wysihtml5-dialog-action="save" href="#">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.image),null==a||!1===a?a:a.insert),"function"===typeof a?a.apply(d):a))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===
a?a:a.size),{hash:{},inverse:this.noop,fn:this.program(3,function(a,b){var d,e;return d="btn-"+g((e=(e=(e=a&&a.options,null==e||!1===e?e:e.toolbar),null==e||!1===e?e:e.size),"function"===typeof e?e.apply(a):e))},e),data:e}))||0===a)b+=a;b+=' btn-default" data-wysihtml5-command="insertImage" title="'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.image),null==a||!1===a?a:a.insert),"function"===typeof a?a.apply(d):a))+'" tabindex="-1">\n    ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),
null==a||!1===a?a:a.fa),{hash:{},inverse:this.program(7,function(a,b){return'\n      <span class="glyphicon glyphicon-picture"></span>\n    '},e),fn:this.program(5,function(a,b){return'\n      <span class="fa fa-file-image-o"></span>\n    '},e),data:e}))||0===a)b+=a;return b+"\n  </a>\n</li>\n"});
this.wysihtml5.tpl.link=Handlebars.template(function(b,d,f,h,e){this.compilerInfo=[4,">= 1.0.0"];f=this.merge(f,b.helpers);e=e||{};var a,g=this.escapeExpression;b='<li>\n  <div class="bootstrap-wysihtml5-insert-link-modal modal fade" data-wysihtml5-dialog="createLink">\n    <div class="modal-dialog ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.smallmodals),{hash:{},inverse:this.noop,fn:this.program(1,function(a,b){return"modal-sm"},e),data:e}))||0===a)b+=
a;b+='">\n      <div class="modal-content">\n        <div class="modal-header">\n          <a class="close" data-dismiss="modal">&times;</a>\n          <h3>'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.link),null==a||!1===a?a:a.insert),"function"===typeof a?a.apply(d):a))+'</h3>\n        </div>\n        <div class="modal-body">\n          <div class="form-group">\n            <input value="http://" class="bootstrap-wysihtml5-insert-link-url form-control" data-wysihtml5-dialog-field="href">\n          </div> \n          <div class="checkbox">\n            <label> \n              <input type="checkbox" class="bootstrap-wysihtml5-insert-link-target" checked>'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.link),null==a||!1===a?a:a.target),"function"===typeof a?a.apply(d):a))+'\n            </label>\n          </div>\n        </div>\n        <div class="modal-footer">\n          <a class="btn btn-default" data-dismiss="modal" data-wysihtml5-dialog-action="cancel" href="#">'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.link),null==a||!1===a?a:a.cancel),"function"===typeof a?a.apply(d):a))+'</a>\n          <a href="#" class="btn btn-primary" data-dismiss="modal" data-wysihtml5-dialog-action="save">'+
g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.link),null==a||!1===a?a:a.insert),"function"===typeof a?a.apply(d):a))+'</a>\n        </div>\n      </div>\n    </div>\n  </div>\n  <a class="btn ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.size),{hash:{},inverse:this.noop,fn:this.program(3,function(a,b){var d,e;return d="btn-"+g((e=(e=(e=a&&a.options,null==e||!1===e?e:e.toolbar),null==e||!1===e?e:e.size),"function"===typeof e?e.apply(a):e))},e),data:e}))||0===
a)b+=a;b+=' btn-default" data-wysihtml5-command="createLink" title="'+g((a=(a=(a=d&&d.locale,null==a||!1===a?a:a.link),null==a||!1===a?a:a.insert),"function"===typeof a?a.apply(d):a))+'" tabindex="-1">\n    ';if((a=f["if"].call(d,(a=(a=d&&d.options,null==a||!1===a?a:a.toolbar),null==a||!1===a?a:a.fa),{hash:{},inverse:this.program(7,function(a,b){return'\n      <span class="glyphicon glyphicon-share"></span>\n    '},e),fn:this.program(5,function(a,b){return'\n      <span class="fa fa-share-square-o"></span>\n    '},
e),data:e}))||0===a)b+=a;return b+"\n  </a>\n</li>\n"});
this.wysihtml5.tpl.lists=Handlebars.template(function(b,d,f,h,e){function a(a,b){var d,e;return d="btn-"+l((e=(e=(e=a&&a.options,null==e||!1===e?e:e.toolbar),null==e||!1===e?e:e.size),typeof e===k?e.apply(a):e))}this.compilerInfo=[4,">= 1.0.0"];f=this.merge(f,b.helpers);e=e||{};var g,k="function",l=this.escapeExpression;b='<li>\n  <div class="btn-group">\n    <a class="btn ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.size),{hash:{},inverse:this.noop,fn:this.program(1,
a,e),data:e}))||0===g)b+=g;b+=' btn-default" data-wysihtml5-command="insertUnorderedList" title="'+l((g=(g=(g=d&&d.locale,null==g||!1===g?g:g.lists),null==g||!1===g?g:g.unordered),typeof g===k?g.apply(d):g))+'" tabindex="-1">\n    ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.fa),{hash:{},inverse:this.program(5,function(a,b){return'\n      <span class="glyphicon glyphicon-list"></span>\n    '},e),fn:this.program(3,function(a,b){return'\n      <span class="fa fa-list-ul"></span>\n    '},
e),data:e}))||0===g)b+=g;b+='\n    </a>\n    <a class="btn ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.size),{hash:{},inverse:this.noop,fn:this.program(1,a,e),data:e}))||0===g)b+=g;b+=' btn-default" data-wysihtml5-command="insertOrderedList" title="'+l((g=(g=(g=d&&d.locale,null==g||!1===g?g:g.lists),null==g||!1===g?g:g.ordered),typeof g===k?g.apply(d):g))+'" tabindex="-1">\n    ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==
g||!1===g?g:g.fa),{hash:{},inverse:this.program(9,function(a,b){return'\n      <span class="glyphicon glyphicon-th-list"></span>\n    '},e),fn:this.program(7,function(a,b){return'\n      <span class="fa fa-list-ol"></span>\n    '},e),data:e}))||0===g)b+=g;b+='\n    </a>\n    <a class="btn ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.size),{hash:{},inverse:this.noop,fn:this.program(1,a,e),data:e}))||0===g)b+=g;b+=' btn-default" data-wysihtml5-command="Outdent" title="'+
l((g=(g=(g=d&&d.locale,null==g||!1===g?g:g.lists),null==g||!1===g?g:g.outdent),typeof g===k?g.apply(d):g))+'" tabindex="-1">\n    ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.fa),{hash:{},inverse:this.program(13,function(a,b){return'\n      <span class="glyphicon glyphicon-indent-right"></span>\n    '},e),fn:this.program(11,function(a,b){return'\n      <span class="fa fa-outdent"></span>\n    '},e),data:e}))||0===g)b+=g;b+='\n    </a>\n    <a class="btn ';
if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.size),{hash:{},inverse:this.noop,fn:this.program(1,a,e),data:e}))||0===g)b+=g;b+=' btn-default" data-wysihtml5-command="Indent" title="'+l((g=(g=(g=d&&d.locale,null==g||!1===g?g:g.lists),null==g||!1===g?g:g.indent),typeof g===k?g.apply(d):g))+'" tabindex="-1">\n    ';if((g=f["if"].call(d,(g=(g=d&&d.options,null==g||!1===g?g:g.toolbar),null==g||!1===g?g:g.fa),{hash:{},inverse:this.program(17,function(a,b){return'\n      <span class="glyphicon glyphicon-indent-left"></span>\n    '},
e),fn:this.program(15,function(a,b){return'\n      <span class="fa fa-indent"></span>\n    '},e),data:e}))||0===g)b+=g;return b+"\n    </a>\n  </div>\n</li>\n"});
(function(b){"function"===typeof define&&define.amd?define("bootstrap.wysihtml5",["jquery","wysihtml5","bootstrap","bootstrap.wysihtml5.templates","bootstrap.wysihtml5.commands"],b):b(jQuery,wysihtml5)})(function(b,d){(function(b,d){var e=function(a,b,e){if(d.tpl[a])return d.tpl[a]({locale:b,options:e})},a=function(a,e){this.el=a;var g=b.extend(!0,{},k,e),l;for(l in g.customTemplates)g.customTemplates.hasOwnProperty(l)&&(d.tpl[l]=g.customTemplates[l]);this.toolbar=this.createToolbar(a,g);this.editor=
this.createEditor(g)};a.prototype={constructor:a,createEditor:function(a){a=a||{};a=b.extend(!0,{},a);a.toolbar=this.toolbar[0];this.initializeEditor(this.el[0],a)},initializeEditor:function(a,b){var e=new d.Editor(this.el[0],b);e.on("beforeload",this.syncBootstrapDialogEvents);e.on("beforeload",this.loadParserRules);e.composer.editableArea.contentDocument?this.addMoreShortcuts(e,e.composer.editableArea.contentDocument.body||e.composer.editableArea.contentDocument,b.shortcuts):this.addMoreShortcuts(e,
e.composer.editableArea,b.shortcuts);if(b&&b.events)for(var f in b.events)if(b.events.hasOwnProperty(f))e.on(f,b.events[f]);return e},loadParserRules:function(){"string"===b.type(this.config.parserRules)&&b.ajax({dataType:"json",url:this.config.parserRules,context:this,error:function(a,b,d){console.log(d)},success:function(a){this.config.parserRules=a;console.log("parserrules loaded")}});this.config.pasteParserRulesets&&"string"===b.type(this.config.pasteParserRulesets)&&b.ajax({dataType:"json",url:this.config.pasteParserRulesets,
context:this,error:function(a,b,d){console.log(d)},success:function(a){this.config.pasteParserRulesets=a}})},syncBootstrapDialogEvents:function(){var a=this;b.map(this.toolbar.commandMapping,function(a){return[a]}).filter(function(a){return a.dialog}).map(function(a){return a.dialog}).forEach(function(d){d.on("show",function(){b(this.container).modal("show")});d.on("hide",function(){b(this.container).modal("hide");setTimeout(a.composer.focus,0)});b(d.container).on("shown.bs.modal",function(){b(this).find("input, select, textarea").first().focus()})});
this.on("change_view",function(){b(this.toolbar.container.children).find("a.btn").not('[data-wysihtml5-action="change_view"]').toggleClass("disabled")})},createToolbar:function(a,d){var g=this,h=b("<ul/>",{"class":"wysihtml5-toolbar",style:"display:none"}),r=d.locale||k.locale||"en";l.hasOwnProperty(r)||(console.debug("Locale '"+r+"' not found. Available locales are: "+Object.keys(l)+". Falling back to 'en'."),r="en");var r=b.extend(!0,{},l.en,l[r]),s;for(s in d.toolbar)d.toolbar[s]&&h.append(e(s,
r,d));h.find('a[data-wysihtml5-command="formatBlock"]').click(function(a){var d=b(a.delegateTarget||a.target||a.srcElement);a=d.data("wysihtml5-display-format-name");d=d.data("wysihtml5-format-name")||d.html();void 0!==a&&"true"!==a||g.toolbar.find(".current-font").text(d)});h.find('a[data-wysihtml5-command="foreColor"]').click(function(a){a=b(a.target||a.srcElement);g.toolbar.find(".current-color").text(a.html())});this.el.before(h);return h},addMoreShortcuts:function(a,b,e){d.dom.observe(b,"keydown",
function(b){var f=e[b.keyCode];if((b.ctrlKey||b.metaKey||b.altKey)&&f&&d.commands[f]){var g=a.toolbar.commandMapping[f+":null"];g&&g.dialog&&!g.state?g.dialog.show():d.commands[f].exec(a.composer,f);b.preventDefault()}})}};var g={resetDefaults:function(){b.fn.wysihtml5.defaultOptions=b.extend(!0,{},b.fn.wysihtml5.defaultOptionsCache)},bypassDefaults:function(d){return this.each(function(){var e=b(this);e.data("wysihtml5",new a(e,d))})},shallowExtend:function(a){a=b.extend({},b.fn.wysihtml5.defaultOptions,
a||{},b(this).data());return g.bypassDefaults.apply(this,[a])},deepExtend:function(a){a=b.extend(!0,{},b.fn.wysihtml5.defaultOptions,a||{});return g.bypassDefaults.apply(this,[a])},init:function(a){return g.shallowExtend.apply(this,[a])}};b.fn.wysihtml5=function(a){if(g[a])return g[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)b.error("Method "+a+" does not exist on jQuery.wysihtml5");else return g.init.apply(this,arguments)};b.fn.wysihtml5.Constructor=a;var k=b.fn.wysihtml5.defaultOptions=
{toolbar:{"font-styles":!0,color:!1,emphasis:{small:!0},blockquote:!0,lists:!0,html:!1,link:!0,image:!0,smallmodals:!1},useLineBreaks:!1,parserRules:{classes:{"wysiwyg-color-silver":1,"wysiwyg-color-gray":1,"wysiwyg-color-white":1,"wysiwyg-color-maroon":1,"wysiwyg-color-red":1,"wysiwyg-color-purple":1,"wysiwyg-color-fuchsia":1,"wysiwyg-color-green":1,"wysiwyg-color-lime":1,"wysiwyg-color-olive":1,"wysiwyg-color-yellow":1,"wysiwyg-color-navy":1,"wysiwyg-color-blue":1,"wysiwyg-color-teal":1,"wysiwyg-color-aqua":1,
"wysiwyg-color-orange":1},tags:{b:{},i:{},strong:{},em:{},p:{},br:{},ol:{},ul:{},li:{},h1:{},h2:{},h3:{},h4:{},h5:{},h6:{},blockquote:{},u:1,img:{check_attributes:{width:"numbers",alt:"alt",src:"url",height:"numbers"}},a:{check_attributes:{href:"url"},set_attributes:{target:"_blank",rel:"nofollow"}},span:1,div:1,small:1,code:1,pre:1}},locale:"en",shortcuts:{83:"small",75:"createLink"}};"undefined"===typeof b.fn.wysihtml5.defaultOptionsCache&&(b.fn.wysihtml5.defaultOptionsCache=b.extend(!0,{},b.fn.wysihtml5.defaultOptions));
var l=b.fn.wysihtml5.locale={}})(b,d)});(function(b){b.commands.small={exec:function(d,f){return b.commands.formatInline.exec(d,f,"small")},state:function(d,f){return b.commands.formatInline.state(d,f,"small")}}})(wysihtml5);
(function(b){"function"===typeof define&&define.amd?define("bootstrap.wysihtml5.en-US",["jquery","bootstrap.wysihtml5"],b):b(jQuery)})(function(b){b.fn.wysihtml5.locale.en=b.fn.wysihtml5.locale["en-US"]={font_styles:{normal:"Normal text",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6"},emphasis:{bold:"Bold",italic:"Italic",underline:"Underline",small:"Small"},lists:{unordered:"Unordered list",ordered:"Ordered list",outdent:"Outdent",indent:"Indent"},link:{insert:"Insert link",
cancel:"Cancel",target:"Open link in new window"},image:{insert:"Insert image",cancel:"Cancel"},html:{edit:"Edit HTML"},colours:{black:"Black",silver:"Silver",gray:"Grey",maroon:"Maroon",red:"Red",purple:"Purple",green:"Green",olive:"Olive",navy:"Navy",blue:"Blue",orange:"Orange"}}});
