var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(l,e,k){if(k.get||k.set)throw new TypeError("ES3 does not support getters and setters.");l!=Array.prototype&&l!=Object.prototype&&(l[e]=k.value)};$jscomp.getGlobal=function(l){return"undefined"!=typeof window&&window===l?l:"undefined"!=typeof global&&null!=global?global:l};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(l){return $jscomp.SYMBOL_PREFIX+(l||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var l=$jscomp.global.Symbol.iterator;l||(l=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[l]&&$jscomp.defineProperty(Array.prototype,l,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(l){var e=0;return $jscomp.iteratorPrototype(function(){return e<l.length?{done:!1,value:l[e++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(l){$jscomp.initSymbolIterator();l={next:l};l[$jscomp.global.Symbol.iterator]=function(){return this};return l};$jscomp.array=$jscomp.array||{};$jscomp.iteratorFromArray=function(l,e){$jscomp.initSymbolIterator();l instanceof String&&(l+="");var k=0,f={next:function(){if(k<l.length){var v=k++;return{value:e(v,l[v]),done:!1}}f.next=function(){return{done:!0,value:void 0}};return f.next()}};f[Symbol.iterator]=function(){return f};return f};
$jscomp.polyfill=function(l,e,k,f){if(e){k=$jscomp.global;l=l.split(".");for(f=0;f<l.length-1;f++){var v=l[f];v in k||(k[v]={});k=k[v]}l=l[l.length-1];f=k[l];e=e(f);e!=f&&null!=e&&$jscomp.defineProperty(k,l,{configurable:!0,writable:!0,value:e})}};$jscomp.polyfill("Array.prototype.values",function(l){return l?l:function(){return $jscomp.iteratorFromArray(this,function(e,k){return k})}},"es6","es3");
$jscomp.polyfill("Array.prototype.fill",function(l){return l?l:function(e,k,f){var l=this.length||0;0>k&&(k=Math.max(0,l+k));if(null==f||f>l)f=l;f=Number(f);0>f&&(f=Math.max(0,l+f));for(k=Number(k||0);k<f;k++)this[k]=e;return this}},"es6-impl","es3");
(function(l,e,k){(function(f){"function"===typeof define&&define.amd?define(["jquery"],f):jQuery&&!jQuery.fn.sparkline&&f(jQuery)})(function(f){var v={},q,D,H,J,G,K,S,T,L,U,V,W,I,X,Y,E,M,Z,aa,ba,N,O,P,ca,Q,R,B,da=0;q=function(){var a,b;a=function(){this.init.apply(this,arguments)};1<arguments.length?(arguments[0]?(a.prototype=f.extend(new arguments[0],arguments[arguments.length-1]),a._super=arguments[0].prototype):a.prototype=arguments[arguments.length-1],2<arguments.length&&(b=Array.prototype.slice.call(arguments,
1,-1),b.unshift(a.prototype),f.extend.apply(f,b))):a.prototype=arguments[0];return a.prototype.cls=a};f.SPFormatClass=D=q({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(a,b){this.format=a;this.fclass=b},render:function(a,b,c){var d=this,g,h,f,e,n;return this.format.replace(this.fre,function(z,ea,l,u){h=ea;f=u;(g=d.precre.exec(h))?(n=g[2],h=g[1]):n=!1;e=a[h];if(e===k)return"";if(f&&b&&b[f])return z=b[f],z.get?b[f].get(e)||e:b[f][e]||e;T(e)&&(e=c.get("numberFormatter")?c.get("numberFormatter")(e):
W(e,n,c.get("numberDigitGroupCount"),c.get("numberDigitGroupSep"),c.get("numberDecimalMark")));return e})}});f.spformat=function(a,b){return new D(a,b)};H=function(a,b,c){return a<b?b:a>c?c:a};J=function(a,b){var c;if(2===b)return c=e.floor(a.length/2),a.length%2?a[c]:(a[c-1]+a[c])/2;c=a.length%2?(a.length*b+b)/4:(a.length*b+2)/4;return c%1?(a[e.floor(c)]+a[e.floor(c)-1])/2:a[c-1]};G=function(a){var b;switch(a){case "undefined":a=k;break;case "null":a=null;break;case "true":a=!0;break;case "false":a=
!1;break;default:b=parseFloat(a),a==b&&(a=b)}return a};K=function(a){var b,c=[];for(b=a.length;b--;)c[b]=G(a[b]);return c};S=function(a,b){var c,d,g=[];c=0;for(d=a.length;c<d;c++)a[c]!==b&&g.push(a[c]);return g};T=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};W=function(a,b,c,d,g){var h;a=(!1===b?parseFloat(a).toString():a.toFixed(b)).split("");h=0>(h=f.inArray(".",a))?a.length:h;h<a.length&&(a[h]=g);for(b=h-c;0<b;b-=c)a.splice(b,0,d);return a.join("")};L=function(a,b,c){var d;for(d=b.length;d--;)if((!c||
null!==b[d])&&b[d]!==a)return!1;return!0};V=function(a){return f.isArray(a)?a:[a]};U=function(a){var b;l.createStyleSheet?l.createStyleSheet().cssText=a:(b=l.createElement("style"),b.type="text/css",l.getElementsByTagName("head")[0].appendChild(b),b["string"==typeof l.body.style.WebkitAppearance?"innerText":"innerHTML"]=a)};f.fn.simpledraw=function(a,b,c,d){var g;if(c&&(g=this.data("_jqs_vcanvas")))return g;if(!1===f.fn.sparkline.canvas)return!1;if(f.fn.sparkline.canvas===k)if(g=l.createElement("canvas"),
g.getContext&&g.getContext("2d"))f.fn.sparkline.canvas=function(a,b,c,d){return new Q(a,b,c,d)};else if(l.namespaces&&!l.namespaces.v)l.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),f.fn.sparkline.canvas=function(a,b,c,d){return new R(a,b,c)};else return f.fn.sparkline.canvas=!1;a===k&&(a=f(this).innerWidth());b===k&&(b=f(this).innerHeight());g=f.fn.sparkline.canvas(a,b,this,d);(a=f(this).data("_jqs_mhandler"))&&a.registerCanvas(g);return g};f.fn.cleardraw=function(){var a=this.data("_jqs_vcanvas");
a&&a.reset()};f.RangeMapClass=I=q({init:function(a){var b,c,d=[];for(b in a)a.hasOwnProperty(b)&&"string"===typeof b&&-1<b.indexOf(":")&&(c=b.split(":"),c[0]=0===c[0].length?-Infinity:parseFloat(c[0]),c[1]=0===c[1].length?Infinity:parseFloat(c[1]),c[2]=a[b],d.push(c));this.map=a;this.rangelist=d||!1},get:function(a){var b=this.rangelist,c,d;if((c=this.map[a])!==k)return c;if(b)for(c=b.length;c--;)if(d=b[c],d[0]<=a&&d[1]>=a)return d[2];return k}});f.range_map=function(a){return new I(a)};X=q({init:function(a,
b){this.$el=f(a);this.options=b;this.currentPageY=this.currentPageX=0;this.el=a;this.splist=[];this.tooltip=null;this.over=!1;this.displayTooltips=!b.get("disableTooltips");this.highlightEnabled=!b.get("disableHighlight")},registerSparkline:function(a){this.splist.push(a);this.over&&this.updateDisplay()},registerCanvas:function(a){var b=f(a.canvas);this.canvas=a;this.$canvas=b;b.mouseenter(f.proxy(this.mouseenter,this));b.mouseleave(f.proxy(this.mouseleave,this));b.click(f.proxy(this.mouseclick,this))},
reset:function(a){this.splist=[];this.tooltip&&a&&(this.tooltip.remove(),this.tooltip=k)},mouseclick:function(a){var b=f.Event("sparklineClick");b.originalEvent=a;b.sparklines=this.splist;this.$el.trigger(b)},mouseenter:function(a){f(l.body).unbind("mousemove.jqs");f(l.body).bind("mousemove.jqs",f.proxy(this.mousemove,this));this.over=!0;this.currentPageX=a.pageX;this.currentPageY=a.pageY;this.currentEl=a.target;!this.tooltip&&this.displayTooltips&&(this.tooltip=new Y(this.options),this.tooltip.updatePosition(a.pageX,
a.pageY));this.updateDisplay()},mouseleave:function(){f(l.body).unbind("mousemove.jqs");var a=this.splist,b=a.length,c=!1,d,g;this.over=!1;this.currentEl=null;this.tooltip&&(this.tooltip.remove(),this.tooltip=null);for(g=0;g<b;g++)d=a[g],d.clearRegionHighlight()&&(c=!0);c&&this.canvas.render()},mousemove:function(a){this.currentPageX=a.pageX;this.currentPageY=a.pageY;this.currentEl=a.target;this.tooltip&&this.tooltip.updatePosition(a.pageX,a.pageY);this.updateDisplay()},updateDisplay:function(){var a=
this.splist,b=a.length,c=!1,d=this.$canvas.offset(),g=this.currentPageX-d.left,h=this.currentPageY-d.top,e,k;if(this.over){for(e=0;e<b;e++)d=a[e],(k=d.setRegionHighlight(this.currentEl,g,h))&&(c=!0);if(c){c=f.Event("sparklineRegionChange");c.sparklines=this.splist;this.$el.trigger(c);if(this.tooltip){c="";for(e=0;e<b;e++)d=a[e],c+=d.getCurrentRegionTooltip();this.tooltip.setContent(c)}this.disableHighlight||this.canvas.render()}null===k&&this.mouseleave()}}});Y=q({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",
init:function(a){var b=a.get("tooltipClassname","jqstooltip"),c=this.sizeStyle;this.container=a.get("tooltipContainer")||l.body;this.tooltipOffsetX=a.get("tooltipOffsetX",10);this.tooltipOffsetY=a.get("tooltipOffsetY",12);f("#jqssizetip").remove();f("#jqstooltip").remove();this.sizetip=f("<div/>",{id:"jqssizetip",style:c,"class":b});this.tooltip=f("<div/>",{id:"jqstooltip","class":b}).appendTo(this.container);a=this.tooltip.offset();this.offsetLeft=a.left;this.offsetTop=a.top;this.hidden=!0;f(window).unbind("resize.jqs scroll.jqs");
f(window).bind("resize.jqs scroll.jqs",f.proxy(this.updateWindowDims,this));this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=f(window).scrollTop();this.scrollLeft=f(window).scrollLeft();this.scrollRight=this.scrollLeft+f(window).width();this.updatePosition()},getSize:function(a){this.sizetip.html(a).appendTo(this.container);this.width=this.sizetip.width()+1;this.height=this.sizetip.height();this.sizetip.remove()},setContent:function(a){a?(this.getSize(a),this.tooltip.html(a).css({width:this.width,
height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())):(this.tooltip.css("visibility","hidden"),this.hidden=!0)},updatePosition:function(a,b){if(a===k){if(this.mousex===k)return;a=this.mousex-this.offsetLeft;b=this.mousey-this.offsetTop}else this.mousex=a-=this.offsetLeft,this.mousey=b-=this.offsetTop;this.height&&this.width&&!this.hidden&&(b-=this.height+this.tooltipOffsetY,a+=this.tooltipOffsetX,b<this.scrollTop&&(b=this.scrollTop),a<this.scrollLeft?a=this.scrollLeft:
a+this.width>this.scrollRight&&(a=this.scrollRight-this.width),this.tooltip.css({left:a,top:b}))},remove:function(){this.tooltip.remove();this.sizetip.remove();this.sizetip=this.tooltip=k;f(window).unbind("resize.jqs scroll.jqs")}});f(function(){U('.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}')});
B=[];f.fn.sparkline=function(a,b){return this.each(function(){var c=new f.fn.sparkline.options(this,b),d=f(this),g,h;g=function(){var b,g,h,e;if("html"===a||a===k){b=this.getAttribute(c.get("tagValuesAttribute"));if(b===k||null===b)b=d.html();b=b.replace(/(^\s*\x3c!--)|(--\x3e\s*$)|\s+/g,"").split(",")}else b=a;g="auto"===c.get("width")?b.length*c.get("defaultPixelsPerValue"):c.get("width");"auto"===c.get("height")?c.get("composite")&&f.data(this,"_jqs_vcanvas")||(e=l.createElement("span"),e.innerHTML=
"a",d.html(e),h=f(e).innerHeight()||f(e).height(),f(e).remove()):h=c.get("height");c.get("disableInteraction")?e=!1:(e=f.data(this,"_jqs_mhandler"))?c.get("composite")||e.reset():(e=new X(this,c),f.data(this,"_jqs_mhandler",e));c.get("composite")&&!f.data(this,"_jqs_vcanvas")?f.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),f.data(this,"_jqs_errnotify",!0)):(h=new (f.fn.sparkline[c.get("type")])(this,b,c,g,h),h.render(),e&&
e.registerSparkline(h))};if(f(this).html()&&!c.get("disableHiddenCheck")&&f(this).is(":hidden")||!f(this).parents("body").length){if(!c.get("composite")&&f.data(this,"_jqs_pending"))for(h=B.length;h;h--)B[h-1][0]==this&&B.splice(h-1,1);B.push([this,g]);f.data(this,"_jqs_pending",!0)}else g.call(this)})};f.fn.sparkline.defaults={common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",
enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:k,normalRangeMax:k,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:k,
chartRangeMax:k,chartRangeMinX:k,chartRangeMaxX:k,tooltipFormat:new D('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:"#3366cc #dc3912 #ff9900 #109618 #66aa00 #dd4477 #0099c6 #990099".split(" "),zeroColor:k,nullColor:k,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:k,chartRangeMin:k,chartRangeClip:!1,colorMap:k,tooltipFormat:new D('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},
tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new D('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:k,thresholdValue:0,chartRangeMax:k,chartRangeMin:k,chartRangeClip:!1,tooltipFormat:new D("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff",
"#7f94ff"],base:k,tooltipFormat:new D("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:"#3366cc #dc3912 #ff9900 #109618 #66aa00 #dd4477 #0099c6 #990099".split(" "),borderWidth:0,borderColor:"#000",tooltipFormat:new D('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",
showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:k,targetColor:"#4a2",chartRangeMax:k,chartRangeMin:k,tooltipFormat:new D("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}};f.sparkline_display_visible=function(){var a,b,c,d=[];b=0;for(c=B.length;b<c;b++)a=B[b][0],f(a).is(":visible")&&!f(a).parents().is(":hidden")?(B[b][1].call(a),
f.data(B[b][0],"_jqs_pending",!1),d.push(b)):f(a).closest("html").length||f.data(a,"_jqs_pending")||(f.data(B[b][0],"_jqs_pending",!1),d.push(b));for(b=d.length;b;b--)B.splice(d[b-1],1)};f.fn.sparkline.options=q({init:function(a,b){var c,d,g;this.userOptions=b=b||{};this.tag=a;this.tagValCache={};c=f.fn.sparkline.defaults;d=c.common;this.tagOptionsPrefix=b.enableTagOptions&&(b.tagOptionsPrefix||d.tagOptionsPrefix);g=this.getTagSetting("type");this.mergedOptions=f.extend({},d,g===v?c[b.type||d.type]:
c[g],b)},getTagSetting:function(a){var b=this.tagOptionsPrefix,c,d;if(!1===b||b===k)return v;if(this.tagValCache.hasOwnProperty(a))a=this.tagValCache.key;else{a=this.tag.getAttribute(b+a);if(a===k||null===a)a=v;else if("["===a.substr(0,1))for(a=a.substr(1,a.length-2).split(","),b=a.length;b--;)a[b]=G(a[b].replace(/(^\s*)|(\s*$)/g,""));else if("{"===a.substr(0,1))for(c=a.substr(1,a.length-2).split(","),a={},b=c.length;b--;)d=c[b].split(":",2),a[d[0].replace(/(^\s*)|(\s*$)/g,"")]=G(d[1].replace(/(^\s*)|(\s*$)/g,
""));else a=G(a);this.tagValCache.key=a}return a},get:function(a,b){var c=this.getTagSetting(a),d;return c!==v?c:(d=this.mergedOptions[a])===k?b:d}});f.fn.sparkline._base=q({disabled:!1,init:function(a,b,c,d,g){this.el=a;this.$el=f(a);this.values=b;this.options=c;this.width=d;this.height=g;this.currentRegion=k},initTarget:function(){var a=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),a))?(this.canvasWidth=this.target.pixelWidth,
this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(a,b){},setRegionHighlight:function(a,b,c){var d=this.currentRegion,g=!this.options.get("disableHighlight");if(b>this.canvasWidth||c>this.canvasHeight||0>b||0>c)return null;a=this.getRegion(a,b,c);return d!==a?(d!==k&&g&&this.removeHighlight(),this.currentRegion=a,a!==k&&g&&this.renderHighlight(),!0):!1},clearRegionHighlight:function(){return this.currentRegion!==
k?(this.removeHighlight(),this.currentRegion=k,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(a){},getCurrentRegionTooltip:function(){var a=this.options,b="",c=[],d,g,h,e,l,n,m,r,p;if(this.currentRegion===k)return"";d=this.getCurrentRegionFields();if(g=a.get("tooltipFormatter"))return g(this,a,d);a.get("tooltipChartTitle")&&(b+='<div class="jqs jqstitle">'+a.get("tooltipChartTitle")+"</div>\n");g=this.options.get("tooltipFormat");
if(!g)return"";f.isArray(g)||(g=[g]);f.isArray(d)||(d=[d]);h=this.options.get("tooltipFormatFieldlist");e=this.options.get("tooltipFormatFieldlistKey");if(h&&e){l=[];for(n=d.length;n--;)m=d[n][e],-1!=(p=f.inArray(m,h))&&(l[p]=d[n]);d=l}h=g.length;r=d.length;for(n=0;n<h;n++)for(m=g[n],"string"===typeof m&&(m=new D(m)),e=m.fclass||"jqsfield",p=0;p<r;p++)d[p].isNull&&a.get("tooltipSkipNull")||(f.extend(d[p],{prefix:a.get("tooltipPrefix"),suffix:a.get("tooltipSuffix")}),l=m.render(d[p],a.get("tooltipValueLookups"),
a),c.push('<div class="'+e+'">'+l+"</div>"));return c.length?b+c.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(a,b){var c=b.get("highlightColor"),d=b.get("highlightLighten"),g,h,f;if(c)return c;if(d&&(c=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(a)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(a))){h=[];g=4===a.length?16:1;for(f=0;3>f;f++)h[f]=H(e.round(parseInt(c[f+1],16)*g*d),0,255);return"rgb("+h.join(",")+")"}return a}});E={changeHighlight:function(a){var b=
this.currentRegion,c=this.target,d=this.regionShapes[b];d&&(a=this.renderRegion(b,a),f.isArray(a)||f.isArray(d)?(c.replaceWithShapes(d,a),this.regionShapes[b]=f.map(a,function(a){return a.id})):(c.replaceWithShape(d,a),this.regionShapes[b]=a.id))},render:function(){var a=this.values,b=this.target,c=this.regionShapes,d,g,h;if(this.cls._super.render.call(this)){for(g=a.length;g--;)if(a=this.renderRegion(g))if(f.isArray(a)){d=[];for(h=a.length;h--;)a[h].append(),d.push(a[h].id);c[g]=d}else a.append(),
c[g]=a.id;else c[g]=null;b.render()}}};f.fn.sparkline.line=M=q(f.fn.sparkline._base,{type:"line",init:function(a,b,c,d,g){M._super.init.call(this,a,b,c,d,g);this.vertices=[];this.regionMap=[];this.xvalues=[];this.yvalues=[];this.yminmax=[];this.lastShapeId=this.hightlightSpotId=null;this.initTarget()},getRegion:function(a,b,c){c=this.regionMap;for(a=c.length;a--;)if(null!==c[a]&&b>=c[a][0]&&b<=c[a][1])return c[a][2];return k},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:null===
this.yvalues[a],x:this.xvalues[a],y:this.yvalues[a],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:a}},renderHighlight:function(){var a=this.target,b=this.vertices[this.currentRegion],c=this.options,d=c.get("spotRadius"),g=c.get("highlightSpotColor"),c=c.get("highlightLineColor");b&&(d&&g&&(d=a.drawCircle(b[0],b[1],d,k,g),this.highlightSpotId=d.id,a.insertAfterShape(this.lastShapeId,d)),c&&(b=a.drawLine(b[0],this.canvasTop,b[0],this.canvasTop+this.canvasHeight,
c),this.highlightLineId=b.id,a.insertAfterShape(this.lastShapeId,b)))},removeHighlight:function(){var a=this.target;this.highlightSpotId&&(a.removeShapeId(this.highlightSpotId),this.highlightSpotId=null);this.highlightLineId&&(a.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var a=this.values,b=a.length,c=this.xvalues,d=this.yvalues,g=this.yminmax,h,f,k,n,l;for(h=0;h<b;h++)f=a[h],k="string"===typeof a[h],n="object"===typeof a[h]&&a[h]instanceof Array,l=k&&a[h].split(":"),
k&&2===l.length?(c.push(Number(l[0])),d.push(Number(l[1])),g.push(Number(l[1]))):n?(c.push(f[0]),d.push(f[1]),g.push(f[1])):(c.push(h),null===a[h]||"null"===a[h]?d.push(null):(d.push(Number(f)),g.push(Number(f))));this.options.get("xvalues")&&(c=this.options.get("xvalues"));this.maxy=this.maxyorg=e.max.apply(e,g);this.miny=this.minyorg=e.min.apply(e,g);this.maxx=e.max.apply(e,c);this.minx=e.min.apply(e,c);this.xvalues=c;this.yvalues=d;this.yminmax=g},processRangeOptions:function(){var a=this.options,
b=a.get("normalRangeMin"),c=a.get("normalRangeMax");b!==k&&(b<this.miny&&(this.miny=b),c>this.maxy&&(this.maxy=c));a.get("chartRangeMin")!==k&&(a.get("chartRangeClip")||a.get("chartRangeMin")<this.miny)&&(this.miny=a.get("chartRangeMin"));a.get("chartRangeMax")!==k&&(a.get("chartRangeClip")||a.get("chartRangeMax")>this.maxy)&&(this.maxy=a.get("chartRangeMax"));a.get("chartRangeMinX")!==k&&(a.get("chartRangeClipX")||a.get("chartRangeMinX")<this.minx)&&(this.minx=a.get("chartRangeMinX"));a.get("chartRangeMaxX")!==
k&&(a.get("chartRangeClipX")||a.get("chartRangeMaxX")>this.maxx)&&(this.maxx=a.get("chartRangeMaxX"))},drawNormalRange:function(a,b,c,d,g){var h=this.options.get("normalRangeMin"),f=this.options.get("normalRangeMax");b+=e.round(c-(f-this.miny)/g*c);c=e.round(c*(f-h)/g);this.target.drawRect(a,b,d,c,k,this.options.get("normalRangeColor")).append()},render:function(){var a=this.options,b=this.target,c=this.canvasWidth,d=this.canvasHeight,g=this.vertices,h=a.get("spotRadius"),z=this.regionMap,l,n,m,r,
p,u,t,y,w,F,q,C,v,A,x;if(M._super.render.call(this)&&(this.scanValues(),this.processRangeOptions(),v=this.xvalues,A=this.yvalues,this.yminmax.length&&!(2>this.yvalues.length))){r=p=0;l=0===this.maxx-this.minx?1:this.maxx-this.minx;n=0===this.maxy-this.miny?1:this.maxy-this.miny;m=this.yvalues.length-1;h&&(c<4*h||d<4*h)&&(h=0);if(h){if((C=a.get("highlightSpotColor")&&!a.get("disableInteraction"))||a.get("minSpotColor")||a.get("spotColor")&&A[m]===this.miny)d-=e.ceil(h);if(C||a.get("maxSpotColor")||
a.get("spotColor")&&A[m]===this.maxy)d-=e.ceil(h),r+=e.ceil(h);if(C||(a.get("minSpotColor")||a.get("maxSpotColor"))&&(A[0]===this.miny||A[0]===this.maxy))p+=e.ceil(h),c-=e.ceil(h);if(C||a.get("spotColor")||a.get("minSpotColor")||a.get("maxSpotColor")&&(A[m]===this.miny||A[m]===this.maxy))c-=e.ceil(h)}d--;a.get("normalRangeMin")===k||a.get("drawNormalOnTop")||this.drawNormalRange(p,r,d,c,n);t=[];y=[t];q=null;C=A.length;for(x=0;x<C;x++)w=v[x],F=v[x+1],u=A[x],w=p+e.round(c/l*(w-this.minx)),F=x<C-1?p+
e.round(c/l*(F-this.minx)):c,F=w+(F-w)/2,z[x]=[q||0,F,x],q=F,null===u?x&&(null!==A[x-1]&&(t=[],y.push(t)),g.push(null)):(u<this.miny&&(u=this.miny),u>this.maxy&&(u=this.maxy),t.length||t.push([w,r+d]),u=[w,r+e.round(d-(u-this.miny)/n*d)],t.push(u),g.push(u));g=[];z=[];q=y.length;for(x=0;x<q;x++)t=y[x],t.length&&(a.get("fillColor")&&(t.push([t[t.length-1][0],r+d]),z.push(t.slice(0)),t.pop()),2<t.length&&(t[0]=[t[0][0],t[1][1]]),g.push(t));q=z.length;for(x=0;x<q;x++)b.drawShape(z[x],a.get("fillColor"),
a.get("fillColor")).append();a.get("normalRangeMin")!==k&&a.get("drawNormalOnTop")&&this.drawNormalRange(p,r,d,c,n);q=g.length;for(x=0;x<q;x++)b.drawShape(g[x],a.get("lineColor"),k,a.get("lineWidth")).append();if(h&&a.get("valueSpots"))for(t=a.get("valueSpots"),t.get===k&&(t=new I(t)),x=0;x<C;x++)(y=t.get(A[x]))&&b.drawCircle(p+e.round(c/l*(v[x]-this.minx)),r+e.round(d-(A[x]-this.miny)/n*d),h,k,y).append();h&&a.get("spotColor")&&null!==A[m]&&b.drawCircle(p+e.round(c/l*(v[v.length-1]-this.minx)),r+
e.round(d-(A[m]-this.miny)/n*d),h,k,a.get("spotColor")).append();this.maxy!==this.minyorg&&(h&&a.get("minSpotColor")&&(w=v[f.inArray(this.minyorg,A)],b.drawCircle(p+e.round(c/l*(w-this.minx)),r+e.round(d-(this.minyorg-this.miny)/n*d),h,k,a.get("minSpotColor")).append()),h&&a.get("maxSpotColor")&&(w=v[f.inArray(this.maxyorg,A)],b.drawCircle(p+e.round(c/l*(w-this.minx)),r+e.round(d-(this.maxyorg-this.miny)/n*d),h,k,a.get("maxSpotColor")).append()));this.lastShapeId=b.getLastShapeId();this.canvasTop=
r;b.render()}}});f.fn.sparkline.bar=Z=q(f.fn.sparkline._base,E,{type:"bar",init:function(a,b,c,d,g){var h=parseInt(c.get("barWidth"),10),z=parseInt(c.get("barSpacing"),10),l=c.get("chartRangeMin"),n=c.get("chartRangeMax"),m=c.get("chartRangeClip"),r=Infinity,p=-Infinity,u,t,y,w,q,v,C;Z._super.init.call(this,a,b,c,d,g);a=0;for(d=b.length;a<d;a++)if(g=b[a],(u="string"===typeof g&&-1<g.indexOf(":"))||f.isArray(g))w=!0,u&&(g=b[a]=K(g.split(":"))),g=S(g,null),u=e.min.apply(e,g),g=e.max.apply(e,g),u<r&&
(r=u),g>p&&(p=g);this.stacked=w;this.regionShapes={};this.barWidth=h;this.barSpacing=z;this.totalBarWidth=h+z;this.width=b.length*h+(b.length-1)*z;this.initTarget();m&&(y=l===k?-Infinity:l,t=n===k?Infinity:n);l=[];h=w?[]:l;n=[];z=[];a=0;for(d=b.length;a<d;a++)if(w)for(u=b[a],b[a]=C=[],n[a]=0,q=h[a]=z[a]=0,v=u.length;q<v;q++)g=C[q]=m?H(u[q],y,t):u[q],null!==g&&(0<g&&(n[a]+=g),0>r&&0<p?0>g?z[a]+=e.abs(g):h[a]+=g:h[a]+=e.abs(g-(0>g?p:r)),l.push(g));else g=m?H(b[a],y,t):b[a],g=b[a]=G(g),null!==g&&l.push(g);
this.max=m=e.max.apply(e,l);this.min=b=e.min.apply(e,l);this.stackMax=p=w?e.max.apply(e,n):m;this.stackMin=w?e.min.apply(e,l):b;c.get("chartRangeMin")!==k&&(c.get("chartRangeClip")||c.get("chartRangeMin")<b)&&(b=c.get("chartRangeMin"));c.get("chartRangeMax")!==k&&(c.get("chartRangeClip")||c.get("chartRangeMax")>m)&&(m=c.get("chartRangeMax"));this.zeroAxis=r=c.get("zeroAxis",!0);this.xaxisOffset=y=0>=b&&0<=m&&r?0:0==r?b:0<b?b:m;t=w?e.max.apply(e,h)+e.max.apply(e,z):m-b;this.canvasHeightEf=r&&0>b?this.canvasHeight-
2:this.canvasHeight-1;b<y?(p=((w&&0<=m?p:m)-y)/t*this.canvasHeight,p!==e.ceil(p)&&(this.canvasHeightEf-=2,p=e.ceil(p))):p=this.canvasHeight;this.yoffset=p;f.isArray(c.get("colorMap"))?(this.colorMapByIndex=c.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,(this.colorMapByValue=c.get("colorMap"))&&this.colorMapByValue.get===k&&(this.colorMapByValue=new I(this.colorMapByValue)));this.range=t},getRegion:function(a,b,c){a=e.floor(b/this.totalBarWidth);return 0>a||a>=this.values.length?
k:a},getCurrentRegionFields:function(){var a=this.currentRegion,b=V(this.values[a]),c=[],d,g;for(g=b.length;g--;)d=b[g],c.push({isNull:null===d,value:d,color:this.calcColor(g,d,a),offset:a});return c},calcColor:function(a,b,c){var d=this.colorMapByIndex,g=this.colorMapByValue,h=this.options,e,l;e=this.stacked?h.get("stackedBarColor"):0>b?h.get("negBarColor"):h.get("barColor");0===b&&h.get("zeroColor")!==k&&(e=h.get("zeroColor"));g&&(l=g.get(b))?e=l:d&&d.length>c&&(e=d[c]);return f.isArray(e)?e[a%
e.length]:e},renderRegion:function(a,b){var c=this.values[a],d=this.options,g=this.xaxisOffset,h=[],l=this.range,q=this.stacked,n=this.target,m=a*this.totalBarWidth,r=this.canvasHeightEf,p=this.yoffset,u,t,y,w,v,B,C,D,c=f.isArray(c)?c:[c];B=c.length;u=L(null,c);D=L(g,c,!0);if(u)return d.get("nullColor")?(y=b?d.get("nullColor"):this.calcHighlightColor(d.get("nullColor"),d),n.drawRect(m,0<p?p-1:p,this.barWidth-1,0,y,y)):k;w=p;for(v=0;v<B;v++){y=c[v];if(q&&y===g){if(!D||C)continue;C=!0}t=0<l?e.floor(r*
(e.abs(y-g)/l))+1:1;y<g||y===g&&0===p?(u=w,w+=t):(u=p-t,p-=t);y=this.calcColor(v,y,a);b&&(y=this.calcHighlightColor(y,d));h.push(n.drawRect(m,u,this.barWidth-1,t-1,y,y))}return 1===h.length?h[0]:h}});f.fn.sparkline.tristate=aa=q(f.fn.sparkline._base,E,{type:"tristate",init:function(a,b,c,d,g){var h=parseInt(c.get("barWidth"),10),e=parseInt(c.get("barSpacing"),10);aa._super.init.call(this,a,b,c,d,g);this.regionShapes={};this.barWidth=h;this.barSpacing=e;this.totalBarWidth=h+e;this.values=f.map(b,Number);
this.width=b.length*h+(b.length-1)*e;f.isArray(c.get("colorMap"))?(this.colorMapByIndex=c.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,(this.colorMapByValue=c.get("colorMap"))&&this.colorMapByValue.get===k&&(this.colorMapByValue=new I(this.colorMapByValue)));this.initTarget()},getRegion:function(a,b,c){return e.floor(b/this.totalBarWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===k,value:this.values[a],color:this.calcColor(this.values[a],
a),offset:a}},calcColor:function(a,b){var c=this.values,d=this.options,g=this.colorMapByIndex,h=this.colorMapByValue,e;return h&&(e=h.get(a))?e:g&&g.length>b?g[b]:0>c[b]?d.get("negBarColor"):0<c[b]?d.get("posBarColor"):d.get("zeroBarColor")},renderRegion:function(a,b){var c=this.values,d=this.options,g=this.target,h,f,k;h=e.round(g.pixelHeight/2);f=a*this.totalBarWidth;0>c[a]?(k=h,--h):0<c[a]?(k=0,--h):(k=h-1,h=2);c=this.calcColor(c[a],a);if(null!==c)return b&&(c=this.calcHighlightColor(c,d)),g.drawRect(f,
k,this.barWidth-1,h-1,c,c)}});f.fn.sparkline.discrete=ba=q(f.fn.sparkline._base,E,{type:"discrete",init:function(a,b,c,d,g){ba._super.init.call(this,a,b,c,d,g);this.regionShapes={};this.values=b=f.map(b,Number);this.min=e.min.apply(e,b);this.max=e.max.apply(e,b);this.range=this.max-this.min;this.width=d="auto"===c.get("width")?2*b.length:this.width;this.interval=e.floor(d/b.length);this.itemWidth=d/b.length;c.get("chartRangeMin")!==k&&(c.get("chartRangeClip")||c.get("chartRangeMin")<this.min)&&(this.min=
c.get("chartRangeMin"));c.get("chartRangeMax")!==k&&(c.get("chartRangeClip")||c.get("chartRangeMax")>this.max)&&(this.max=c.get("chartRangeMax"));this.initTarget();this.target&&(this.lineHeight="auto"===c.get("lineHeight")?e.round(.3*this.canvasHeight):c.get("lineHeight"))},getRegion:function(a,b,c){return e.floor(b/this.itemWidth)},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===k,value:this.values[a],offset:a}},renderRegion:function(a,b){var c=this.options,
d=this.min,g=this.range,h=this.interval,f=this.target,k=this.lineHeight,l=this.canvasHeight-k,m;m=H(this.values[a],d,this.max);h*=a;d=e.round(l-(m-d)/g*l);m=c.get("thresholdColor")&&m<c.get("thresholdValue")?c.get("thresholdColor"):c.get("lineColor");b&&(m=this.calcHighlightColor(m,c));return f.drawLine(h,d,h,d+k,m)}});f.fn.sparkline.bullet=N=q(f.fn.sparkline._base,{type:"bullet",init:function(a,b,c,d,g){var h;N._super.init.call(this,a,b,c,d,g);this.values=b=K(b);a=b.slice();a[0]=null===a[0]?a[2]:
a[0];a[1]=null===b[1]?a[2]:a[1];a=e.min.apply(e,b);h=e.max.apply(e,b);this.min=a=c.get("base")===k?0>a?a:0:c.get("base");this.max=h;this.range=h-a;this.shapes={};this.valueShapes={};this.regiondata={};this.width=d="auto"===c.get("width")?"4.0em":d;this.target=this.$el.simpledraw(d,g,c.get("composite"));b.length||(this.disabled=!0);this.initTarget()},getRegion:function(a,b,c){a=this.target.getShapeAt(a,b,c);return a!==k&&this.shapes[a]!==k?this.shapes[a]:k},getCurrentRegionFields:function(){var a=
this.currentRegion;return{fieldkey:a.substr(0,1),value:this.values[a.substr(1)],region:a}},changeHighlight:function(a){var b=this.currentRegion,c=this.valueShapes[b],d;delete this.shapes[c];switch(b.substr(0,1)){case "r":d=this.renderRange(b.substr(1),a);break;case "p":d=this.renderPerformance(a);break;case "t":d=this.renderTarget(a)}this.valueShapes[b]=d.id;this.shapes[d.id]=b;this.target.replaceWithShape(c,d)},renderRange:function(a,b){var c=e.round((this.values[a]-this.min)/this.range*this.canvasWidth),
d=this.options.get("rangeColors")[a-2];b&&(d=this.calcHighlightColor(d,this.options));return this.target.drawRect(0,0,c-1,this.canvasHeight-1,d,d)},renderPerformance:function(a){var b=e.round((this.values[1]-this.min)/this.range*this.canvasWidth),c=this.options.get("performanceColor");a&&(c=this.calcHighlightColor(c,this.options));return this.target.drawRect(0,e.round(.3*this.canvasHeight),b-1,e.round(.4*this.canvasHeight)-1,c,c)},renderTarget:function(a){var b=e.round((this.values[0]-this.min)/this.range*
this.canvasWidth-this.options.get("targetWidth")/2),c=e.round(.1*this.canvasHeight),d=this.canvasHeight-2*c,g=this.options.get("targetColor");a&&(g=this.calcHighlightColor(g,this.options));return this.target.drawRect(b,c,this.options.get("targetWidth")-1,d-1,g,g)},render:function(){var a=this.values.length,b=this.target,c,d;if(N._super.render.call(this)){for(c=2;c<a;c++)d=this.renderRange(c).append(),this.shapes[d.id]="r"+c,this.valueShapes["r"+c]=d.id;null!==this.values[1]&&(d=this.renderPerformance().append(),
this.shapes[d.id]="p1",this.valueShapes.p1=d.id);null!==this.values[0]&&(d=this.renderTarget().append(),this.shapes[d.id]="t0",this.valueShapes.t0=d.id);b.render()}}});f.fn.sparkline.pie=O=q(f.fn.sparkline._base,{type:"pie",init:function(a,b,c,d,g){var h=0;O._super.init.call(this,a,b,c,d,g);this.shapes={};this.valueShapes={};this.values=b=f.map(b,Number);"auto"===c.get("width")&&(this.width=this.height);if(0<b.length)for(a=b.length;a--;)h+=b[a];this.total=h;this.initTarget();this.radius=e.floor(e.min(this.canvasWidth,
this.canvasHeight)/2)},getRegion:function(a,b,c){a=this.target.getShapeAt(a,b,c);return a!==k&&this.shapes[a]!==k?this.shapes[a]:k},getCurrentRegionFields:function(){var a=this.currentRegion;return{isNull:this.values[a]===k,value:this.values[a],percent:this.values[a]/this.total*100,color:this.options.get("sliceColors")[a%this.options.get("sliceColors").length],offset:a}},changeHighlight:function(a){var b=this.currentRegion;a=this.renderSlice(b,a);var c=this.valueShapes[b];delete this.shapes[c];this.target.replaceWithShape(c,
a);this.valueShapes[b]=a.id;this.shapes[a.id]=b},renderSlice:function(a,b){var c=this.target,d=this.options,g=this.radius,h=d.get("borderWidth"),f=d.get("offset"),l=2*e.PI,n=this.values,m=this.total,r=f?f/360*e.PI*2:0,p,u,t;t=n.length;for(u=0;u<t;u++){p=f=r;0<m&&(p=r+n[u]/m*l);if(a===u)return l=d.get("sliceColors")[u%d.get("sliceColors").length],b&&(l=this.calcHighlightColor(l,d)),c.drawPieSlice(g,g,g-h,f,p,k,l);r=p}},render:function(){var a=this.target,b=this.values,c=this.options,d=this.radius,
g=c.get("borderWidth");if(O._super.render.call(this)){g&&a.drawCircle(d,d,e.floor(d-g/2),c.get("borderColor"),k,g).append();for(d=b.length;d--;)b[d]&&(c=this.renderSlice(d).append(),this.valueShapes[d]=c.id,this.shapes[c.id]=d);a.render()}}});f.fn.sparkline.box=P=q(f.fn.sparkline._base,{type:"box",init:function(a,b,c,d,g){P._super.init.call(this,a,b,c,d,g);this.values=f.map(b,Number);this.width="auto"===c.get("width")?"4.0em":d;this.initTarget();this.values.length||(this.disabled=1)},getRegion:function(){return 1},
getCurrentRegionFields:function(){var a=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];this.loutlier!==k&&a.push({field:"lo",value:this.loutlier});this.routlier!==k&&a.push({field:"ro",value:this.routlier});this.lwhisker!==k&&a.push({field:"lw",value:this.lwhisker});this.rwhisker!==k&&a.push({field:"rw",value:this.rwhisker});return a},render:function(){var a=this.target,b=this.values,c=b.length,d=this.options,g=this.canvasWidth,h=
this.canvasHeight,f=d.get("chartRangeMin")===k?e.min.apply(e,b):d.get("chartRangeMin"),l=d.get("chartRangeMax")===k?e.max.apply(e,b):d.get("chartRangeMax"),n=0,m,r,p,u,t,q,w,v;if(P._super.render.call(this)){if(d.get("raw"))d.get("showOutliers")&&5<b.length?(r=b[0],m=b[1],u=b[2],t=b[3],q=b[4],w=b[5],v=b[6]):(m=b[0],u=b[1],t=b[2],q=b[3],w=b[4]);else if(b.sort(function(a,b){return a-b}),u=J(b,1),t=J(b,2),q=J(b,3),p=q-u,d.get("showOutliers")){m=w=k;for(r=0;r<c;r++)m===k&&b[r]>u-p*d.get("outlierIQR")&&
(m=b[r]),b[r]<q+p*d.get("outlierIQR")&&(w=b[r]);r=b[0];v=b[c-1]}else m=b[0],w=b[c-1];this.quartiles=[u,t,q];this.lwhisker=m;this.rwhisker=w;this.loutlier=r;this.routlier=v;b=g/(l-f+1);d.get("showOutliers")&&(n=e.ceil(d.get("spotRadius")),g-=2*e.ceil(d.get("spotRadius")),b=g/(l-f+1),r<m&&a.drawCircle((r-f)*b+n,h/2,d.get("spotRadius"),d.get("outlierLineColor"),d.get("outlierFillColor")).append(),v>w&&a.drawCircle((v-f)*b+n,h/2,d.get("spotRadius"),d.get("outlierLineColor"),d.get("outlierFillColor")).append());
a.drawRect(e.round((u-f)*b+n),e.round(.1*h),e.round((q-u)*b),e.round(.8*h),d.get("boxLineColor"),d.get("boxFillColor")).append();a.drawLine(e.round((m-f)*b+n),e.round(h/2),e.round((u-f)*b+n),e.round(h/2),d.get("lineColor")).append();a.drawLine(e.round((m-f)*b+n),e.round(h/4),e.round((m-f)*b+n),e.round(h-h/4),d.get("whiskerColor")).append();a.drawLine(e.round((w-f)*b+n),e.round(h/2),e.round((q-f)*b+n),e.round(h/2),d.get("lineColor")).append();a.drawLine(e.round((w-f)*b+n),e.round(h/4),e.round((w-f)*
b+n),e.round(h-h/4),d.get("whiskerColor")).append();a.drawLine(e.round((t-f)*b+n),e.round(.1*h),e.round((t-f)*b+n),e.round(.9*h),d.get("medianColor")).append();d.get("target")&&(g=e.ceil(d.get("spotRadius")),a.drawLine(e.round((d.get("target")-f)*b+n),e.round(h/2-g),e.round((d.get("target")-f)*b+n),e.round(h/2+g),d.get("targetColor")).append(),a.drawLine(e.round((d.get("target")-f)*b+n-g),e.round(h/2),e.round((d.get("target")-f)*b+n+g),e.round(h/2),d.get("targetColor")).append());a.render()}}});ca=
q({init:function(a,b,c,d){this.target=a;this.id=b;this.type=c;this.args=d},append:function(){this.target.appendShape(this);return this}});E=q({_pxregex:/(\d+)(px)?\s*$/i,init:function(a,b,c){a&&(this.width=a,this.height=b,this.target=c,this.lastShapeId=null,c[0]&&(c=c[0]),f.data(c,"_jqs_vcanvas",this))},drawLine:function(a,b,c,d,g,h){return this.drawShape([[a,b],[c,d]],g,h)},drawShape:function(a,b,c,d){return this._genShape("Shape",[a,b,c,d])},drawCircle:function(a,b,c,d,g,h){return this._genShape("Circle",
[a,b,c,d,g,h])},drawPieSlice:function(a,b,c,d,g,h,e){return this._genShape("PieSlice",[a,b,c,d,g,h,e])},drawRect:function(a,b,c,d,g,h){return this._genShape("Rect",[a,b,c,d,g,h])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(a,b){f(b).html(a)},_calculatePixelDims:function(a,b,c){this.pixelHeight=(b=this._pxregex.exec(b))?b[1]:f(c).height();this.pixelWidth=(b=this._pxregex.exec(a))?b[1]:
f(c).width()},_genShape:function(a,b){var c=da++;b.unshift(c);return new ca(this,c,a,b)},appendShape:function(a){alert("appendShape not implemented")},replaceWithShape:function(a,b){alert("replaceWithShape not implemented")},insertAfterShape:function(a,b){alert("insertAfterShape not implemented")},removeShapeId:function(a){alert("removeShapeId not implemented")},getShapeAt:function(a,b,c){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}});Q=q(E,{init:function(a,
b,c,d){Q._super.init.call(this,a,b,c);this.canvas=l.createElement("canvas");c[0]&&(c=c[0]);f.data(c,"_jqs_vcanvas",this);f(this.canvas).css({display:"inline-block",width:a,height:b,verticalAlign:"top"});this._insert(this.canvas,c);this._calculatePixelDims(a,b,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.interact=d;this.shapes={};this.shapeseq=[];this.currentTargetShapeId=k;f(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(a,
b,c){var d=this.canvas.getContext("2d");a!==k&&(d.strokeStyle=a);d.lineWidth=c===k?1:c;b!==k&&(d.fillStyle=b);return d},reset:function(){this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight);this.shapes={};this.shapeseq=[];this.currentTargetShapeId=k},_drawShape:function(a,b,c,d,g){g=this._getContext(c,d,g);var h,e;g.beginPath();g.moveTo(b[0][0]+.5,b[0][1]+.5);h=1;for(e=b.length;h<e;h++)g.lineTo(b[h][0]+.5,b[h][1]+.5);c!==k&&g.stroke();d!==k&&g.fill();this.targetX!==k&&this.targetY!==
k&&g.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawCircle:function(a,b,c,d,g,h,f){f=this._getContext(g,h,f);f.beginPath();f.arc(b,c,d,0,2*e.PI,!1);this.targetX!==k&&this.targetY!==k&&f.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a);g!==k&&f.stroke();h!==k&&f.fill()},_drawPieSlice:function(a,b,c,d,g,h,e,f){var l=this._getContext(e,f);l.beginPath();l.moveTo(b,c);l.arc(b,c,d,g,h,!1);l.lineTo(b,c);l.closePath();e!==k&&l.stroke();f&&l.fill();this.targetX!==
k&&this.targetY!==k&&l.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=a)},_drawRect:function(a,b,c,d,g,e,f){return this._drawShape(a,[[b,c],[b+d,c],[b+d,c+g],[b,c+g],[b,c]],e,f)},appendShape:function(a){this.shapes[a.id]=a;this.shapeseq.push(a.id);return this.lastShapeId=a.id},replaceWithShape:function(a,b){var c=this.shapeseq,d;this.shapes[b.id]=b;for(d=c.length;d--;)c[d]==a&&(c[d]=b.id);delete this.shapes[a]},replaceWithShapes:function(a,b){var c=this.shapeseq,d={},g,e,f;for(e=
a.length;e--;)d[a[e]]=!0;for(e=c.length;e--;)g=c[e],d[g]&&(c.splice(e,1),delete this.shapes[g],f=e);for(e=b.length;e--;)c.splice(f,0,b[e].id),this.shapes[b[e].id]=b[e]},insertAfterShape:function(a,b){var c=this.shapeseq,d;for(d=c.length;d--;)if(c[d]===a){c.splice(d+1,0,b.id);this.shapes[b.id]=b;break}},removeShapeId:function(a){var b=this.shapeseq,c;for(c=b.length;c--;)if(b[c]===a){b.splice(c,1);break}delete this.shapes[a]},getShapeAt:function(a,b,c){this.targetX=b;this.targetY=c;this.render();return this.currentTargetShapeId},
render:function(){var a=this.shapeseq,b=this.shapes,c=a.length,d,e;this._getContext().clearRect(0,0,this.pixelWidth,this.pixelHeight);for(e=0;e<c;e++)d=a[e],d=b[d],this["_draw"+d.type].apply(this,d.args);this.interact||(this.shapes={},this.shapeseq=[])}});R=q(E,{init:function(a,b,c){R._super.init.call(this,a,b,c);c[0]&&(c=c[0]);f.data(c,"_jqs_vcanvas",this);this.canvas=l.createElement("span");f(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:a,height:b,margin:"0px",
padding:"0px",verticalAlign:"top"});this._insert(this.canvas,c);this._calculatePixelDims(a,b,this.canvas);this.canvas.width=this.pixelWidth;this.canvas.height=this.pixelHeight;this.canvas.insertAdjacentHTML("beforeEnd",'<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>');this.group=f(this.canvas).children()[0];this.rendered=!1;this.prerender=""},_drawShape:function(a,
b,c,d,e){var f=[],g,l;l=0;for(g=b.length;l<g;l++)f[l]=""+b[l][0]+","+b[l][1];b=f.splice(0,1);e=e===k?1:e;c=c===k?' stroked="false" ':' strokeWeight="'+e+'px" strokeColor="'+c+'" ';d=d===k?' filled="false"':' fillColor="'+d+'" filled="true" ';e=f[0]===f[f.length-1]?"x ":"";return'<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+a+'" '+c+d+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+
b+" l "+f.join(", ")+" "+e+'e"> </v:shape>'},_drawCircle:function(a,b,c,d,e,f,l){return'<v:oval  id="jqsshape'+a+'" '+(e===k?' stroked="false" ':' strokeWeight="'+l+'px" strokeColor="'+e+'" ')+(f===k?' filled="false"':' fillColor="'+f+'" filled="true" ')+' style="position:absolute;top:'+(c-d)+"px; left:"+(b-d)+"px; width:"+2*d+"px; height:"+2*d+'px"></v:oval>'},_drawPieSlice:function(a,b,c,d,f,h,l,q){var g,m,r,p;if(f===h)return"";h-f===2*e.PI&&(f=0,h=2*e.PI);g=b+e.round(e.cos(f)*d);m=c+e.round(e.sin(f)*
d);r=b+e.round(e.cos(h)*d);p=c+e.round(e.sin(h)*d);if(g===r&&m===p){if(h-f<e.PI)return"";g=r=b+d;m=p=c}return g===r&&m===p&&h-f<e.PI?"":'<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+a+'" '+(l===k?' stroked="false" ':' strokeWeight="1px" strokeColor="'+l+'" ')+(q===k?' filled="false"':' fillColor="'+q+'" filled="true" ')+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+
b+","+c+" wa "+[b-d,c-d,b+d,c+d,g,m,r,p].join(", ")+' x e"> </v:shape>'},_drawRect:function(a,b,c,d,e,f,k){return this._drawShape(a,[[b,c],[b,c+e],[b+d,c+e],[b+d,c],[b,c]],f,k)},reset:function(){this.group.innerHTML=""},appendShape:function(a){var b=this["_draw"+a.type].apply(this,a.args);this.rendered?this.group.insertAdjacentHTML("beforeEnd",b):this.prerender+=b;return this.lastShapeId=a.id},replaceWithShape:function(a,b){var c=f("#jqsshape"+a),d=this["_draw"+b.type].apply(this,b.args);c[0].outerHTML=
d},replaceWithShapes:function(a,b){var c=f("#jqsshape"+a[0]),d="",e=b.length,h;for(h=0;h<e;h++)d+=this["_draw"+b[h].type].apply(this,b[h].args);c[0].outerHTML=d;for(h=1;h<a.length;h++)f("#jqsshape"+a[h]).remove()},insertAfterShape:function(a,b){var c=f("#jqsshape"+a),d=this["_draw"+b.type].apply(this,b.args);c[0].insertAdjacentHTML("afterEnd",d)},removeShapeId:function(a){a=f("#jqsshape"+a);this.group.removeChild(a[0])},getShapeAt:function(a,b,c){return a.id.substr(8)},render:function(){this.rendered||
(this.group.innerHTML=this.prerender,this.rendered=!0)}})})})(document,Math);
